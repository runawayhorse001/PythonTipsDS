{"paragraphs":[{"text":"%md\n# pd.DataFrame vs rdd.DataFrame","user":"anonymous","dateUpdated":"2019-02-27T22:26:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>pd.DataFrame vs rdd.DataFrame</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305071855_-1789180260","id":"20190227-160431_307281736","dateCreated":"2019-02-27T16:04:31-0600","dateStarted":"2019-02-27T22:26:10-0600","dateFinished":"2019-02-27T22:26:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:330"},{"text":"%md\n### Load packages\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:10-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Load packages</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305044376_1985310635","id":"20190227-160404_1175152154","dateCreated":"2019-02-27T16:04:04-0600","dateStarted":"2019-02-27T22:26:10-0600","dateFinished":"2019-02-27T22:26:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:331"},{"text":"%pyspark\nimport numpy as np\nimport pandas as pd","user":"anonymous","dateUpdated":"2019-04-04T21:42:51-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":296,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","marital":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":true},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","style":"stack"}},"commonSetting":{},"keys":[{"name":"age","index":0,"aggr":"sum"}],"groups":[{"name":"marital","index":1,"aggr":"sum"}],"values":[{"name":"value","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{"maxAge":"45","minAge":"30"},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551291573838_374693920","id":"20190214-123445_937703937","dateCreated":"2019-02-27T12:19:33-0600","dateStarted":"2019-04-04T21:42:51-0500","dateFinished":"2019-04-04T21:42:52-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:332"},{"text":"%pyspark\nfrom pyspark.sql import functions as F\nfrom pyspark.sql.functions import col","user":"anonymous","dateUpdated":"2019-04-04T21:44:10-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"multiBarChart","height":282,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"age":"string","marital":"string","value":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"age","index":0,"aggr":"sum"}],"groups":[{"name":"marital","index":1,"aggr":"sum"}],"values":[{"name":"value","index":2,"aggr":"sum"}]},"helium":{}},"1":{"graph":{"mode":"table","height":86,"optionOpen":false}}},"enabled":true},"settings":{"params":{"minAge":"30","maxAge":"35"},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551291573839_-1389591136","id":"20190214-151922_2133085890","dateCreated":"2019-02-27T12:19:33-0600","dateStarted":"2019-04-04T21:44:10-0500","dateFinished":"2019-04-04T21:44:10-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:333"},{"text":"%md\n### Create DataFrame from Dictionary ","user":"anonymous","dateUpdated":"2019-02-27T22:26:11-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Create DataFrame from Dictionary</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305231090_-842486631","id":"20190227-160711_1656479968","dateCreated":"2019-02-27T16:07:11-0600","dateStarted":"2019-02-27T22:26:11-0600","dateFinished":"2019-02-27T22:26:11-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:334"},{"text":"%pyspark\nd = {'A': [0, 1, 0],\n     'B': [1, 0, 1],\n     'C': [1, 0, 0]}","user":"anonymous","dateUpdated":"2019-03-27T14:33:56-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551291733546_-1456317032","id":"20190227-122213_1948788419","dateCreated":"2019-02-27T12:22:13-0600","dateStarted":"2019-03-27T14:33:57-0500","dateFinished":"2019-03-27T14:33:57-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:335"},{"text":"%pyspark\npd.DataFrame(d)\n\n\n\n","user":"anonymous","dateUpdated":"2019-03-27T14:33:59-0500","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":114,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A  B  C\n0  0  1  1\n1  1  0  0\n2  0  1  0"}]},"apps":[],"jobName":"paragraph_1551304836200_-1512455461","id":"20190227-160036_33237884","dateCreated":"2019-02-27T16:00:36-0600","dateStarted":"2019-03-27T14:33:59-0500","dateFinished":"2019-03-27T14:33:59-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:336"},{"text":"%pyspark\nspark.createDataFrame(np.array(list(d.values())).T.tolist(),list(d.keys())).show()","user":"anonymous","dateUpdated":"2019-03-27T14:34:05-0500","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":162,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+\n|  A|  B|  C|\n+---+---+---+\n|  0|  1|  1|\n|  1|  0|  0|\n|  0|  1|  0|\n+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1551304853214_-1546075232","id":"20190227-160053_737167802","dateCreated":"2019-02-27T16:00:53-0600","dateStarted":"2019-03-27T14:34:05-0500","dateFinished":"2019-03-27T14:34:09-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:337"},{"text":"%md\n### Create DataFrame from List","user":"anonymous","dateUpdated":"2019-02-27T22:26:11-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Create DataFrame from List</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305291995_-448711954","id":"20190227-160811_546537582","dateCreated":"2019-02-27T16:08:11-0600","dateStarted":"2019-02-27T22:26:11-0600","dateFinished":"2019-02-27T22:26:11-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:338"},{"text":"%pyspark\nmy_list = [['a', 1, 2], ['b', 2,3],['c',3,4]]\ncol_name = ['A', 'B','C']","user":"anonymous","dateUpdated":"2019-03-27T14:36:05-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551304913203_-101254611","id":"20190227-160153_1115016051","dateCreated":"2019-02-27T16:01:53-0600","dateStarted":"2019-03-27T14:36:05-0500","dateFinished":"2019-03-27T14:36:05-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:339"},{"text":"%pyspark\n# caution for the columns=\npd.DataFrame(my_list,columns= col_name)\n\n\n","user":"anonymous","dateUpdated":"2019-03-27T14:36:07-0500","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A  B  C\n0  a  1  2\n1  b  2  3\n2  c  3  4"}]},"apps":[],"jobName":"paragraph_1551305102923_-1907596610","id":"20190227-160502_1416554340","dateCreated":"2019-02-27T16:05:02-0600","dateStarted":"2019-03-27T14:36:07-0500","dateFinished":"2019-03-27T14:36:07-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:340"},{"text":"%pyspark\nspark.createDataFrame(my_list, col_name).show()","user":"anonymous","dateUpdated":"2019-03-27T14:36:10-0500","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":134,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+\n|  A|  B|  C|\n+---+---+---+\n|  a|  1|  2|\n|  b|  2|  3|\n|  c|  3|  4|\n+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1551305116121_1654324742","id":"20190227-160516_1905312851","dateCreated":"2019-02-27T16:05:16-0600","dateStarted":"2019-03-27T14:36:10-0500","dateFinished":"2019-03-27T14:36:10-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:341"},{"text":"%pyspark\npd.DataFrame(my_list,col_name)","user":"anonymous","dateUpdated":"2019-02-28T11:20:15-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   0  1  2\nA  a  1  2\nB  b  2  3\nC  c  3  4"}]},"apps":[],"jobName":"paragraph_1551374383460_-1462198916","id":"20190228-111943_435156253","dateCreated":"2019-02-28T11:19:43-0600","dateStarted":"2019-02-28T11:20:15-0600","dateFinished":"2019-02-28T11:20:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:342"},{"text":"%md\n### Read .csv","user":"anonymous","dateUpdated":"2019-02-27T22:26:12-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Read .csv</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305462235_1805996697","id":"20190227-161102_748625259","dateCreated":"2019-02-27T16:11:02-0600","dateStarted":"2019-02-27T22:26:12-0600","dateFinished":"2019-02-27T22:26:12-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:343"},{"text":"%pyspark\n# pd.DataFrame dp: DataFrame pandas\ndp = pd.read_csv('/Users/dt216661/Documents/MyTutorial/CodeForTutor/data/Advertising.csv')\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:12-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551305218720_-1770919121","id":"20190227-160658_999608049","dateCreated":"2019-02-27T16:06:58-0600","dateStarted":"2019-02-27T22:26:12-0600","dateFinished":"2019-02-27T22:26:12-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:344"},{"text":"%pyspark\n#rdd.DataFrame. dp: DataFrame spark \nds = spark.read.csv(path='/Users/dt216661/Documents/MyTutorial/CodeForTutor/data',\n#                sep=',',\n#                encoding='UTF-8',\n#                comment=None,\n               header=True, \n               inferSchema=True)","user":"anonymous","dateUpdated":"2019-02-27T22:26:12-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551305209271_1317723625","id":"20190227-160649_1323010956","dateCreated":"2019-02-27T16:06:49-0600","dateStarted":"2019-02-27T22:26:13-0600","dateFinished":"2019-02-27T22:26:13-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:345"},{"text":"%md\n### First n rows","user":"anonymous","dateUpdated":"2019-02-27T22:26:13-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>First n rows</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305831811_-393846169","id":"20190227-161711_1048960367","dateCreated":"2019-02-27T16:17:11-0600","dateStarted":"2019-02-27T22:26:13-0600","dateFinished":"2019-02-27T22:26:13-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:346"},{"text":"%pyspark\ndp.head(4)  \n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:13-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales\n0  230.1   37.8       69.2   22.1\n1   44.5   39.3       45.1   10.4\n2   17.2   45.9       69.3    9.3\n3  151.5   41.3       58.5   18.5"}]},"apps":[],"jobName":"paragraph_1551305130055_-277533954","id":"20190227-160530_879323097","dateCreated":"2019-02-27T16:05:30-0600","dateStarted":"2019-02-27T22:26:13-0600","dateFinished":"2019-02-27T22:26:13-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:347"},{"text":"%pyspark\nds.show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:13-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+\n|   TV|Radio|Newspaper|Sales|\n+-----+-----+---------+-----+\n|230.1| 37.8|     69.2| 22.1|\n| 44.5| 39.3|     45.1| 10.4|\n| 17.2| 45.9|     69.3|  9.3|\n|151.5| 41.3|     58.5| 18.5|\n+-----+-----+---------+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551305783761_1548808","id":"20190227-161623_628101025","dateCreated":"2019-02-27T16:16:23-0600","dateStarted":"2019-02-27T22:26:13-0600","dateFinished":"2019-02-27T22:26:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:348"},{"text":"%md\n### Column name","user":"anonymous","dateUpdated":"2019-02-27T22:26:14-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Column name</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305854782_-657526017","id":"20190227-161734_1368563153","dateCreated":"2019-02-27T16:17:34-0600","dateStarted":"2019-02-27T22:26:14-0600","dateFinished":"2019-02-27T22:26:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:349"},{"text":"%pyspark\ndp.columns","user":"anonymous","dateUpdated":"2019-02-27T22:26:14-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Index(['TV', 'Radio', 'Newspaper', 'Sales'], dtype='object')"}]},"apps":[],"jobName":"paragraph_1551305796714_2043029181","id":"20190227-161636_978309871","dateCreated":"2019-02-27T16:16:36-0600","dateStarted":"2019-02-27T22:26:14-0600","dateFinished":"2019-02-27T22:26:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:350"},{"text":"%pyspark\nds.columns","user":"anonymous","dateUpdated":"2019-02-27T22:26:14-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['TV', 'Radio', 'Newspaper', 'Sales']"}]},"apps":[],"jobName":"paragraph_1551305883105_-352877835","id":"20190227-161803_250834456","dateCreated":"2019-02-27T16:18:03-0600","dateStarted":"2019-02-27T22:26:14-0600","dateFinished":"2019-02-27T22:26:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:351"},{"text":"%md\n### Data types\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:14-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Data types</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305891620_-1855209106","id":"20190227-161811_2135952239","dateCreated":"2019-02-27T16:18:11-0600","dateStarted":"2019-02-27T22:26:14-0600","dateFinished":"2019-02-27T22:26:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:352"},{"text":"%pyspark\ndp.dtypes","user":"anonymous","dateUpdated":"2019-02-27T22:26:14-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"TV           float64\nRadio        float64\nNewspaper    float64\nSales        float64\ndtype: object"}]},"apps":[],"jobName":"paragraph_1551305923636_701998672","id":"20190227-161843_1303647617","dateCreated":"2019-02-27T16:18:43-0600","dateStarted":"2019-02-27T22:26:14-0600","dateFinished":"2019-02-27T22:26:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:353"},{"text":"%pyspark\nds.dtypes\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:15-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('TV', 'double'),\n ('Radio', 'double'),\n ('Newspaper', 'double'),\n ('Sales', 'double')]"}]},"apps":[],"jobName":"paragraph_1551305938559_161337760","id":"20190227-161858_927978655","dateCreated":"2019-02-27T16:18:58-0600","dateStarted":"2019-02-27T22:26:15-0600","dateFinished":"2019-02-27T22:26:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:354"},{"text":"%md\n### Rename all names","user":"anonymous","dateUpdated":"2019-02-27T22:26:15-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Rename all names</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305953964_475474301","id":"20190227-161913_1552989232","dateCreated":"2019-02-27T16:19:13-0600","dateStarted":"2019-02-27T22:26:15-0600","dateFinished":"2019-02-27T22:26:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:355"},{"text":"%pyspark\ndp.columns = ['a','b','c','d']\ndp.head(4)\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:15-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"       a     b     c     d\n0  230.1  37.8  69.2  22.1\n1   44.5  39.3  45.1  10.4\n2   17.2  45.9  69.3   9.3\n3  151.5  41.3  58.5  18.5"}]},"apps":[],"jobName":"paragraph_1551307180935_828554036","id":"20190227-163940_1619361289","dateCreated":"2019-02-27T16:39:40-0600","dateStarted":"2019-02-27T22:26:15-0600","dateFinished":"2019-02-27T22:26:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:356"},{"text":"%pyspark\nds.toDF('a','b','c','d').show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:15-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----+----+----+\n|    a|   b|   c|   d|\n+-----+----+----+----+\n|230.1|37.8|69.2|22.1|\n| 44.5|39.3|45.1|10.4|\n| 17.2|45.9|69.3| 9.3|\n|151.5|41.3|58.5|18.5|\n+-----+----+----+----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551307180893_-441732164","id":"20190227-163940_1874420250","dateCreated":"2019-02-27T16:39:40-0600","dateStarted":"2019-02-27T22:26:15-0600","dateFinished":"2019-02-27T22:26:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:357"},{"text":"%pyspark\ndp.head(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:15-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"       a     b     c     d\n0  230.1  37.8  69.2  22.1\n1   44.5  39.3  45.1  10.4\n2   17.2  45.9  69.3   9.3\n3  151.5  41.3  58.5  18.5"}]},"apps":[],"jobName":"paragraph_1551307877270_-703492081","id":"20190227-165117_22190488","dateCreated":"2019-02-27T16:51:17-0600","dateStarted":"2019-02-27T22:26:15-0600","dateFinished":"2019-02-27T22:26:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:358"},{"text":"%pyspark\nds.show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+\n|   TV|Radio|Newspaper|Sales|\n+-----+-----+---------+-----+\n|230.1| 37.8|     69.2| 22.1|\n| 44.5| 39.3|     45.1| 10.4|\n| 17.2| 45.9|     69.3|  9.3|\n|151.5| 41.3|     58.5| 18.5|\n+-----+-----+---------+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551307891605_-822213093","id":"20190227-165131_1028330488","dateCreated":"2019-02-27T16:51:31-0600","dateStarted":"2019-02-27T22:26:16-0600","dateFinished":"2019-02-27T22:26:16-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:359"},{"text":"%pyspark\ndp.columns = ['TV', 'Radio', 'Newspaper', 'Sales']","user":"anonymous","dateUpdated":"2019-02-27T22:26:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551307180850_-1438140942","id":"20190227-163940_1619057844","dateCreated":"2019-02-27T16:39:40-0600","dateStarted":"2019-02-27T22:26:16-0600","dateFinished":"2019-02-27T22:26:16-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:360"},{"text":"%md\n### Rename one or more columns","user":"anonymous","dateUpdated":"2019-02-27T22:26:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Rename one or more columns</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551305986935_-246599416","id":"20190227-161946_2025218069","dateCreated":"2019-02-27T16:19:46-0600","dateStarted":"2019-02-27T22:26:16-0600","dateFinished":"2019-02-27T22:26:16-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:361"},{"text":"%pyspark\nmapping = {'Newspaper':'C','Sales':'D'}","user":"anonymous","dateUpdated":"2019-02-27T22:26:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551307434980_660897098","id":"20190227-164354_1372227931","dateCreated":"2019-02-27T16:43:54-0600","dateStarted":"2019-02-27T22:26:16-0600","dateFinished":"2019-02-27T22:26:16-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:362"},{"text":"%pyspark\ndp.rename(columns=mapping).head(4)\n\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:16-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio     C     D\n0  230.1   37.8  69.2  22.1\n1   44.5   39.3  45.1  10.4\n2   17.2   45.9  69.3   9.3\n3  151.5   41.3  58.5  18.5"}]},"apps":[],"jobName":"paragraph_1551305987096_1283891213","id":"20190227-161947_281526740","dateCreated":"2019-02-27T16:19:47-0600","dateStarted":"2019-02-27T22:26:16-0600","dateFinished":"2019-02-27T22:26:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:363"},{"text":"%pyspark\nnew_names = [mapping.get(col,col) for col in ds.columns]\nds.toDF(*new_names).show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:17-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+----+----+\n|   TV|Radio|   C|   D|\n+-----+-----+----+----+\n|230.1| 37.8|69.2|22.1|\n| 44.5| 39.3|45.1|10.4|\n| 17.2| 45.9|69.3| 9.3|\n|151.5| 41.3|58.5|18.5|\n+-----+-----+----+----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551305978946_1952754534","id":"20190227-161938_1465646634","dateCreated":"2019-02-27T16:19:38-0600","dateStarted":"2019-02-27T22:26:17-0600","dateFinished":"2019-02-27T22:26:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:364"},{"text":"%pyspark\nds.withColumnRenamed('Newspaper','Paper').show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:17-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+-----+-----+\n|   TV|Radio|Paper|Sales|\n+-----+-----+-----+-----+\n|230.1| 37.8| 69.2| 22.1|\n| 44.5| 39.3| 45.1| 10.4|\n| 17.2| 45.9| 69.3|  9.3|\n|151.5| 41.3| 58.5| 18.5|\n+-----+-----+-----+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551307377463_1686772137","id":"20190227-164257_940059203","dateCreated":"2019-02-27T16:42:57-0600","dateStarted":"2019-02-27T22:26:17-0600","dateFinished":"2019-02-27T22:26:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:365"},{"text":"%pyspark\ndp.head()","user":"anonymous","dateUpdated":"2019-02-27T22:26:17-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales\n0  230.1   37.8       69.2   22.1\n1   44.5   39.3       45.1   10.4\n2   17.2   45.9       69.3    9.3\n3  151.5   41.3       58.5   18.5\n4  180.8   10.8       58.4   12.9"}]},"apps":[],"jobName":"paragraph_1551307805168_-1371291893","id":"20190227-165005_104941686","dateCreated":"2019-02-27T16:50:05-0600","dateStarted":"2019-02-27T22:26:17-0600","dateFinished":"2019-02-27T22:26:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:366"},{"text":"%md\n### drop columns","user":"anonymous","dateUpdated":"2019-02-27T22:26:17-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>drop columns</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551307858603_1766408950","id":"20190227-165058_6340948","dateCreated":"2019-02-27T16:50:58-0600","dateStarted":"2019-02-27T22:26:17-0600","dateFinished":"2019-02-27T22:26:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:367"},{"text":"%pyspark\ndrop_name = ['Newspaper','Sales']","user":"anonymous","dateUpdated":"2019-02-27T22:26:18-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551308078346_875957502","id":"20190227-165438_1858691334","dateCreated":"2019-02-27T16:54:38-0600","dateStarted":"2019-02-27T22:26:18-0600","dateFinished":"2019-02-27T22:26:18-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:368"},{"text":"%pyspark\ndp.drop(drop_name,axis=1).head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:18-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio\n0  230.1   37.8\n1   44.5   39.3\n2   17.2   45.9\n3  151.5   41.3"}]},"apps":[],"jobName":"paragraph_1551307823593_-1268381863","id":"20190227-165023_2128154080","dateCreated":"2019-02-27T16:50:23-0600","dateStarted":"2019-02-27T22:26:18-0600","dateFinished":"2019-02-27T22:26:18-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:369"},{"text":"%pyspark\nds.drop(*drop_name).show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:18-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+\n|   TV|Radio|\n+-----+-----+\n|230.1| 37.8|\n| 44.5| 39.3|\n| 17.2| 45.9|\n|151.5| 41.3|\n+-----+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551308056394_-83053508","id":"20190227-165416_1055293632","dateCreated":"2019-02-27T16:54:16-0600","dateStarted":"2019-02-27T22:26:18-0600","dateFinished":"2019-02-27T22:26:18-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:370"},{"text":"%md\n### Fill null","user":"anonymous","dateUpdated":"2019-02-27T22:26:18-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Fill null</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551308192159_-1883713502","id":"20190227-165632_949065427","dateCreated":"2019-02-27T16:56:32-0600","dateStarted":"2019-02-27T22:26:18-0600","dateFinished":"2019-02-27T22:26:18-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:371"},{"text":"%pyspark\nmy_list = [['male', 1, None], ['female', 2, 3],['male', 3, 4]]\ndp = pd.DataFrame(my_list,columns=['A', 'B', 'C'])\nds = spark.createDataFrame(my_list, ['A', 'B', 'C'])","user":"anonymous","dateUpdated":"2019-02-28T14:41:44-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551308191247_879669201","id":"20190227-165631_1615241426","dateCreated":"2019-02-27T16:56:31-0600","dateStarted":"2019-02-28T14:41:44-0600","dateFinished":"2019-02-28T14:41:46-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:372"},{"text":"%pyspark\ndp.head()\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-28T14:41:47-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"        A  B    C\n0    male  1  NaN\n1  female  2  3.0\n2    male  3  4.0"}]},"apps":[],"jobName":"paragraph_1551308189032_-976221591","id":"20190227-165629_157142740","dateCreated":"2019-02-27T16:56:29-0600","dateStarted":"2019-02-28T14:41:47-0600","dateFinished":"2019-02-28T14:41:47-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:373"},{"text":"%pyspark\nds.show()","user":"anonymous","dateUpdated":"2019-02-28T14:41:51-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---+----+\n|     A|  B|   C|\n+------+---+----+\n|  male|  1|null|\n|female|  2|   3|\n|  male|  3|   4|\n+------+---+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551308073024_-451677207","id":"20190227-165433_1527144096","dateCreated":"2019-02-27T16:54:33-0600","dateStarted":"2019-02-28T14:41:51-0600","dateFinished":"2019-02-28T14:41:54-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:374"},{"text":"%pyspark\ndp.fillna(-999)\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:19-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A  B      C\n0  a  1 -999.0\n1  b  2    3.0\n2  c  3    4.0"}]},"apps":[],"jobName":"paragraph_1551308284782_-1864033282","id":"20190227-165804_1370594166","dateCreated":"2019-02-27T16:58:04-0600","dateStarted":"2019-02-27T22:26:19-0600","dateFinished":"2019-02-27T22:26:19-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:375"},{"text":"%pyspark\nds.fillna(-999).show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:19-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+----+\n|  A|  B|   C|\n+---+---+----+\n|  a|  1|-999|\n|  b|  2|   3|\n|  c|  3|   4|\n+---+---+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551308285135_1966833315","id":"20190227-165805_712930451","dateCreated":"2019-02-27T16:58:05-0600","dateStarted":"2019-02-27T22:26:19-0600","dateFinished":"2019-02-27T22:26:20-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:376"},{"text":"%md\n### Replace Values","user":"anonymous","dateUpdated":"2019-02-27T22:26:20-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Replace Values</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551308285639_1296611507","id":"20190227-165805_589832515","dateCreated":"2019-02-27T16:58:05-0600","dateStarted":"2019-02-27T22:26:20-0600","dateFinished":"2019-02-27T22:26:20-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:377"},{"text":"%pyspark\n# my_list = [['male', 1, 2], ['female', 2, 3],['female', 3, 4]]\n# dp = pd.DataFrame(my_list,columns=['A', 'B','C'])\n# ds = spark.createDataFrame(my_list, ['A', 'B','C'])","user":"anonymous","dateUpdated":"2019-02-28T14:43:26-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551308286137_-1441815604","id":"20190227-165806_2079821168","dateCreated":"2019-02-27T16:58:06-0600","dateStarted":"2019-02-28T14:43:18-0600","dateFinished":"2019-02-28T14:43:19-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:378"},{"text":"%pyspark\ndp\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-28T14:42:19-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"        A  B    C\n0    male  1  NaN\n1  female  2  3.0\n2    male  3  4.0"}]},"apps":[],"jobName":"paragraph_1551308286751_-644374181","id":"20190227-165806_1603410152","dateCreated":"2019-02-27T16:58:06-0600","dateStarted":"2019-02-28T14:42:19-0600","dateFinished":"2019-02-28T14:42:19-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:379"},{"text":"%pyspark\nds.show()","user":"anonymous","dateUpdated":"2019-02-28T14:42:25-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---+----+\n|     A|  B|   C|\n+------+---+----+\n|  male|  1|null|\n|female|  2|   3|\n|  male|  3|   4|\n+------+---+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551308287207_-1678888917","id":"20190227-165807_709327862","dateCreated":"2019-02-27T16:58:07-0600","dateStarted":"2019-02-28T14:42:25-0600","dateFinished":"2019-02-28T14:42:25-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:380"},{"text":"%pyspark\n# caution: you need to chose specific col\ndp.A.replace(['male', 'female'],[1, 0], inplace=True)\ndp\n\n\n","user":"anonymous","dateUpdated":"2019-02-28T14:42:37-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A  B    C\n0  1  1  NaN\n1  0  2  3.0\n2  1  3  4.0"}]},"apps":[],"jobName":"paragraph_1551308287145_-530495132","id":"20190227-165807_1588282776","dateCreated":"2019-02-27T16:58:07-0600","dateStarted":"2019-02-28T14:42:37-0600","dateFinished":"2019-02-28T14:42:37-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:381"},{"text":"%pyspark\n#caution: Mixed type replacements are not supported\nds.na.replace(['male','female'],['1','0']).show()","user":"anonymous","dateUpdated":"2019-02-28T14:42:40-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+----+\n|  A|  B|   C|\n+---+---+----+\n|  1|  1|null|\n|  0|  2|   3|\n|  1|  3|   4|\n+---+---+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551308286534_-1800682285","id":"20190227-165806_1534235130","dateCreated":"2019-02-27T16:58:06-0600","dateStarted":"2019-02-28T14:42:40-0600","dateFinished":"2019-02-28T14:42:40-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:382"},{"text":"%md\n### Filter","user":"anonymous","dateUpdated":"2019-02-27T22:26:21-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Filter</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551309225448_-2131570201","id":"20190227-171345_1793527138","dateCreated":"2019-02-27T17:13:45-0600","dateStarted":"2019-02-27T22:26:21-0600","dateFinished":"2019-02-27T22:26:21-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:383"},{"text":"%pyspark\nds = spark.read.csv(path='/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv',\n                    header=True, \n                    inferSchema=True)\ndp = pd.read_csv('/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv')","user":"anonymous","dateUpdated":"2019-02-28T15:25:29-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551309225385_2091133437","id":"20190227-171345_531508372","dateCreated":"2019-02-27T17:13:45-0600","dateStarted":"2019-02-28T15:25:29-0600","dateFinished":"2019-02-28T15:25:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:384"},{"text":"%pyspark\ndp[dp.Newspaper<20].head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:22-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"       TV  Radio  Newspaper  Sales\n7   120.2   19.6       11.6   13.2\n8     8.6    2.1        1.0    4.8\n11  214.7   24.0        4.0   17.4\n13   97.5    7.6        7.2    9.7"}]},"apps":[],"jobName":"paragraph_1551309225001_22468222","id":"20190227-171345_1698870142","dateCreated":"2019-02-27T17:13:45-0600","dateStarted":"2019-02-27T22:26:22-0600","dateFinished":"2019-02-27T22:26:22-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:385"},{"text":"%pyspark\nds[ds.Newspaper<20].show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:22-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+\n|   TV|Radio|Newspaper|Sales|\n+-----+-----+---------+-----+\n|120.2| 19.6|     11.6| 13.2|\n|  8.6|  2.1|      1.0|  4.8|\n|214.7| 24.0|      4.0| 17.4|\n| 97.5|  7.6|      7.2|  9.7|\n+-----+-----+---------+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309224930_822494183","id":"20190227-171344_1845482533","dateCreated":"2019-02-27T17:13:44-0600","dateStarted":"2019-02-27T22:26:22-0600","dateFinished":"2019-02-27T22:26:22-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:386"},{"text":"%pyspark\ndp[(dp.Newspaper<20)&(dp.TV>100)].head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:22-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"       TV  Radio  Newspaper  Sales\n7   120.2   19.6       11.6   13.2\n11  214.7   24.0        4.0   17.4\n19  147.3   23.9       19.1   14.6\n25  262.9    3.5       19.5   12.0"}]},"apps":[],"jobName":"paragraph_1551309224698_-2145610251","id":"20190227-171344_488560324","dateCreated":"2019-02-27T17:13:44-0600","dateStarted":"2019-02-27T22:26:22-0600","dateFinished":"2019-02-27T22:26:22-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:387"},{"text":"%pyspark\nds[(ds.Newspaper<20)&(ds.TV>100)].show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:22-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+\n|   TV|Radio|Newspaper|Sales|\n+-----+-----+---------+-----+\n|120.2| 19.6|     11.6| 13.2|\n|214.7| 24.0|      4.0| 17.4|\n|147.3| 23.9|     19.1| 14.6|\n|262.9|  3.5|     19.5| 12.0|\n+-----+-----+---------+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309352556_1069542677","id":"20190227-171552_2092967894","dateCreated":"2019-02-27T17:15:52-0600","dateStarted":"2019-02-27T22:26:23-0600","dateFinished":"2019-02-27T22:26:23-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:388"},{"text":"%md\n### With New Columns","user":"anonymous","dateUpdated":"2019-02-27T22:26:23-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>With New Columns</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551309353015_1322018258","id":"20190227-171553_1963653922","dateCreated":"2019-02-27T17:15:53-0600","dateStarted":"2019-02-27T22:26:23-0600","dateFinished":"2019-02-27T22:26:23-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:389"},{"text":"%pyspark\ndp['tv_norm'] = dp.TV/sum(dp.TV)\ndp.head(4)\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:23-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales   tv_norm\n0  230.1   37.8       69.2   22.1  0.007824\n1   44.5   39.3       45.1   10.4  0.001513\n2   17.2   45.9       69.3    9.3  0.000585\n3  151.5   41.3       58.5   18.5  0.005152"}]},"apps":[],"jobName":"paragraph_1551309352856_2109120160","id":"20190227-171552_1627946275","dateCreated":"2019-02-27T17:15:52-0600","dateStarted":"2019-02-27T22:26:23-0600","dateFinished":"2019-02-27T22:26:23-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:390"},{"text":"%pyspark\nds.withColumn('tv_norm', ds.TV/ds.groupBy().agg(F.sum(\"TV\")).collect()[0][0]).show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:23-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+--------------------+\n|   TV|Radio|Newspaper|Sales|             tv_norm|\n+-----+-----+---------+-----+--------------------+\n|230.1| 37.8|     69.2| 22.1|0.007824268493802813|\n| 44.5| 39.3|     45.1| 10.4|0.001513167961643...|\n| 17.2| 45.9|     69.3|  9.3|5.848649200061207E-4|\n|151.5| 41.3|     58.5| 18.5|0.005151571824472517|\n+-----+-----+---------+-----+--------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309352774_-297006050","id":"20190227-171552_1736602133","dateCreated":"2019-02-27T17:15:52-0600","dateStarted":"2019-02-27T22:26:23-0600","dateFinished":"2019-02-27T22:26:24-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:391"},{"text":"%pyspark\nds = spark.read.csv(path='/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv',\n                    header=True, \n                    inferSchema=True)\ndp = pd.read_csv('/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv')","user":"anonymous","dateUpdated":"2019-02-28T15:25:12-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551388997840_1344907649","id":"20190228-152317_910060222","dateCreated":"2019-02-28T15:23:17-0600","dateStarted":"2019-02-28T15:25:12-0600","dateFinished":"2019-02-28T15:25:14-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:392"},{"text":"%pyspark\ndp['cond'] = dp.apply(lambda c: 1 if ((c.TV>100)&(c.Radio<40)) else 2 if c.Sales> 10 else 3,axis=1)\n\n\n\n\n\ndp.head(4)","user":"anonymous","dateUpdated":"2019-02-28T15:25:17-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales  cond\n0  230.1   37.8       69.2   22.1     1\n1   44.5   39.3       45.1   10.4     2\n2   17.2   45.9       69.3    9.3     3\n3  151.5   41.3       58.5   18.5     2"}]},"apps":[],"jobName":"paragraph_1551309353756_1041106854","id":"20190227-171553_939038295","dateCreated":"2019-02-27T17:15:53-0600","dateStarted":"2019-02-28T15:25:17-0600","dateFinished":"2019-02-28T15:25:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:393"},{"text":"%pyspark\nds.withColumn('cond',F.when((ds.TV>100)&(ds.Radio<40),1)\\\n                      .when(ds.Sales>10, 2)\\\n                      .otherwise(3)).show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:24-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+----+\n|   TV|Radio|Newspaper|Sales|cond|\n+-----+-----+---------+-----+----+\n|230.1| 37.8|     69.2| 22.1|   1|\n| 44.5| 39.3|     45.1| 10.4|   2|\n| 17.2| 45.9|     69.3|  9.3|   3|\n|151.5| 41.3|     58.5| 18.5|   2|\n+-----+-----+---------+-----+----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309353715_-1441209784","id":"20190227-171553_1646627208","dateCreated":"2019-02-27T17:15:53-0600","dateStarted":"2019-02-27T22:26:24-0600","dateFinished":"2019-02-27T22:26:24-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:394"},{"text":"%pyspark\nds = spark.read.csv(path='/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv',\n                    header=True, \n                    inferSchema=True)\ndp = pd.read_csv('/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv')","user":"anonymous","dateUpdated":"2019-02-28T15:29:39-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551389376114_-1294490443","id":"20190228-152936_1013161649","dateCreated":"2019-02-28T15:29:36-0600","dateStarted":"2019-02-28T15:29:39-0600","dateFinished":"2019-02-28T15:29:40-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:395"},{"text":"%pyspark\ndp['log_tv'] = np.log(dp.TV)\ndp.head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-28T15:29:42-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales    log_tv\n0  230.1   37.8       69.2   22.1  5.438514\n1   44.5   39.3       45.1   10.4  3.795489\n2   17.2   45.9       69.3    9.3  2.844909\n3  151.5   41.3       58.5   18.5  5.020586"}]},"apps":[],"jobName":"paragraph_1551309353679_856629656","id":"20190227-171553_872369830","dateCreated":"2019-02-27T17:15:53-0600","dateStarted":"2019-02-28T15:29:43-0600","dateFinished":"2019-02-28T15:29:43-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:396"},{"text":"%pyspark\nfrom pyspark.sql import functions as F\nds.withColumn('log_tv',F.log(ds.TV)).show(4)","user":"anonymous","dateUpdated":"2019-02-28T15:29:45-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+------------------+\n|   TV|Radio|Newspaper|Sales|            log_tv|\n+-----+-----+---------+-----+------------------+\n|230.1| 37.8|     69.2| 22.1|  5.43851399704132|\n| 44.5| 39.3|     45.1| 10.4|3.7954891891721947|\n| 17.2| 45.9|     69.3|  9.3|2.8449093838194073|\n|151.5| 41.3|     58.5| 18.5| 5.020585624949423|\n+-----+-----+---------+-----+------------------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309353634_1666558356","id":"20190227-171553_1090793617","dateCreated":"2019-02-27T17:15:53-0600","dateStarted":"2019-02-28T15:29:45-0600","dateFinished":"2019-02-28T15:29:46-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:397"},{"text":"%pyspark\nds = spark.read.csv(path='/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv',\n                    header=True, \n                    inferSchema=True)\ndp = pd.read_csv('/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv')","user":"anonymous","dateUpdated":"2019-02-28T15:34:55-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551389690097_953211165","id":"20190228-153450_2095011830","dateCreated":"2019-02-28T15:34:50-0600","dateStarted":"2019-02-28T15:34:55-0600","dateFinished":"2019-02-28T15:34:56-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:398"},{"text":"%pyspark\ndp['tv+10'] = dp.TV.apply(lambda x: x+10)\ndp.head(4)\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-28T15:34:59-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales  tv+10\n0  230.1   37.8       69.2   22.1  240.1\n1   44.5   39.3       45.1   10.4   54.5\n2   17.2   45.9       69.3    9.3   27.2\n3  151.5   41.3       58.5   18.5  161.5"}]},"apps":[],"jobName":"paragraph_1551309354974_-818200771","id":"20190227-171554_833884287","dateCreated":"2019-02-27T17:15:54-0600","dateStarted":"2019-02-28T15:34:59-0600","dateFinished":"2019-02-28T15:34:59-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:399"},{"text":"%pyspark\nds.withColumn('tv+10', ds.TV+10).show(4)","user":"anonymous","dateUpdated":"2019-02-28T15:35:01-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+-----+\n|   TV|Radio|Newspaper|Sales|tv+10|\n+-----+-----+---------+-----+-----+\n|230.1| 37.8|     69.2| 22.1|240.1|\n| 44.5| 39.3|     45.1| 10.4| 54.5|\n| 17.2| 45.9|     69.3|  9.3| 27.2|\n|151.5| 41.3|     58.5| 18.5|161.5|\n+-----+-----+---------+-----+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309354797_1458883303","id":"20190227-171554_1571365394","dateCreated":"2019-02-27T17:15:54-0600","dateStarted":"2019-02-28T15:35:01-0600","dateFinished":"2019-02-28T15:35:01-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:400"},{"text":"%md\n### Join","user":"anonymous","dateUpdated":"2019-02-27T22:26:25-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Join</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551309354741_1304635344","id":"20190227-171554_2142389481","dateCreated":"2019-02-27T17:15:54-0600","dateStarted":"2019-02-27T22:26:25-0600","dateFinished":"2019-02-27T22:26:25-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:401"},{"text":"%pyspark\nds = spark.read.csv(path='/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv',\n                    header=True, \n                    inferSchema=True)\ndp = pd.read_csv('/Users/dt216661/Documents/MyTutorial/PythonTipsDS/doc/code/CodeForTutor/data/Advertising.csv')\n\nleftp = dp[['TV', 'Radio', 'Newspaper']]\nrightp = dp[['TV','Sales']]\n\nlefts = ds[['TV', 'Radio', 'Newspaper']]\nrights = ds[['TV','Sales']]","user":"anonymous","dateUpdated":"2019-02-28T15:39:09-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551309637662_800986313","id":"20190227-172037_1228928201","dateCreated":"2019-02-27T17:20:37-0600","dateStarted":"2019-02-28T15:39:09-0600","dateFinished":"2019-02-28T15:39:10-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:402"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:26-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551324773923_1056945135","id":"20190227-213253_116491835","dateCreated":"2019-02-27T21:32:53-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"text":"%pyspark\nleftp.head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:26-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper\n0  230.1   37.8       69.2\n1   44.5   39.3       45.1\n2   17.2   45.9       69.3\n3  151.5   41.3       58.5"}]},"apps":[],"jobName":"paragraph_1551324136528_-377356337","id":"20190227-212216_319595900","dateCreated":"2019-02-27T21:22:16-0600","dateStarted":"2019-02-27T22:26:26-0600","dateFinished":"2019-02-27T22:26:26-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:404"},{"text":"%pyspark\nlefts.show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:27-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+\n|   TV|Radio|Newspaper|\n+-----+-----+---------+\n|230.1| 37.8|     69.2|\n| 44.5| 39.3|     45.1|\n| 17.2| 45.9|     69.3|\n|151.5| 41.3|     58.5|\n+-----+-----+---------+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551324410676_-781946984","id":"20190227-212650_1466041618","dateCreated":"2019-02-27T21:26:50-0600","dateStarted":"2019-02-27T22:26:27-0600","dateFinished":"2019-02-27T22:26:27-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:405"},{"text":"%pyspark\nrightp.head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:27-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Sales\n0  230.1   22.1\n1   44.5   10.4\n2   17.2    9.3\n3  151.5   18.5"}]},"apps":[],"jobName":"paragraph_1551324383459_-2007956518","id":"20190227-212623_1346725864","dateCreated":"2019-02-27T21:26:23-0600","dateStarted":"2019-02-27T22:26:27-0600","dateFinished":"2019-02-27T22:26:27-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:406"},{"text":"%pyspark\nrights.show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:27-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+\n|   TV|Sales|\n+-----+-----+\n|230.1| 22.1|\n| 44.5| 10.4|\n| 17.2|  9.3|\n|151.5| 18.5|\n+-----+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551324447751_1819955942","id":"20190227-212727_693198197","dateCreated":"2019-02-27T21:27:27-0600","dateStarted":"2019-02-27T22:26:27-0600","dateFinished":"2019-02-27T22:26:28-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:407"},{"text":"%md\n#### left join","user":"anonymous","dateUpdated":"2019-02-27T22:26:28-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>left join</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1551309750875_474845565","id":"20190227-172230_924149548","dateCreated":"2019-02-27T17:22:30-0600","dateStarted":"2019-02-27T22:26:28-0600","dateFinished":"2019-02-27T22:26:28-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:408"},{"text":"%pyspark\nleftp.merge(rightp, on='TV',how='left').head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-28T15:41:45-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Radio  Newspaper  Sales\n0  230.1   37.8       69.2   22.1\n1   44.5   39.3       45.1   10.4\n2   17.2   45.9       69.3    9.3\n3   17.2   45.9       69.3    5.9"}]},"apps":[],"jobName":"paragraph_1551309636751_1214307502","id":"20190227-172036_465437920","dateCreated":"2019-02-27T17:20:36-0600","dateStarted":"2019-02-28T15:41:45-0600","dateFinished":"2019-02-28T15:41:45-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:409"},{"text":"%pyspark\nlefts.join(rights, on='TV',how='left').show(4)","user":"anonymous","dateUpdated":"2019-02-28T15:41:49-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+\n|   TV|Radio|Newspaper|Sales|\n+-----+-----+---------+-----+\n|230.1| 37.8|     69.2| 22.1|\n| 44.5| 39.3|     45.1| 10.4|\n| 17.2| 45.9|     69.3|  5.9|\n| 17.2| 45.9|     69.3|  9.3|\n+-----+-----+---------+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309634832_1944532069","id":"20190227-172034_1292241601","dateCreated":"2019-02-27T17:20:34-0600","dateStarted":"2019-02-28T15:41:49-0600","dateFinished":"2019-02-28T15:41:49-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:410"},{"text":"%pyspark\nrightp.merge(leftp,on='TV').head(4)\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:29-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      TV  Sales  Radio  Newspaper\n0  230.1   22.1   37.8       69.2\n1   44.5   10.4   39.3       45.1\n2   17.2    9.3   45.9       69.3\n3   17.2    9.3    4.1       31.6"}]},"apps":[],"jobName":"paragraph_1551309632946_1617194271","id":"20190227-172032_1019984788","dateCreated":"2019-02-27T17:20:32-0600","dateStarted":"2019-02-27T22:26:29-0600","dateFinished":"2019-02-27T22:26:29-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:411"},{"text":"%pyspark\nlefts.join(rights, on='TV',how='right').show(4)","user":"anonymous","dateUpdated":"2019-02-27T22:26:29-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+-----+---------+-----+\n|   TV|Radio|Newspaper|Sales|\n+-----+-----+---------+-----+\n|230.1| 37.8|     69.2| 22.1|\n| 44.5| 39.3|     45.1| 10.4|\n| 17.2|  4.1|     31.6|  9.3|\n| 17.2| 45.9|     69.3|  9.3|\n+-----+-----+---------+-----+\nonly showing top 4 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551309354691_644751810","id":"20190227-171554_1404410002","dateCreated":"2019-02-27T17:15:54-0600","dateStarted":"2019-02-27T22:26:29-0600","dateFinished":"2019-02-27T22:26:29-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:412"},{"text":"%pyspark\nleftp = pd.DataFrame({'A': ['A0', 'A1', 'A2', 'A3'],\n                    'B': ['B0', 'B1', 'B2', 'B3'],\n                    'C': ['C0', 'C1', 'C2', 'C3'],\n                    'D': ['D0', 'D1', 'D2', 'D3']},\n                    index=[0, 1, 2, 3])\n                    \nrightp = pd.DataFrame({'A': ['A0', 'A1', 'A6', 'A7'],\n                       'F': ['B4', 'B5', 'B6', 'B7'],\n                       'G': ['C4', 'C5', 'C6', 'C7'],\n                       'H': ['D4', 'D5', 'D6', 'D7']},\n                       index=[4, 5, 6, 7])\n\nlefts = spark.createDataFrame(leftp)  \nrights = spark.createDataFrame(rightp)","user":"anonymous","dateUpdated":"2019-02-27T22:26:29-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551324664459_-2028692379","id":"20190227-213104_963662150","dateCreated":"2019-02-27T21:31:04-0600","dateStarted":"2019-02-27T22:26:29-0600","dateFinished":"2019-02-27T22:26:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:413"},{"text":"%pyspark\nleftp\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:30-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"    A   B   C   D\n0  A0  B0  C0  D0\n1  A1  B1  C1  D1\n2  A2  B2  C2  D2\n3  A3  B3  C3  D3"}]},"apps":[],"jobName":"paragraph_1551325172488_-1642106141","id":"20190227-213932_1752026800","dateCreated":"2019-02-27T21:39:32-0600","dateStarted":"2019-02-27T22:26:30-0600","dateFinished":"2019-02-27T22:26:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:414"},{"text":"%pyspark\nlefts.show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:30-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+---+\n|  A|  B|  C|  D|\n+---+---+---+---+\n| A0| B0| C0| D0|\n| A1| B1| C1| D1|\n| A2| B2| C2| D2|\n| A3| B3| C3| D3|\n+---+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1551325228971_839842253","id":"20190227-214028_894341427","dateCreated":"2019-02-27T21:40:28-0600","dateStarted":"2019-02-27T22:26:30-0600","dateFinished":"2019-02-27T22:26:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:415"},{"text":"%pyspark\nrightp\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:30-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"    A   F   G   H\n4  A0  B4  C4  D4\n5  A1  B5  C5  D5\n6  A6  B6  C6  D6\n7  A7  B7  C7  D7"}]},"apps":[],"jobName":"paragraph_1551325242405_-1318856240","id":"20190227-214042_1769810960","dateCreated":"2019-02-27T21:40:42-0600","dateStarted":"2019-02-27T22:26:30-0600","dateFinished":"2019-02-27T22:26:30-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:416"},{"text":"%pyspark\nrights.show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:30-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+---+\n|  A|  F|  G|  H|\n+---+---+---+---+\n| A0| B4| C4| D4|\n| A1| B5| C5| D5|\n| A6| B6| C6| D6|\n| A7| B7| C7| D7|\n+---+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1551325304130_1135947617","id":"20190227-214144_575548185","dateCreated":"2019-02-27T21:41:44-0600","dateStarted":"2019-02-27T22:26:31-0600","dateFinished":"2019-02-27T22:26:31-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:417"},{"text":"%md\n#### Left join","user":"anonymous","dateUpdated":"2019-02-27T22:26:31-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Left join</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1551326282149_-982872519","id":"20190227-215802_15535561","dateCreated":"2019-02-27T21:58:02-0600","dateStarted":"2019-02-27T22:26:31-0600","dateFinished":"2019-02-27T22:26:31-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:418"},{"text":"%pyspark\nleftp.merge(rightp,on='A',how='left')\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:31-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"    A   B   C   D    F    G    H\n0  A0  B0  C0  D0   B4   C4   D4\n1  A1  B1  C1  D1   B5   C5   D5\n2  A2  B2  C2  D2  NaN  NaN  NaN\n3  A3  B3  C3  D3  NaN  NaN  NaN"}]},"apps":[],"jobName":"paragraph_1551325299719_756698613","id":"20190227-214139_1767933433","dateCreated":"2019-02-27T21:41:39-0600","dateStarted":"2019-02-27T22:26:31-0600","dateFinished":"2019-02-27T22:26:31-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:419"},{"text":"%pyspark\nlefts.join(rights,on='A',how='left').orderBy('A',ascending=True).show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:31-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+---+----+----+----+\n|  A|  B|  C|  D|   F|   G|   H|\n+---+---+---+---+----+----+----+\n| A0| B0| C0| D0|  B4|  C4|  D4|\n| A1| B1| C1| D1|  B5|  C5|  D5|\n| A2| B2| C2| D2|null|null|null|\n| A3| B3| C3| D3|null|null|null|\n+---+---+---+---+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551325298571_-920234423","id":"20190227-214138_790013907","dateCreated":"2019-02-27T21:41:38-0600","dateStarted":"2019-02-27T22:26:31-0600","dateFinished":"2019-02-27T22:26:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:420"},{"text":"%md\n#### Right join","user":"anonymous","dateUpdated":"2019-02-27T22:26:32-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Right join</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1551326305616_-1459221142","id":"20190227-215825_1945972109","dateCreated":"2019-02-27T21:58:25-0600","dateStarted":"2019-02-27T22:26:32-0600","dateFinished":"2019-02-27T22:26:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:421"},{"text":"%pyspark\nleftp.merge(rightp,on='A',how='right')\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:32-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"    A    B    C    D   F   G   H\n0  A0   B0   C0   D0  B4  C4  D4\n1  A1   B1   C1   D1  B5  C5  D5\n2  A6  NaN  NaN  NaN  B6  C6  D6\n3  A7  NaN  NaN  NaN  B7  C7  D7"}]},"apps":[],"jobName":"paragraph_1551325856815_-212269106","id":"20190227-215056_906435993","dateCreated":"2019-02-27T21:50:56-0600","dateStarted":"2019-02-27T22:26:32-0600","dateFinished":"2019-02-27T22:26:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:422"},{"text":"%pyspark\nlefts.join(rights,on='A',how='right').orderBy('A',ascending=True).show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:32-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----+----+---+---+---+\n|  A|   B|   C|   D|  F|  G|  H|\n+---+----+----+----+---+---+---+\n| A0|  B0|  C0|  D0| B4| C4| D4|\n| A1|  B1|  C1|  D1| B5| C5| D5|\n| A6|null|null|null| B6| C6| D6|\n| A7|null|null|null| B7| C7| D7|\n+---+----+----+----+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1551325297147_-1764979901","id":"20190227-214137_1722524190","dateCreated":"2019-02-27T21:41:37-0600","dateStarted":"2019-02-27T22:26:32-0600","dateFinished":"2019-02-27T22:26:33-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:423"},{"text":"%md\n#### Inner join\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:33-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Inner join</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1551326369695_1082251393","id":"20190227-215929_860802374","dateCreated":"2019-02-27T21:59:29-0600","dateStarted":"2019-02-27T22:26:33-0600","dateFinished":"2019-02-27T22:26:33-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:424"},{"text":"%pyspark\nleftp.merge(rightp,on='A',how='inner')\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:33-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"    A   B   C   D   F   G   H\n0  A0  B0  C0  D0  B4  C4  D4\n1  A1  B1  C1  D1  B5  C5  D5"}]},"apps":[],"jobName":"paragraph_1551325294414_1205256759","id":"20190227-214134_1675591324","dateCreated":"2019-02-27T21:41:34-0600","dateStarted":"2019-02-27T22:26:33-0600","dateFinished":"2019-02-27T22:26:33-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:425"},{"text":"%pyspark\nlefts.join(rights,on='A',how='inner').show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:33-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+---+---+---+---+\n|  A|  B|  C|  D|  F|  G|  H|\n+---+---+---+---+---+---+---+\n| A0| B0| C0| D0| B4| C4| D4|\n| A1| B1| C1| D1| B5| C5| D5|\n+---+---+---+---+---+---+---+\n\n"}]},"apps":[],"jobName":"paragraph_1551325290239_226214506","id":"20190227-214130_1061498572","dateCreated":"2019-02-27T21:41:30-0600","dateStarted":"2019-02-27T22:26:34-0600","dateFinished":"2019-02-27T22:26:34-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:426"},{"text":"%md\n#### Full join","user":"anonymous","dateUpdated":"2019-02-27T22:26:34-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Full join</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1551326420017_1429597561","id":"20190227-220020_1015583967","dateCreated":"2019-02-27T22:00:20-0600","dateStarted":"2019-02-27T22:26:34-0600","dateFinished":"2019-02-27T22:26:34-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:427"},{"text":"%pyspark\nleftp.merge(rightp,on='A',how='outer')\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:35-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"    A    B    C    D    F    G    H\n0  A0   B0   C0   D0   B4   C4   D4\n1  A1   B1   C1   D1   B5   C5   D5\n2  A2   B2   C2   D2  NaN  NaN  NaN\n3  A3   B3   C3   D3  NaN  NaN  NaN\n4  A6  NaN  NaN  NaN   B6   C6   D6\n5  A7  NaN  NaN  NaN   B7   C7   D7"}]},"apps":[],"jobName":"paragraph_1551326457753_-2145724845","id":"20190227-220057_1986987825","dateCreated":"2019-02-27T22:00:57-0600","dateStarted":"2019-02-27T22:26:35-0600","dateFinished":"2019-02-27T22:26:35-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:428"},{"text":"%pyspark\nlefts.join(rights,on='A',how='full').orderBy('A').show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:35-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----+----+----+----+----+----+\n|  A|   B|   C|   D|   F|   G|   H|\n+---+----+----+----+----+----+----+\n| A0|  B0|  C0|  D0|  B4|  C4|  D4|\n| A1|  B1|  C1|  D1|  B5|  C5|  D5|\n| A2|  B2|  C2|  D2|null|null|null|\n| A3|  B3|  C3|  D3|null|null|null|\n| A6|null|null|null|  B6|  C6|  D6|\n| A7|null|null|null|  B7|  C7|  D7|\n+---+----+----+----+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551326458658_-1780690586","id":"20190227-220058_1691286473","dateCreated":"2019-02-27T22:00:58-0600","dateStarted":"2019-02-27T22:26:35-0600","dateFinished":"2019-02-27T22:26:36-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:429"},{"text":"%md\n#### Concat Columns \n","user":"anonymous","dateUpdated":"2019-02-27T22:26:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4>Concat Columns</h4>\n</div>"}]},"apps":[],"jobName":"paragraph_1551326460629_369051885","id":"20190227-220100_1705505752","dateCreated":"2019-02-27T22:01:00-0600","dateStarted":"2019-02-27T22:26:36-0600","dateFinished":"2019-02-27T22:26:36-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:430"},{"text":"%pyspark\nmy_list = [('a', 2, 3),\n           ('b', 5, 6),\n           ('c', 8, 9),\n           ('a', 2, 3),\n           ('b', 5, 6),\n           ('c', 8, 9)]\ncol_name = ['col1', 'col2', 'col3']","user":"anonymous","dateUpdated":"2019-02-27T22:26:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551326459396_-723218347","id":"20190227-220059_1183835097","dateCreated":"2019-02-27T22:00:59-0600","dateStarted":"2019-02-27T22:26:36-0600","dateFinished":"2019-02-27T22:26:36-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:431"},{"text":"%pyspark\ndp = pd.DataFrame(my_list,columns=col_name)\nds = spark.createDataFrame(my_list,schema=col_name)","user":"anonymous","dateUpdated":"2019-02-27T22:26:36-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551327420174_365990894","id":"20190227-221700_148160817","dateCreated":"2019-02-27T22:17:00-0600","dateStarted":"2019-02-27T22:26:36-0600","dateFinished":"2019-02-27T22:26:37-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:432"},{"text":"%pyspark\ndp\n\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:37-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"  col1  col2  col3\n0    a     2     3\n1    b     5     6\n2    c     8     9\n3    a     2     3\n4    b     5     6\n5    c     8     9"}]},"apps":[],"jobName":"paragraph_1551327420966_1560904836","id":"20190227-221700_378562664","dateCreated":"2019-02-27T22:17:00-0600","dateStarted":"2019-02-27T22:26:37-0600","dateFinished":"2019-02-27T22:26:37-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:433"},{"text":"%pyspark\nds.show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:37-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----+----+\n|col1|col2|col3|\n+----+----+----+\n|   a|   2|   3|\n|   b|   5|   6|\n|   c|   8|   9|\n|   a|   2|   3|\n|   b|   5|   6|\n|   c|   8|   9|\n+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551327422027_1609959918","id":"20190227-221702_1962443270","dateCreated":"2019-02-27T22:17:02-0600","dateStarted":"2019-02-27T22:26:37-0600","dateFinished":"2019-02-27T22:26:37-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:434"},{"text":"%pyspark\ndp['concat'] = dp.apply(lambda x:'%s%s'%(x['col1'],x['col2']),axis=1)\ndp\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:37-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"  col1  col2  col3 concat\n0    a     2     3     a2\n1    b     5     6     b5\n2    c     8     9     c8\n3    a     2     3     a2\n4    b     5     6     b5\n5    c     8     9     c8"}]},"apps":[],"jobName":"paragraph_1551327421930_1155362016","id":"20190227-221701_519969170","dateCreated":"2019-02-27T22:17:01-0600","dateStarted":"2019-02-27T22:26:37-0600","dateFinished":"2019-02-27T22:26:37-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:435"},{"text":"%pyspark\nds.withColumn('concat',F.concat('col1','col2')).show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:37-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----+----+------+\n|col1|col2|col3|concat|\n+----+----+----+------+\n|   a|   2|   3|    a2|\n|   b|   5|   6|    b5|\n|   c|   8|   9|    c8|\n|   a|   2|   3|    a2|\n|   b|   5|   6|    b5|\n|   c|   8|   9|    c8|\n+----+----+----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1551327421776_-486832966","id":"20190227-221701_1552986472","dateCreated":"2019-02-27T22:17:01-0600","dateStarted":"2019-02-27T22:26:37-0600","dateFinished":"2019-02-27T22:26:38-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:436"},{"text":"%md\n### GroupBy\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:38-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>GroupBy</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551327421702_-1819005105","id":"20190227-221701_1144391774","dateCreated":"2019-02-27T22:17:01-0600","dateStarted":"2019-02-27T22:26:38-0600","dateFinished":"2019-02-27T22:26:38-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:437"},{"text":"%pyspark\ndp.groupby(['col1']).agg({'col2':'min','col3':'mean'})\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:38-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      col2  col3\ncol1            \na        2     3\nb        5     6\nc        8     9"}]},"apps":[],"jobName":"paragraph_1551327421430_2043917772","id":"20190227-221701_1387424988","dateCreated":"2019-02-27T22:17:01-0600","dateStarted":"2019-02-27T22:26:38-0600","dateFinished":"2019-02-27T22:26:38-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:438"},{"text":"%pyspark\nds.groupBy(['col1']).agg({'col2': 'min', 'col3': 'avg'}).show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:38-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------+---------+\n|col1|min(col2)|avg(col3)|\n+----+---------+---------+\n|   c|        8|      9.0|\n|   b|        5|      6.0|\n|   a|        2|      3.0|\n+----+---------+---------+\n\n"}]},"apps":[],"jobName":"paragraph_1551327421335_1798291407","id":"20190227-221701_1249531374","dateCreated":"2019-02-27T22:17:01-0600","dateStarted":"2019-02-27T22:26:38-0600","dateFinished":"2019-02-27T22:26:39-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:439"},{"text":"%md\n### Pivot","user":"anonymous","dateUpdated":"2019-02-27T22:26:39-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>Pivot</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1551326455876_1199712053","id":"20190227-220055_1241187411","dateCreated":"2019-02-27T22:00:55-0600","dateStarted":"2019-02-27T22:26:39-0600","dateFinished":"2019-02-27T22:26:39-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:440"},{"text":"%pyspark\npd.pivot_table(dp, values='col3', index='col1', columns='col2', aggfunc=np.sum)\n\n\n","user":"anonymous","dateUpdated":"2019-02-27T22:26:39-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"col2    2     5     8\ncol1                 \na     6.0   NaN   NaN\nb     NaN  12.0   NaN\nc     NaN   NaN  18.0"}]},"apps":[],"jobName":"paragraph_1551327775369_389435121","id":"20190227-222255_585849450","dateCreated":"2019-02-27T22:22:55-0600","dateStarted":"2019-02-27T22:26:39-0600","dateFinished":"2019-02-27T22:26:39-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:441"},{"text":"%pyspark\nds.groupBy(['col1']).pivot('col2').sum('col3').show()","user":"anonymous","dateUpdated":"2019-02-27T22:26:39-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+----+----+----+\n|col1|   2|   5|   8|\n+----+----+----+----+\n|   c|null|null|  18|\n|   b|null|  12|null|\n|   a|   6|null|null|\n+----+----+----+----+\n\n"}]},"apps":[],"jobName":"paragraph_1551327810373_-1815136265","id":"20190227-222330_598193984","dateCreated":"2019-02-27T22:23:30-0600","dateStarted":"2019-02-27T22:26:39-0600","dateFinished":"2019-02-27T22:26:40-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:442"},{"text":"%pyspark\nmy_list = [['a', int(\"1284101485\")], ['b', int(\"2284101485\")],['c', int(\"3284101485\")]]\ncol_name = ['A', 'ts']","user":"anonymous","dateUpdated":"2019-03-07T22:08:16-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551327778204_-1268840838","id":"20190227-222258_1143037680","dateCreated":"2019-02-27T22:22:58-0600","dateStarted":"2019-03-07T22:08:17-0600","dateFinished":"2019-03-07T22:08:37-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:443"},{"text":"%pyspark\nimport pandas as pd\nfrom datetime import datetime\n\ndp = pd.DataFrame(my_list,columns=col_name)\nds = spark.createDataFrame(dp)","user":"anonymous","dateUpdated":"2019-03-07T22:08:54-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552018096799_2069103686","id":"20190307-220816_822186427","dateCreated":"2019-03-07T22:08:16-0600","dateStarted":"2019-03-07T22:08:54-0600","dateFinished":"2019-03-07T22:08:57-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:444"},{"text":"%pyspark\ndp","user":"anonymous","dateUpdated":"2019-03-07T22:09:06-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A          ts\n0  a  1284101485\n1  b  2284101485\n2  c  3284101485"}]},"apps":[],"jobName":"paragraph_1552018121241_1704036793","id":"20190307-220841_914559308","dateCreated":"2019-03-07T22:08:41-0600","dateStarted":"2019-03-07T22:09:06-0600","dateFinished":"2019-03-07T22:09:07-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:445"},{"text":"%pyspark\ndp['datetime'] = pd.to_datetime(dp['ts'], unit='s').dt.tz_localize('UTC')\ndp\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-03-07T22:10:19-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false}}},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A          ts                  datetime\n0  a  1284101485 2010-09-10 06:51:25+00:00\n1  b  2284101485 2042-05-19 08:38:05+00:00\n2  c  3284101485 2074-01-25 10:24:45+00:00"}]},"apps":[],"jobName":"paragraph_1552018146862_-76982155","id":"20190307-220906_524493835","dateCreated":"2019-03-07T22:09:06-0600","dateStarted":"2019-03-07T22:09:20-0600","dateFinished":"2019-03-07T22:09:20-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:446"},{"text":"%pyspark\nspark.conf.set(\"spark.sql.session.timeZone\", \"UTC\")\nfrom pyspark.sql.types import DateType\nds.withColumn('date', F.from_unixtime('ts')).show() #.cast(DateType())","user":"anonymous","dateUpdated":"2019-03-07T22:10:09-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+----------+-------------------+\n|  A|        ts|               date|\n+---+----------+-------------------+\n|  a|1284101485|2010-09-10 06:51:25|\n|  b|2284101485|2042-05-19 08:38:05|\n|  c|3284101485|2074-01-25 10:24:45|\n+---+----------+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1552018159981_1785329759","id":"20190307-220919_1398297556","dateCreated":"2019-03-07T22:09:19-0600","dateStarted":"2019-03-07T22:10:01-0600","dateFinished":"2019-03-07T22:10:04-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:447"},{"text":"%pyspark\nmy_list = [('a', 2, 3),\n           ('b', 5, 6),\n           ('c', 8, 9),\n           ('a', 2, 3),\n           ('b', 5, 6),\n           ('c', 8, 9)]\ncol_name = ['col1', 'col2', 'col3']\ndp = pd.DataFrame(my_list,columns=col_name)\nds = spark.createDataFrame(dp)","user":"anonymous","dateUpdated":"2019-03-07T22:10:40-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552018220159_394300204","id":"20190307-221020_1927545506","dateCreated":"2019-03-07T22:10:20-0600","dateStarted":"2019-03-07T22:10:40-0600","dateFinished":"2019-03-07T22:10:40-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:448"},{"text":"%pyspark\ndp.dtypes","user":"anonymous","dateUpdated":"2019-03-07T22:11:11-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"col1    object\ncol2     int64\ncol3     int64\ndtype: object"}]},"apps":[],"jobName":"paragraph_1552018181711_427418018","id":"20190307-220941_1855535433","dateCreated":"2019-03-07T22:09:41-0600","dateStarted":"2019-03-07T22:10:49-0600","dateFinished":"2019-03-07T22:10:49-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:449"},{"text":"%pyspark\nds.dtypes\n\n\n","user":"anonymous","dateUpdated":"2019-03-07T22:11:16-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('col1', 'string'), ('col2', 'bigint'), ('col3', 'bigint')]"}]},"apps":[],"jobName":"paragraph_1552018249756_-408979999","id":"20190307-221049_95551478","dateCreated":"2019-03-07T22:10:49-0600","dateStarted":"2019-03-07T22:11:01-0600","dateFinished":"2019-03-07T22:11:01-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:450"},{"text":"%pyspark\nd = {'col2': 'string','col3':'string'}\ndp = dp.astype({'col2': 'str','col3':'str'})\nds = ds.select(*list(set(ds.columns)-set(d.keys())),\n               *(col(c[0]).astype(c[1]).alias(c[0]) for c in d.items()))","user":"anonymous","dateUpdated":"2019-03-07T22:12:02-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1552018261309_-1693560342","id":"20190307-221101_785811925","dateCreated":"2019-03-07T22:11:01-0600","dateStarted":"2019-03-07T22:12:02-0600","dateFinished":"2019-03-07T22:12:03-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:451"},{"text":"%pyspark\ndp.dtypes","user":"anonymous","dateUpdated":"2019-03-07T22:12:34-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"col1    object\ncol2    object\ncol3    object\ndtype: object"}]},"apps":[],"jobName":"paragraph_1552018334272_-1722386832","id":"20190307-221214_1019510476","dateCreated":"2019-03-07T22:12:14-0600","dateStarted":"2019-03-07T22:12:29-0600","dateFinished":"2019-03-07T22:12:29-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:452"},{"text":"%pyspark\nds.dtypes\n\n\n","user":"anonymous","dateUpdated":"2019-03-07T22:12:54-0600","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('col1', 'string'), ('col2', 'string'), ('col3', 'string')]"}]},"apps":[],"jobName":"paragraph_1552018304378_863989822","id":"20190307-221144_338938608","dateCreated":"2019-03-07T22:11:44-0600","dateStarted":"2019-03-07T22:12:43-0600","dateFinished":"2019-03-07T22:12:43-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:453"},{"text":"%pyspark\nd = {'A':['a','b','c','d'],'B':['m','m','n','n'],'C':[1,2,3,6]}\ndp = pd.DataFrame(d)\nds = spark.createDataFrame(dp)","user":"anonymous","dateUpdated":"2019-04-04T21:43:42-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1552018363341_-599727933","id":"20190307-221243_1153225643","dateCreated":"2019-03-07T22:12:43-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:454","dateFinished":"2019-04-04T21:43:44-0500","dateStarted":"2019-04-04T21:43:42-0500","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndp","user":"anonymous","dateUpdated":"2019-04-04T21:43:01-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554432140023_620891317","id":"20190404-214220_1663517484","dateCreated":"2019-04-04T21:42:20-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10740","dateFinished":"2019-04-04T21:43:02-0500","dateStarted":"2019-04-04T21:43:02-0500","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A  B  C\n0  a  m  1\n1  b  m  2\n2  c  n  3\n3  d  n  6"}]}},{"text":"%pyspark\ndp['rank'] = dp.groupby('B')['C'].rank('dense',ascending=False)\ndp\n\n\n\n\n\n\n","user":"anonymous","dateUpdated":"2019-04-04T21:44:38-0500","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554432148390_-797768537","id":"20190404-214228_215281661","dateCreated":"2019-04-04T21:42:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10833","dateFinished":"2019-04-04T21:43:29-0500","dateStarted":"2019-04-04T21:43:29-0500","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"   A  B  C  rank\n0  a  m  1   2.0\n1  b  m  2   1.0\n2  c  n  3   2.0\n3  d  n  6   1.0"}]}},{"text":"%pyspark\nfrom pyspark.sql.window import Window\nw = Window.partitionBy('B').orderBy(ds.C.desc())\nds = ds.withColumn('rank',F.rank().over(w))\nds.show()\n","user":"anonymous","dateUpdated":"2019-04-04T21:44:31-0500","config":{"colWidth":6,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554432208918_1179352126","id":"20190404-214328_898043131","dateCreated":"2019-04-04T21:43:28-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11012","dateFinished":"2019-04-04T21:44:20-0500","dateStarted":"2019-04-04T21:44:16-0500","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+---+----+\n|  A|  B|  C|rank|\n+---+---+---+----+\n|  b|  m|  2|   1|\n|  a|  m|  1|   2|\n|  d|  n|  6|   1|\n|  c|  n|  3|   2|\n+---+---+---+----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.4:4041/jobs/job?id=0","http://192.168.1.4:4041/jobs/job?id=1","http://192.168.1.4:4041/jobs/job?id=2","http://192.168.1.4:4041/jobs/job?id=3","http://192.168.1.4:4041/jobs/job?id=4"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-04-04T21:43:59-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554432239659_516930016","id":"20190404-214359_1514449293","dateCreated":"2019-04-04T21:43:59-0500","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11123"}],"name":"pd.DataFrame vs rdd.DataFrame","id":"2E41U3C95","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}