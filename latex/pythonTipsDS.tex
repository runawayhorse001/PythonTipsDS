%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,12pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}

\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{dsfont}
\def\Z{\mathbb{Z}}
\def\R{\mathbb{R}}
\def\bX{\mathbf{X}}
\def\X{\mathbf{X}}
\def\By{\mathbf{y}}
\def\Bbeta{\boldsymbol{\beta}}
\def\bU{\mathbf{U}}
\def\bV{\mathbf{V}}
\def\V1{\mathds{1}}
\def\hU{\mathbf{\hat{U}}}
\def\hS{\mathbf{\hat{\Sigma}}}
\def\hV{\mathbf{\hat{V}}}
\def\E{\mathbf{E}}
\def\F{\mathbf{F}}
\def\x{\mathbf{x}}
\def\h{\mathbf{h}}
\def\v{\mathbf{v}}
\def\nv{\mathbf{v^{{f -}}}}
\def\nh{\mathbf{h^{{f -}}}}
\def\s{\mathbf{s}}
\def\b{\mathbf{b}}
\def\c{\mathbf{c}}
\def\W{\mathbf{W}}
\def\C{\mathbf{C}}
\def\P{\mathbf{P}}
\def\T{{\bf \mathcal T}}
\def\B{{\bf \mathcal B}}
\def\euler{\ e^{i\pi} + 1 = 0}


\title{Python Tips for Data Scientist}
\date{December 28, 2021}
\release{}
\author{Wenqiang Feng and Jing Yang}
\newcommand{\sphinxlogo}{\sphinxincludegraphics{logo.png}\par}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}\phantomsection\label{\detokenize{index:index}}\begin{quote}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{logo}.png}
\end{figure}
\end{quote}

\sphinxAtStartPar
Welcome to my \sphinxstylestrong{Python Tips for Data Scientist} notes! In those notes, you will learn some useful tips for Data Scientist daily work. The PDF version can be downloaded from \sphinxhref{pythonTipsDS.pdf}{HERE}.




\chapter{Preface}
\label{\detokenize{preface:preface}}\label{\detokenize{preface:id1}}\label{\detokenize{preface::doc}}
\begin{sphinxadmonition}{note}{Chinese proverb}

\sphinxAtStartPar
The palest ink is better than the best memory. \textendash{} old Chinese proverb
\end{sphinxadmonition}


\section{About}
\label{\detokenize{preface:about}}

\subsection{About this note}
\label{\detokenize{preface:about-this-note}}
\sphinxAtStartPar
This document is a summary of our valueable experiences in using \sphinxcode{\sphinxupquote{Python}}
for \sphinxcode{\sphinxupquote{Data Scientist}} daily work. The PDF version can be downloaded from \sphinxhref{sphinxgithub.pdf}{HERE}.

\sphinxAtStartPar
\sphinxstylestrong{You may download and distribute it. Please be aware, however, that the note contains typos as well as inaccurate or incorrect description.}

\sphinxAtStartPar
In this repository, we try to use the detailed \sphinxcode{\sphinxupquote{Data Scientist}} related demo code and
examples to share some useful python tips for Data Scientist work. If you
find your work wasn’t cited in this note, please feel free to let me know.

\sphinxAtStartPar
Although we are by no means a python programming and Data Scientist expert,
We decided that it would be useful for us to share what we learned
about Python in the form of easy note with detailed example.
We hope those notes will be a valuable tool for your studies.

\sphinxAtStartPar
The notes assume that the reader has a preliminary knowledge of \sphinxcode{\sphinxupquote{python}} programing, \sphinxcode{\sphinxupquote{LaTex}} and \sphinxcode{\sphinxupquote{Linux}}. And this document is generated automatically by using \sphinxhref{http://sphinx.pocoo.org}{sphinx}. More details can be found at \sphinxcite{reference:georg2018}.


\subsection{About the authors}
\label{\detokenize{preface:about-the-authors}}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Wenqiang Feng}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Director of Data Science and PhD in Mathematics

\item {} 
\sphinxAtStartPar
University of Tennessee, Knoxville

\item {} 
\sphinxAtStartPar
Webpage: \sphinxurl{http://web.utk.edu/~wfeng1}

\item {} 
\sphinxAtStartPar
Email: \sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Jing Yang}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Senior Data Scientist and PhD in Physics

\item {} 
\sphinxAtStartPar
Harvard University

\item {} 
\sphinxAtStartPar
Webpage: \sphinxurl{https://scholar.harvard.edu/jingyang/home}

\item {} 
\sphinxAtStartPar
Email: \sphinxhref{mailto:jingyangharvard@gmail.com}{jingyangharvard@gmail.com}

\end{itemize}

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Declaration}

\sphinxAtStartPar
The work of Wenqiang Feng was supported by the IMA, while working at IMA. However,
any opinion, finding, and conclusions or recommendations expressed in this material
are those of the authors and do not necessarily reflect the views of the IMA, UTK,
DST and Harvard.

\end{itemize}


\section{Motivation for this note}
\label{\detokenize{preface:motivation-for-this-note}}
\sphinxAtStartPar
No matter you like it or not, Python has been one of the most popular programming languages.
I have been using \sphinxcode{\sphinxupquote{Python}} for almost 4 years. Frankly speaking, I wasn’t impressed and attracted
by \sphinxcode{\sphinxupquote{Python}} at the first using. After starting working in industry, I have to use \sphinxcode{\sphinxupquote{Python}}. Gradually
I recognize the elegance of Python and use it as one of my main programming language. But I found that:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Most of the \sphinxcode{\sphinxupquote{Python}} books or tutorials which emphasize on programming will overwhelm the green hand.

\item {} 
\sphinxAtStartPar
While most of the \sphinxcode{\sphinxupquote{Python}} books or tutorials for \sphinxcode{\sphinxupquote{Data Scientist}} or \sphinxcode{\sphinxupquote{Data Analysis}} didn’t cover some essential skills
from the engineer side.

\end{itemize}

\sphinxAtStartPar
So I want to keep some of my valuable tips which are heavily applied in my daily work.


\section{Feedback and suggestions}
\label{\detokenize{preface:feedback-and-suggestions}}
\sphinxAtStartPar
Your comments and suggestions are highly appreciated. I am more than happy to receive
corrections, suggestions or feedbacks through email (Wenqiang Feng: \sphinxhref{mailto:von198@gmail.com}{von198@gmail.com},
Jing Yang: \sphinxhref{mailto:jingyangharvard@gmail.com}{jingyangharvard@gmail.com} ) for improvements.


\chapter{Python Environment}
\label{\detokenize{install:python-environment}}\label{\detokenize{install:install}}\label{\detokenize{install::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This Chapter {\hyperref[\detokenize{install:install}]{\sphinxcrossref{\DUrole{std,std-ref}{Python Environment}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}}
programming experience, you may skip this chapter. For beginners, you
can choose the hard\sphinxhyphen{}core way, installing and setting up python in your
own computer. Alternatively, there is easy route to leverage free online
data science environment that requires zero setup.
\end{sphinxadmonition}


\section{Use python on local computer}
\label{\detokenize{install:use-python-on-local-computer}}
\sphinxAtStartPar
No matter what operator system is, I will strongly recommend you to install
\sphinxcode{\sphinxupquote{Anaconda}} which contains \sphinxcode{\sphinxupquote{Python}}, \sphinxcode{\sphinxupquote{Jupyter}}, \sphinxcode{\sphinxupquote{spyder}}, \sphinxcode{\sphinxupquote{Numpy}},
\sphinxcode{\sphinxupquote{Scipy}}, \sphinxcode{\sphinxupquote{Numba}}, \sphinxcode{\sphinxupquote{pandas}}, \sphinxcode{\sphinxupquote{DASK}}, \sphinxcode{\sphinxupquote{Bokeh}}, \sphinxcode{\sphinxupquote{HoloViews}},
\sphinxcode{\sphinxupquote{Datashader}}, \sphinxcode{\sphinxupquote{matplotlib}}, \sphinxcode{\sphinxupquote{scikit\sphinxhyphen{}learn}}, \sphinxcode{\sphinxupquote{H2O.ai}}, \sphinxcode{\sphinxupquote{TensorFlow}},
\sphinxcode{\sphinxupquote{CONDA}} and more.

\sphinxAtStartPar
Download link: \sphinxurl{https://www.anaconda.com/distribution/}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{anaconda}.png}
\end{figure}


\section{Use python on the cloud (zero setup)}
\label{\detokenize{install:use-python-on-the-cloud-zero-setup}}
\sphinxAtStartPar
Learning a new programming language is not easy.
Luckily, nowadays there are many web\sphinxhyphen{}based data science environment available
that allows one to learn python without downloading or installing python in
local laptop, you can do almost anything online, including free access to GPUs!


\subsection{Google Colab (FREE)}
\label{\detokenize{install:google-colab-free}}
\sphinxAtStartPar
Quote from the official introduction on Google,
Colaboratory, or “Colab” for short, is a free Jupyter notebook environment
that requires no setup, and runs entirely (writing, running, \& sharing code)
within Google Drive.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Zero configuration/setup required on your own machine!

\item {} 
\sphinxAtStartPar
Free access to GPUs and TPUs: code execute on Google’s cloud servers

\item {} 
\sphinxAtStartPar
Search and use built\sphinxhyphen{}in code snippets

\item {} 
\sphinxAtStartPar
Easy sharing (like Google doc)

\end{itemize}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{google_clob}.png}
\end{figure}


\subsection{Kaggle Kernels (FREE)}
\label{\detokenize{install:kaggle-kernels-free}}
\sphinxAtStartPar
Kaggle is best known as a platform for data science competitions.
They also provide a free service called Kernels that can be used independently
of their competitions.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{kaggle_cloud}.png}
\end{figure}

\sphinxAtStartPar
There are a few more choices to run the Jupyter Notebook in the cloud. Feel
free to checkout this article below:
\sphinxurl{https://www.dataschool.io/cloud-services-for-jupyter-notebook/}
This blog is posted in March 2019, content maybe a little out of date.
It does offer great in\sphinxhyphen{}depth comparison of the different platforms.


\subsection{Databricks Community Edition (FREE)}
\label{\detokenize{install:databricks-community-edition-free}}
\sphinxAtStartPar
The Databricks Community Edition is the free version of Databricks cloud\sphinxhyphen{}based
big data platform. The users can access a micro\sphinxhyphen{}cluster as well as a cluster
manager and notebook environment. All users can share their notebooks and
host them free of charge with Databricks.

\sphinxAtStartPar
The Databricks Community Edition also comes with a rich portfolio of
award\sphinxhyphen{}winning training resources that will be expanded over time, making
it ideal for developers, data scientists, data engineers and other IT
professionals to learn Apache Spark. More details can be found at:
\sphinxurl{https://community.cloud.databricks.com}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{community_cloud}.png}
\end{figure}


\chapter{Notebooks}
\label{\detokenize{nb:notebooks}}\label{\detokenize{nb:nb}}\label{\detokenize{nb::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This Chapter {\hyperref[\detokenize{nb:nb}]{\sphinxcrossref{\DUrole{std,std-ref}{Notebooks}}}} is for beginner.  If you have alreay know
\sphinxcode{\sphinxupquote{Nteract}}, \sphinxcode{\sphinxupquote{Zeppelin}} and \sphinxcode{\sphinxupquote{Python}}, you may skip this chapter.
\end{sphinxadmonition}

\sphinxAtStartPar
If you are a Data Scientist, it’s not enough to just know \sphinxcode{\sphinxupquote{Jupyter Notebook}}. You should
also take a look at \sphinxcode{\sphinxupquote{nbviewer}}, \sphinxcode{\sphinxupquote{Nteract}} and \sphinxcode{\sphinxupquote{Zeppelin}} notebooks.


\section{Nteract}
\label{\detokenize{nb:nteract}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{Nteract}} is an amazing \sphinxcode{\sphinxupquote{.ipynb}} reader. You can open and run the \sphinxcode{\sphinxupquote{.ipynb}} by
just double clicking the \sphinxcode{\sphinxupquote{.ipynb}} file.

\sphinxAtStartPar
Download from: \sphinxurl{https://nteract.io/}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{nteract}.png}
\end{figure}


\section{Jupyter Notebook Viewer}
\label{\detokenize{nb:jupyter-notebook-viewer}}
\sphinxAtStartPar
If you are a MAC user, you can also install the Jupyter Notebook Viewer
\textendash{}\sphinxcode{\sphinxupquote{nbviewer\sphinxhyphen{}app}} which is much faster than \sphinxcode{\sphinxupquote{Nteract}}.

\sphinxAtStartPar
Download from: \sphinxurl{https://github.com/tuxu/nbviewer-app}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{nbviewer}.png}
\end{figure}


\section{Apache Zeppelin}
\label{\detokenize{nb:apache-zeppelin}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{Zeppelin}} (Apache Zeppelin) is an open\sphinxhyphen{}source Web\sphinxhyphen{}based notebook that enables
data\sphinxhyphen{}driven, interactive data analytics and collaborative documents with \sphinxcode{\sphinxupquote{Python}},
\sphinxcode{\sphinxupquote{PySpark}}, \sphinxcode{\sphinxupquote{SQL}}, \sphinxcode{\sphinxupquote{Scala}} and more.

\sphinxAtStartPar
Download from: \sphinxurl{https://zeppelin.apache.org/}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{zep}.png}
\end{figure}


\section{Jupyter Notebook}
\label{\detokenize{nb:jupyter-notebook}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{Jupyter Notebook}} (Ipython Notebook) is an open\sphinxhyphen{}source web application that allows you
to create and share documents that contain \sphinxcode{\sphinxupquote{live code}}, \sphinxcode{\sphinxupquote{equations}},
\sphinxcode{\sphinxupquote{visualizations}} and \sphinxcode{\sphinxupquote{narrative text}}. Uses include: data cleaning and
transformation, numerical simulation, statistical modeling, data visualization,
machine learning, and much more.

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{ipynb}.png}
\end{figure}


\chapter{Confidential Information}
\label{\detokenize{confi:confidential-information}}\label{\detokenize{confi:confi}}\label{\detokenize{confi::doc}}
\begin{sphinxadmonition}{note}{Chinese proverb}

\sphinxAtStartPar
Be mindful of guarding against harm from others, and stay away from placing harming upon others.
\end{sphinxadmonition}

\sphinxAtStartPar
If you are a real Data Scientist, you have to share your code with your colleagues or release your code for Code Review or Quality assurance(QA). You will definitely do not want to have your \sphinxcode{\sphinxupquote{User Information}} in the code. So you can save them in login.txt in a safe folder:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
runawayhorse001
PythonTips
\end{sphinxVerbatim}

\sphinxAtStartPar
and use the following code to import your \sphinxcode{\sphinxupquote{User Information}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}User Information}
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{login} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{login.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{pw} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{User information is ready!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Login information is not available!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
You may also want to get the \sphinxcode{\sphinxupquote{User Information}} by using \sphinxcode{\sphinxupquote{os.environ}} in \sphinxcode{\sphinxupquote{Python}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LOGNAME}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{k}{except} \PYG{n+ne}{OSError}\PYG{p}{:}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{USER}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{k}{except} \PYG{n+ne}{OSError}\PYG{p}{:}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{USERNAME}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{err}\PYG{p}{)}
\PYG{k}{except} \PYG{n+ne}{OSError} \PYG{k}{as} \PYG{n}{err}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The user information is not available!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\chapter{Primer Functions}
\label{\detokenize{primer:primer-functions}}\label{\detokenize{primer:primer}}\label{\detokenize{primer::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This Chapter {\hyperref[\detokenize{primer:primer}]{\sphinxcrossref{\DUrole{std,std-ref}{Primer Functions}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}

\sphinxAtStartPar
The following \sphinxcode{\sphinxupquote{functions}} have been heavily used in my daily Data Scientist work.


\section{\sphinxstyleliteralintitle{\sphinxupquote{*}}}
\label{\detokenize{primer:id1}}
\sphinxAtStartPar
Single asterisk as used in function declaration allows variable number of arguments passed from calling environment. Inside the function it behaves as a tuple.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}
\PYG{l+m+mi}{1} \PYG{l+m+mi}{2} \PYG{l+m+mi}{3}
\end{sphinxVerbatim}
\end{quote}


\section{\sphinxstyleliteralintitle{\sphinxupquote{range}}}
\label{\detokenize{primer:range}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{5}\PYG{p}{)}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{)}
\PYG{l+m+mi}{0} \PYG{l+m+mi}{1} \PYG{l+m+mi}{2} \PYG{l+m+mi}{3} \PYG{l+m+mi}{4}
\PYG{l+m+mi}{3} \PYG{l+m+mi}{4} \PYG{l+m+mi}{5} \PYG{l+m+mi}{6} \PYG{l+m+mi}{7}
\end{sphinxVerbatim}
\end{quote}


\section{\sphinxstyleliteralintitle{\sphinxupquote{random}}}
\label{\detokenize{primer:random}}
\sphinxAtStartPar
More details can be found at:
\begin{enumerate}
\sphinxsetlistlabels{\alph}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{random}}: \sphinxurl{https://docs.python.org/3/library/random.html\#random.randint}

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{np.random}}: \sphinxurl{https://docs.scipy.org/doc/numpy/reference/routines.random.html}

\end{enumerate}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{random.random}}}
\label{\detokenize{primer:random-random}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{random}
\PYG{n}{random}\PYG{o}{.}\PYG{n}{random}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} (b \PYGZhy{} a) * random() + a}
\PYG{n}{random}\PYG{o}{.}\PYG{n}{uniform}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mf}{0.33844051243073625}
\PYG{l+m+mf}{7.772024014335885}
\end{sphinxVerbatim}
\end{quote}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{np.random}}}
\label{\detokenize{primer:np-random}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} (b \PYGZhy{} a) * random\PYGZus{}sample() + a}
\PYG{n}{a} \PYG{o}{=} \PYG{l+m+mi}{3}\PYG{p}{;} \PYG{n}{b} \PYG{o}{=} \PYG{l+m+mi}{8}
\PYG{p}{(}\PYG{n}{b}\PYG{o}{\PYGZhy{}}\PYG{n}{a}\PYG{p}{)}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{o}{+}\PYG{n}{a}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mf}{0.11919402208670005}
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.07384755}\PYG{p}{,} \PYG{l+m+mf}{0.9005251} \PYG{p}{,} \PYG{l+m+mf}{0.30030561}\PYG{p}{,} \PYG{l+m+mf}{0.38221819}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{0.76851156}\PYG{p}{,} \PYG{l+m+mf}{0.56973309}\PYG{p}{,} \PYG{l+m+mf}{0.47074505}\PYG{p}{,} \PYG{l+m+mf}{0.7814957} \PYG{p}{]}\PYG{p}{,}
       \PYG{p}{[}\PYG{l+m+mf}{0.5778028} \PYG{p}{,} \PYG{l+m+mf}{0.94653057}\PYG{p}{,} \PYG{l+m+mf}{0.51193493}\PYG{p}{,} \PYG{l+m+mf}{0.48693931}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{4.65799262}\PYG{p}{,} \PYG{l+m+mf}{6.32702018}\PYG{p}{,} \PYG{l+m+mf}{6.55545234}\PYG{p}{,} \PYG{l+m+mf}{5.45877784}\PYG{p}{]}\PYG{p}{,}
       \PYG{p}{[}\PYG{l+m+mf}{7.69941994}\PYG{p}{,} \PYG{l+m+mf}{4.68709357}\PYG{p}{,} \PYG{l+m+mf}{5.49790728}\PYG{p}{,} \PYG{l+m+mf}{4.60913966}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\section{\sphinxstyleliteralintitle{\sphinxupquote{round}}}
\label{\detokenize{primer:round}}
\sphinxAtStartPar
Sometimes, we really do not need the scientific decimals for \sphinxcode{\sphinxupquote{output}} results. So you can use this function to round an array to the given number of decimals.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{p}{[}\PYG{l+m+mf}{0.76}\PYG{p}{,} \PYG{l+m+mf}{0.06}\PYG{p}{,} \PYG{l+m+mf}{0.41}\PYG{p}{,} \PYG{l+m+mf}{0.4} \PYG{p}{]}\PYG{p}{,}
       \PYG{p}{[}\PYG{l+m+mf}{0.07}\PYG{p}{,} \PYG{l+m+mf}{0.51}\PYG{p}{,} \PYG{l+m+mf}{0.84}\PYG{p}{,} \PYG{l+m+mf}{0.76}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\section{TODO..}
\label{\detokenize{primer:todo}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Ouput:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]

\end{sphinxVerbatim}


\chapter{Data Structures}
\label{\detokenize{struct:data-structures}}\label{\detokenize{struct:struct}}\label{\detokenize{struct::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This Chapter {\hyperref[\detokenize{struct:struct}]{\sphinxcrossref{\DUrole{std,std-ref}{Data Structures}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{List}}, \sphinxcode{\sphinxupquote{Set}}, \sphinxcode{\sphinxupquote{Tuple}}, and \sphinxcode{\sphinxupquote{Dictionary}} are most common and basic data structures in Python.
This chapter will cover some basic python commands with these data structure.

\sphinxAtStartPar
These data structures are different in their Mutability and Order, shown in the image below:
\begin{quote}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{data_structures}.png}
\end{figure}
\end{quote}
\begin{itemize}
\item {} 
\sphinxAtStartPar
{\color{red}\bfseries{}*}You can use curly braces to define a set like this: \{1, 2, 3\}. However, if you leave the curly braces empty like this: \{\} Python will instead create an empty dictionary. So to create an empty set, use set().

\item {} 
\sphinxAtStartPar
{\color{red}\bfseries{}**}A dictionary itself is mutable, but each of its individual keys must be immutable. You can find out why here.

\end{itemize}

\sphinxAtStartPar
Reference:
Data Structures\sphinxhyphen{} Lists, Tuples, Dictionaries, and Sets in Python:
\sphinxurl{https://medium.com/@aitarurachel/data-structures-with-lists-tuples-dictionaries-and-sets-in-python-612245a712af}


\section{List}
\label{\detokenize{struct:list}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{list}} is one of data structures which is heavily using in my daily work.


\subsection{Create empty list}
\label{\detokenize{struct:create-empty-list}}
\sphinxAtStartPar
The empty list is used to initialize a list.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} list can be defined with square brackets.}
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{} create empty list with list() constructor}
\PYG{c+c1}{\PYGZsh{} when no parameters are passed}
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{n+nb}{list}\PYG{p}{(}\PYG{p}{)}
\PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{list}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
I applied the empty list to initialize my \sphinxcode{\sphinxupquote{silhouette score}} list when I try to find the
optimal number of the clusters.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{min\PYGZus{}cluster} \PYG{o}{=} \PYG{l+m+mi}{3}
\PYG{n}{max\PYGZus{}cluster} \PYG{o}{=}\PYG{l+m+mi}{8}

\PYG{c+c1}{\PYGZsh{} silhouette\PYGZus{}score}
\PYG{n}{scores} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{min\PYGZus{}cluster}\PYG{p}{,} \PYG{n}{max\PYGZus{}cluster}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{score} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{round}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{random\PYGZus{}sample}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}
    \PYG{n}{scores}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{score}\PYG{p}{)}

\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{scores}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+m+mf}{0.16}\PYG{p}{,} \PYG{l+m+mf}{0.2}\PYG{p}{,} \PYG{l+m+mf}{0.3}\PYG{p}{,} \PYG{l+m+mf}{0.87}\PYG{p}{,} \PYG{l+m+mf}{0.59}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}


\subsection{Unpack list}
\label{\detokenize{struct:unpack-list}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{num} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{o}{*}\PYG{n}{num}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+m+mi}{1} \PYG{l+m+mi}{2} \PYG{l+m+mi}{3} \PYG{l+m+mi}{4} \PYG{l+m+mi}{5} \PYG{l+m+mi}{6} \PYG{l+m+mi}{7} \PYG{l+m+mi}{8} \PYG{l+m+mi}{9} \PYG{l+m+mi}{10}
\end{sphinxVerbatim}
\end{quote}


\subsection{Methods of list objects}
\label{\detokenize{struct:methods-of-list-objects}}
\sphinxAtStartPar
Methods of list objects:


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|*{2}{\X{1}{2}|}}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{append(x)}}
&
\sphinxAtStartPar
Add an item to the end of the list
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{extend(iterable)}}
&
\sphinxAtStartPar
Extend the list by appending all
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{insert(i, x)}}
&
\sphinxAtStartPar
Insert an item at a given position
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{remove(x)}}
&
\sphinxAtStartPar
Remove the first item
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{pop({[}i{]})}}
&
\sphinxAtStartPar
Remove the item at given position
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{clear()}}
&
\sphinxAtStartPar
Remove all items from the list
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{index(x{[},s{[},e{]}{]})}}
&
\sphinxAtStartPar
Return zero\sphinxhyphen{}based index in the list
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{count(x)}}
&
\sphinxAtStartPar
Return the number of times x
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{sort(key,reverse)}}
&
\sphinxAtStartPar
Sort the items of the list
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{reverse()}}
&
\sphinxAtStartPar
Reverse the elements of the list
\\
\hline
\sphinxAtStartPar
list. \sphinxcode{\sphinxupquote{copy()}}
&
\sphinxAtStartPar
Return a shallow copy %
\begin{footnote}[1]\sphinxAtStartFootnote
Shallow Copy vs Deep Copy Reference: \sphinxurl{https://stackoverflow.com/posts/184780/revisions}

\sphinxAtStartPar
Shallow copy:
\begin{quote}
\begin{sphinxfigure-in-table}
\centering

\noindent\sphinxincludegraphics{{shal}.png}
\end{sphinxfigure-in-table}\relax
\end{quote}

\sphinxAtStartPar
The variables A and B refer to different areas of memory, when B is assigned to A the two variables refer to the same area of memory. Later modifications to the contents of either are instantly reflected in the contents of other, as they share contents.

\sphinxAtStartPar
Deep Copy:
\begin{quote}
\begin{sphinxfigure-in-table}
\centering

\noindent\sphinxincludegraphics{{deep}.png}
\end{sphinxfigure-in-table}\relax
\end{quote}

\sphinxAtStartPar
The variables A and B refer to different areas of memory, when B is assigned to A the values in the memory area which A points to are copied into the memory area to which B points. Later modifications to the contents of either remain unique to A or B; the contents are not shared.
%
\end{footnote} of list
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}


\subsection{list.append(x) vs. list.extend(iterable)}
\label{\detokenize{struct:list-append-x-vs-list-extend-iterable}}
\sphinxAtStartPar
The difference of list. \sphinxcode{\sphinxupquote{append(x)}} vs. list. \sphinxcode{\sphinxupquote{extend(iterable)}} is easy to understand
from the example below:

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{list1} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{list2} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{E}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{list1}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{list2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{list1}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{E}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{list1} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{list2} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{E}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{list1}\PYG{o}{.}\PYG{n}{extend}\PYG{p}{(}\PYG{n}{list2}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{list1}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{E}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}


\section{Tuple}
\label{\detokenize{struct:tuple}}
\sphinxAtStartPar
A tuple is an assortment of data, separated by commas, which makes it similar to the Python list, but a tuple is fundamentally different in that a tuple is “immutable.” This means that it cannot be changed, modified, or manipulated.


\subsection{Create Tuple}
\label{\detokenize{struct:create-tuple}}
\sphinxAtStartPar
A tuple is defined in the same way as a list, except that all elements are enclosed in parentheses instead of square brackets.
To create a tuple of one item, it’s required a trailing comma after the item.
Without the comma, Python just assumes you have an extra pair of parentheses instead of creating a tuple.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} initialize an empty tuple by using the tuple function}
\PYG{n}{my\PYGZus{}tuple} \PYG{o}{=} \PYG{n+nb}{tuple}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} tuple with one value must include trailing comma}
\PYG{n}{my\PYGZus{}tuple} \PYG{o}{=} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{)}
\PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{my\PYGZus{}tuple}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} string type if no trailing comma}
\PYG{n}{my\PYGZus{}str} \PYG{o}{=} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{my\PYGZus{}str}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} convert list to tuple}
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{my\PYGZus{}tuple} \PYG{o}{=} \PYG{n+nb}{tuple}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{)}
\PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{my\PYGZus{}tuple}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{tuple}
\PYG{n+nb}{str}
\PYG{n+nb}{tuple}
\end{sphinxVerbatim}
\end{quote}


\subsection{Assigning Multiple Values At Once with Tuple}
\label{\detokenize{struct:assigning-multiple-values-at-once-with-tuple}}
\sphinxAtStartPar
A cool way of using tuple is to assign multiple values at once.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{y}\PYG{p}{,} \PYG{n}{z}\PYG{p}{)} \PYG{o}{=} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{p}{(}\PYG{n}{MONDAY}\PYG{p}{,} \PYG{n}{TUESDAY}\PYG{p}{,} \PYG{n}{WEDNESDAY}\PYG{p}{,} \PYG{n}{THURSDAY}\PYG{p}{,} \PYG{n}{FRIDAY}\PYG{p}{,} \PYG{n}{SATURDAY}\PYG{p}{,} \PYG{n}{SUNDAY}\PYG{p}{)} \PYG{o}{=} \PYG{n+nb}{range}\PYG{p}{(}\PYG{l+m+mi}{7}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\section{Dictionary}
\label{\detokenize{struct:dictionary}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dict}} is one of another data structures which is heavily using in my daily work. I heavily applied the \sphinxcode{\sphinxupquote{dict}} in my \sphinxcode{\sphinxupquote{PyAudit}} package, more details can be found at \sphinxhref{https://github.com/runawayhorse001/PyAudit/blob/master/PyAudit/basics.py\#L251-L340}{PyAudit}.


\subsection{Create \sphinxstyleliteralintitle{\sphinxupquote{dict}} from lists}
\label{\detokenize{struct:create-dict-from-lists}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{col\PYGZus{}names} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{col\PYGZus{}values} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Honda}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{d} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{key}\PYG{p}{:} \PYG{n}{value} \PYG{k}{for} \PYG{n}{key}\PYG{p}{,} \PYG{n}{value} \PYG{o+ow}{in} \PYG{n+nb}{zip}\PYG{p}{(}\PYG{n}{col\PYGZus{}names}\PYG{p}{,} \PYG{n}{col\PYGZus{}values}\PYG{p}{)}\PYG{p}{\PYGZcb{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}

\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{df}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Honda}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
      \PYG{n}{name} \PYG{n}{Age}   \PYG{n}{Sex}    \PYG{n}{Car}
\PYG{l+m+mi}{0}  \PYG{n}{Michael}  \PYG{l+m+mi}{30}  \PYG{n}{Male}  \PYG{n}{Honda}
\PYG{l+m+mi}{1}  \PYG{n}{Michael}  \PYG{l+m+mi}{30}  \PYG{n}{Male}  \PYG{n}{Tesla}
\end{sphinxVerbatim}
\end{quote}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{dict.get()}}}
\label{\detokenize{struct:dict-get}}
\sphinxAtStartPar
When \sphinxcode{\sphinxupquote{get()}} is called, Python checks if the specified key exists in the dict. If it does, then \sphinxcode{\sphinxupquote{get()}} returns the value of that key. If the key does not exist, then \sphinxcode{\sphinxupquote{get()}} returns the value specified in the second argument to \sphinxcode{\sphinxupquote{get()}}. A good application of \sphinxcode{\sphinxupquote{get()}} can be found at {\hyperref[\detokenize{struct:update-keys-dict}]{\sphinxcrossref{\DUrole{std,std-ref}{Update Keys in Dict}}}}.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{data1} \PYG{o}{=} \PYG{n}{d}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{best}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{data2} \PYG{o}{=} \PYG{n}{d}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{names}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{George}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{data1}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} Michael}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{data2}\PYG{p}{)}  \PYG{c+c1}{\PYGZsh{} George}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Michael}
\PYG{n}{George}
\end{sphinxVerbatim}
\end{quote}


\subsection{Looping Techniques}
\label{\detokenize{struct:looping-techniques}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{[}\PYG{p}{(}\PYG{n}{key}\PYG{p}{,} \PYG{n}{val}\PYG{p}{)} \PYG{k}{for} \PYG{n}{key}\PYG{p}{,} \PYG{n}{val} \PYG{o+ow}{in} \PYG{n}{d}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Honda}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}


\subsection{Update Values in Dict}
\label{\detokenize{struct:update-values-in-dict}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Replace values in dict
\begin{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{replace} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla X}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}
\PYG{n}{d}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{n}{replace}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Honda}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla X}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}
\end{quote}
\end{quote}

\item {} 
\sphinxAtStartPar
Add key and values in dict
\begin{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} add key and values in dict}
\PYG{n}{added} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Jim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}
\PYG{n}{d}\PYG{o}{.}\PYG{n}{update}\PYG{p}{(}\PYG{n}{added}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{d}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla X}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla X}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Jim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}
\end{quote}
\end{quote}

\end{enumerate}


\subsection{Update Keys in Dict}
\label{\detokenize{struct:update-keys-in-dict}}\label{\detokenize{struct:update-keys-dict}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} update keys in dict}
\PYG{n}{mapping} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Cars}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kids}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{mapping}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{n}{key}\PYG{p}{,} \PYG{n}{key}\PYG{p}{)}\PYG{p}{:} \PYG{n}{val} \PYG{k}{for} \PYG{n}{key}\PYG{p}{,} \PYG{n}{val} \PYG{o+ow}{in} \PYG{n}{d}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Car}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla X}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kid}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Jim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Michael}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Age}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{30}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sex}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Cars}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla S}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tesla X}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Kids}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Tom}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Jim}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}
\end{quote}


\section{One line if\sphinxhyphen{}else statement}
\label{\detokenize{struct:one-line-if-else-statement}}

\subsection{With filter}
\label{\detokenize{struct:with-filter}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{::syntax:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[} \PYG{n}{RESULT} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{seq} \PYG{k}{if} \PYG{n}{COND} \PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{num} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}

\PYG{p}{[}\PYG{n}{x} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{num} \PYG{k}{if} \PYG{n}{x}\PYG{o}{\PYGZpc{}}\PYG{l+m+mi}{2} \PYG{o}{==}\PYG{l+m+mi}{0}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}


\subsection{Without filter}
\label{\detokenize{struct:without-filter}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{::syntax:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[} \PYG{n}{RESULT1} \PYG{k}{if} \PYG{n}{COND1}  \PYG{k}{else} \PYG{n}{RESULT2} \PYG{k}{if} \PYG{n}{COND2} \PYG{k}{else} \PYG{n}{RESULT3} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{seq}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{num} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{3}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{,}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{9}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{]}

\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Low}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{if} \PYG{l+m+mi}{1}\PYG{o}{\PYGZlt{}}\PYG{o}{=} \PYG{n}{x} \PYG{o}{\PYGZlt{}}\PYG{o}{=}\PYG{l+m+mi}{3} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Median}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{if} \PYG{l+m+mi}{3}\PYG{o}{\PYGZlt{}}\PYG{n}{x}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{8} \PYG{k}{else} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{High}\PYG{l+s+s1}{\PYGZsq{}} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{num}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Output:}}
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Low}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Low}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Low}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Median}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Median}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Median}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Median}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{High}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{High}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
 \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{High}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}
\end{quote}

\sphinxAtStartPar
\sphinxcite{reference:vanderplas2016} \sphinxcite{reference:mckinney2013}


\chapter{Data Read and Ingestion with DataBase}
\label{\detokenize{ingest:data-read-and-ingestion-with-database}}\label{\detokenize{ingest:ingest}}\label{\detokenize{ingest::doc}}

\section{Data Ingestion from Local to DataBase}
\label{\detokenize{ingest:data-ingestion-from-local-to-database}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} User Information}
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{login} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{login.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{pw} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{User information is ready!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Login information is not available!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Database information}
\PYG{n}{host} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{db\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{db\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{table\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{table\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Setup connection}
\PYG{n}{conn} \PYG{o}{=} \PYG{n}{psycopg2}\PYG{o}{.}\PYG{n}{connect}\PYG{p}{(}\PYG{n}{host}\PYG{o}{=}\PYG{n}{host}\PYG{p}{,} \PYG{n}{database}\PYG{o}{=}\PYG{n}{db\PYGZus{}name}\PYG{p}{,} \PYG{n}{user}\PYG{o}{=}\PYG{n}{user}\PYG{p}{,} \PYG{n}{password}\PYG{o}{=}\PYG{n}{pw}\PYG{p}{)}
\PYG{n}{cur} \PYG{o}{=} \PYG{n}{conn}\PYG{o}{.}\PYG{n}{cursor}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Creat table in DataBase}
\PYG{n}{conn}\PYG{o}{.}\PYG{n}{commit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{query} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{    DROP TABLE IF EXISTS }\PYG{l+s+si}{\PYGZob{}table\PYGZus{}name\PYGZcb{}}\PYG{l+s+s2}{;}
\PYG{l+s+s2}{    CREATE TABLE }\PYG{l+s+si}{\PYGZob{}table\PYGZus{}name\PYGZcb{}}
\PYG{l+s+s2}{    (   id character varying(20)}
\PYG{l+s+s2}{      , val1 double precision}
\PYG{l+s+s2}{      , val2 double precision}
\PYG{l+s+s2}{      , val3 double precision}
\PYG{l+s+s2}{      , val4 text}
\PYG{l+s+s2}{    )}
\PYG{l+s+s2}{    DISTRIBUTED BY (id);}
\PYG{l+s+s2}{    GRANT SELECT ON TABLE }\PYG{l+s+si}{\PYGZob{}table\PYGZus{}name\PYGZcb{}}\PYG{l+s+s2}{ TO xxxx;}
\PYG{l+s+s2}{    }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{table\PYGZus{}name}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{)}
\PYG{n}{cur}\PYG{o}{.}\PYG{n}{execute}\PYG{p}{(}\PYG{n}{query}\PYG{p}{)}
\PYG{n}{conn}\PYG{o}{.}\PYG{n}{commit}\PYG{p}{(}\PYG{p}{)}


\PYG{c+c1}{\PYGZsh{} load the data}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{xx.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Write dataframe to memory as csv}
\PYG{n}{csv\PYGZus{}io} \PYG{o}{=} \PYG{n}{io}\PYG{o}{.}\PYG{n}{StringIO}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{to\PYGZus{}csv}\PYG{p}{(}\PYG{n}{csv\PYGZus{}io}\PYG{p}{,} \PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{csv\PYGZus{}io}\PYG{o}{.}\PYG{n}{seek}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Copy the dataframe in memory to GP}
\PYG{n}{conn}\PYG{o}{.}\PYG{n}{commit}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{copy\PYGZus{}sql} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{           COPY }\PYG{l+s+si}{\PYGZob{}table\PYGZus{}name\PYGZcb{}}\PYG{l+s+s2}{ FROM stdin WITH CSV HEADER}
\PYG{l+s+s2}{           DELIMITER as }\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZsq{}}
\PYG{l+s+s2}{           }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{table\PYGZus{}name}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{)}
\PYG{n}{cur}\PYG{o}{.}\PYG{n}{copy\PYGZus{}expert}\PYG{p}{(}\PYG{n}{sql}\PYG{o}{=}\PYG{n}{copy\PYGZus{}sql}\PYG{p}{,} \PYG{n}{file}\PYG{o}{=}\PYG{n}{csv\PYGZus{}io}\PYG{p}{)}
\PYG{n}{conn}\PYG{o}{.}\PYG{n}{commit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
You can also use \sphinxcode{\sphinxupquote{copy\_to}} to copy the dataframe from local memory to GP

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{cur}\PYG{o}{.}\PYG{n}{copy\PYGZus{}to}\PYG{p}{(}\PYG{n}{df}\PYG{p}{,} \PYG{n}{table\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}
\end{sphinxadmonition}


\section{Data Read from DataBase to Local}
\label{\detokenize{ingest:data-read-from-database-to-local}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} User information}
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{login} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{login.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{pw} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{User information is ready!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Login information is not available!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Database information}
\PYG{n}{host} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{db\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{db\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{table\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{table\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{c+c1}{\PYGZsh{} Setup connection}
\PYG{n}{conn} \PYG{o}{=} \PYG{n}{psycopg2}\PYG{o}{.}\PYG{n}{connect}\PYG{p}{(}\PYG{n}{host}\PYG{o}{=}\PYG{n}{host}\PYG{p}{,} \PYG{n}{database}\PYG{o}{=}\PYG{n}{db\PYGZus{}name}\PYG{p}{,} \PYG{n}{user}\PYG{o}{=}\PYG{n}{user}\PYG{p}{,} \PYG{n}{password}\PYG{o}{=}\PYG{n}{pw}\PYG{p}{)}
\PYG{n}{cur} \PYG{o}{=} \PYG{n}{conn}\PYG{o}{.}\PYG{n}{cursor}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Read table}
\PYG{n}{sql} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{      select *}
\PYG{l+s+s2}{      from }\PYG{l+s+si}{\PYGZob{}table\PYGZus{}name\PYGZcb{}}
\PYG{l+s+s2}{      }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{table\PYGZus{}name}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{)}
\PYG{n}{dp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}sql}\PYG{p}{(}\PYG{n}{sql}\PYG{p}{,} \PYG{n}{conn}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Connect to various DataBases (\protect\(pyodbc\protect\))}
\label{\detokenize{ingest:connect-to-various-databases-pyodbc}}
\sphinxAtStartPar
One open source python library \(pyodbc\) makes accessing ODBC databases simple.
For example, it can connect with Google BigQuery, Hive from Ubuntu / Debian, Microsoft Excel, Microsoft SQL Server etc.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} set up DSN (database source name) connection}
\PYG{k+kn}{import} \PYG{n+nn}{pyodbc}
\PYG{n}{conn} \PYG{o}{=} \PYG{n}{pyodbc}\PYG{o}{.}\PYG{n}{connect}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DRIVER=}\PYG{l+s+s1}{\PYGZob{}}\PYG{l+s+s1}{ODBC Driver 17 for SQL Server\PYGZcb{};SERVER=}\PYG{l+s+si}{\PYGZob{}server\PYGZcb{}}\PYG{l+s+s1}{;DATABASE=}\PYG{l+s+si}{\PYGZob{}db\PYGZcb{}}\PYG{l+s+s1}{;UID=}\PYG{l+s+si}{\PYGZob{}user\PYGZcb{}}\PYG{l+s+s1}{;PWD=}\PYG{l+s+si}{\PYGZob{}password\PYGZcb{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{query\PYGZus{}string} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SQL QUERY}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k+kn}{import} \PYG{n+nn}{pandas} \PYG{k}{as} \PYG{n+nn}{pd}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}sql}\PYG{p}{(}\PYG{n}{query\PYGZus{}string}\PYG{p}{,} \PYG{n}{conn}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Hive and Impala Table Ingestion}
\label{\detokenize{ingest:hive-and-impala-table-ingestion}}
\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{ali}.png}
\end{figure}


\chapter{Working with AWS S3}
\label{\detokenize{s3:working-with-aws-s3}}\label{\detokenize{s3::doc}}
\sphinxAtStartPar
Many companies chose to save sensitive data in AWS S3. So you may have to deal
with data with python in Databricks, while python will have many issues to
operate in Databricks(PySpark will not have problems if the environment was
set up correctly in Databricks): such as the \sphinxcode{\sphinxupquote{os.system}} command\sphinxhyphen{}like
function can not use any more; no unified way to upload or download different
type files, etc. Here, I will provide my way to work in AWS S3 with python in
Databricks:


\section{Credentials}
\label{\detokenize{s3:credentials}}
\sphinxAtStartPar
I use Security Token Service (STS) to create the credentials to access AWS S3.
STS enables you to request temporary, limited\sphinxhyphen{}privilege credentials for
Identity and Access Management (IAM) users or for users that you
authenticate (federated users). More details can be found at:
\sphinxurl{https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/sts.html}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{boto3}

\PYG{n}{response} \PYG{o}{=} \PYG{n}{boto3}\PYG{o}{.}\PYG{n}{client}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{sts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYGZbs{}
                \PYG{o}{.}\PYG{n}{assume\PYGZus{}role}\PYG{p}{(}\PYG{n}{RoleArn}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{arn:aws:iam::123456789012:role/demo}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                             \PYG{n}{RoleSessionName}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{your\PYGZus{}role\PYGZus{}session\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{credentials} \PYG{o}{=} \PYG{n}{response}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Credentials}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}


\section{File Upload to S3}
\label{\detokenize{s3:file-upload-to-s3}}
\sphinxAtStartPar
The main idea at here is to save the file in memory or a temporary file, then
use \sphinxcode{\sphinxupquote{put\_object}} to put the file in S3. It’s a little bit tricky to save the
corresponding formatted file in memory, I will list several common types in the
examples.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{s3\_file\_upload}} Function}
\label{\detokenize{s3:s3-file-upload-function}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{s3\PYGZus{}file\PYGZus{}upload}\PYG{p}{(}\PYG{n}{data}\PYG{p}{,} \PYG{n}{path}\PYG{p}{)}\PYG{p}{:}

    \PYG{n}{file\PYGZus{}type} \PYG{o}{=} \PYG{n}{path}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{o}{.}\PYG{n}{lower}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{try}\PYG{p}{:}
        \PYG{n}{content\PYGZus{}type} \PYG{o}{=} \PYG{n}{s3\PYGZus{}content\PYGZus{}type}\PYG{p}{(}\PYG{n}{file\PYGZus{}type}\PYG{p}{)}
    \PYG{k}{except}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Do not support the current input type!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{n}{s3\PYGZus{}path} \PYG{o}{=} \PYG{n}{path}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{s3://}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{s3a://}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{bucket} \PYG{o}{=} \PYG{n}{s3\PYGZus{}path}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{key} \PYG{o}{=} \PYG{n}{s3\PYGZus{}path}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}

    \PYG{k}{try}\PYG{p}{:}
        \PYG{n}{s3\PYGZus{}resource}\PYG{o}{.}\PYG{n}{Bucket}\PYG{p}{(}\PYG{n}{bucket}\PYG{p}{)}\PYGZbs{}
                   \PYG{o}{.}\PYG{n}{put\PYGZus{}object}\PYG{p}{(}\PYG{n}{Key}\PYG{o}{=}\PYG{n}{key}\PYG{p}{,}
                               \PYG{n}{Body}\PYG{o}{=}\PYG{n}{data}\PYG{p}{,}
                               \PYG{n}{ContentType}\PYG{o}{=}\PYG{n}{content\PYGZus{}type}\PYG{p}{,}
                               \PYG{n}{ACL}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{public\PYGZhy{}read}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+sa}{f}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+si}{\PYGZob{}}\PYG{n}{key}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{l+s+si}{\PYGZcb{}}\PYG{l+s+s2}{ has been successfully saved in s3!}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{k}{except} \PYG{n+ne}{Exception} \PYG{k}{as} \PYG{n}{err}\PYG{p}{:}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{err}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{s3\_content\_type}} Function}
\label{\detokenize{s3:s3-content-type-function}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{s3\PYGZus{}content\PYGZus{}type}\PYG{p}{(}\PYG{n}{file\PYGZus{}type}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{mapping} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{n}{png}\PYG{p}{:}\PYG{n}{image}\PYG{o}{/}\PYG{n}{png}\PYG{p}{\PYGZcb{}}

    \PYG{k}{return} \PYG{n}{mapping}\PYG{p}{[}\PYG{n}{file\PYGZus{}type}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
The full mapping list can be found as follows:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
3dm:x\PYGZhy{}world/x\PYGZhy{}3dmf
3dmf:x\PYGZhy{}world/x\PYGZhy{}3dmf
a:application/octet\PYGZhy{}stream
aab:application/x\PYGZhy{}authorware\PYGZhy{}bin
aam:application/x\PYGZhy{}authorware\PYGZhy{}map
aas:application/x\PYGZhy{}authorware\PYGZhy{}seg
abc:text/vnd.abc
acgi:text/html
afl:video/animaflex
ai:application/postscript
aif:audio/aiff
\PYGZsh{}aif:audio/x\PYGZhy{}aiff
aifc:audio/aiff
\PYGZsh{}aifc:audio/x\PYGZhy{}aiff
aiff:audio/aiff
\PYGZsh{}aiff:audio/x\PYGZhy{}aiff
aim:application/x\PYGZhy{}aim
aip:text/x\PYGZhy{}audiosoft\PYGZhy{}intra
ani:application/x\PYGZhy{}navi\PYGZhy{}animation
aos:application/x\PYGZhy{}nokia\PYGZhy{}9000\PYGZhy{}communicator\PYGZhy{}add\PYGZhy{}on\PYGZhy{}software
aps:application/mime
arc:application/octet\PYGZhy{}stream
arj:application/arj
art:image/x\PYGZhy{}jg
asf:video/x\PYGZhy{}ms\PYGZhy{}asf
asm:text/x\PYGZhy{}asm
asp:text/asp
asx:application/x\PYGZhy{}mplayer2
\PYGZsh{}asx:video/x\PYGZhy{}ms\PYGZhy{}asf
\PYGZsh{}asx:video/x\PYGZhy{}ms\PYGZhy{}asf\PYGZhy{}plugin
au:audio/basic
\PYGZsh{}au:audio/x\PYGZhy{}au
\PYGZsh{}avi:video/avi
\PYGZsh{}avi:video/msvideo
avi:video/x\PYGZhy{}msvideo
avs:video/avs\PYGZhy{}video
bcpio:application/x\PYGZhy{}bcpio
\PYGZsh{}bin:application/mac\PYGZhy{}binary
\PYGZsh{}bin:application/macbinary
\PYGZsh{}bin:application/octet\PYGZhy{}stream
bin:application/x\PYGZhy{}binary
\PYGZsh{}bin:application/x\PYGZhy{}macbinary
bm:image/bmp
bmp:image/bmp
boo:application/book
book:application/book
boz:application/x\PYGZhy{}bzip2
bsh:application/x\PYGZhy{}bsh
bz:application/x\PYGZhy{}bzip
bz2:application/x\PYGZhy{}bzip2
c:text/plain
c++:text/plain
cat:application/vnd.ms\PYGZhy{}pki.seccat
cc:text/plain
ccad:application/clariscad
cco:application/x\PYGZhy{}cocoa
cdf:application/cdf
cer:application/pkix\PYGZhy{}cert
cha:application/x\PYGZhy{}chat
chat:application/x\PYGZhy{}chat
class:application/java
com:application/octet\PYGZhy{}stream
conf:text/plain
cpio:application/x\PYGZhy{}cpio
cpp:text/x\PYGZhy{}c
cpt:application/mac\PYGZhy{}compactpro
crl:application/pkcs\PYGZhy{}crl
crt:application/pkix\PYGZhy{}cert
csh:application/x\PYGZhy{}csh
css:text/css
cxx:text/plain
dcr:application/x\PYGZhy{}director
deepv:application/x\PYGZhy{}deepv
def:text/plain
der:application/x\PYGZhy{}x509\PYGZhy{}ca\PYGZhy{}cert
dif:video/x\PYGZhy{}dv
dir:application/x\PYGZhy{}director
dl:video/dl
doc:application/msword
dot:application/msword
dp:application/commonground
drw:application/drafting
dump:application/octet\PYGZhy{}stream
dv:video/x\PYGZhy{}dv
dvi:application/x\PYGZhy{}dvi
dwf:model/vnd.dwf
dwg:application/acad
dxf:application/dxf
dxr:application/x\PYGZhy{}director
el:text/x\PYGZhy{}script.elisp
elc:application/x\PYGZhy{}bytecode.elisp
env:application/x\PYGZhy{}envoy
eps:application/postscript
es:application/x\PYGZhy{}esrehber
etx:text/x\PYGZhy{}setext
evy:application/envoy
exe:application/octet\PYGZhy{}stream
f:text/plain
f77:text/x\PYGZhy{}fortran
f90:text/plain
fdf:application/vnd.fdf
fif:application/fractals
fli:video/fli
flo:image/florian
flx:text/vnd.fmi.flexstor
fmf:video/x\PYGZhy{}atomic3d\PYGZhy{}feature
for:text/plain
fpx:image/vnd.fpx
frl:application/freeloader
funk:audio/make
g:text/plain
g3:image/g3fax
gif:image/gif
gl:video/gl
gsd:audio/x\PYGZhy{}gsm
gsm:audio/x\PYGZhy{}gsm
gsp:application/x\PYGZhy{}gsp
gss:application/x\PYGZhy{}gss
gtar:application/x\PYGZhy{}gtar
gz:application/x\PYGZhy{}gzip
gzip:application/x\PYGZhy{}gzip
h:text/plain
hdf:application/x\PYGZhy{}hdf
help:application/x\PYGZhy{}helpfile
hgl:application/vnd.hp\PYGZhy{}hpgl
hh:text/plain
hlp:application/hlp
hpg:application/vnd.hp\PYGZhy{}hpgl
hpgl:application/vnd.hp\PYGZhy{}hpgl
hqx:application/binhex
hta:application/hta
htc:text/x\PYGZhy{}component
htm:text/html
html:text/html
htmls:text/html
htt:text/webviewhtml
htx:text/html
ice:x\PYGZhy{}conference/x\PYGZhy{}cooltalk
ico:image/x\PYGZhy{}icon
idc:text/plain
ief:image/ief
iefs:image/ief
iges:application/iges
igs:application/iges
ima:application/x\PYGZhy{}ima
imap:application/x\PYGZhy{}httpd\PYGZhy{}imap
inf:application/inf
ins:application/x\PYGZhy{}internett\PYGZhy{}signup
ip:application/x\PYGZhy{}ip2
isu:video/x\PYGZhy{}isvideo
it:audio/it
iv:application/x\PYGZhy{}inventor
ivr:i\PYGZhy{}world/i\PYGZhy{}vrml
ivy:application/x\PYGZhy{}livescreen
jam:audio/x\PYGZhy{}jam
java:text/plain
jcm:application/x\PYGZhy{}java\PYGZhy{}commerce
jfif:image/jpeg
jpeg:image/jpeg
jpg:image/jpeg
jps:image/x\PYGZhy{}jps
js:application/x\PYGZhy{}javascript
jut:image/jutvision
kar:audio/midi
ksh:text/x\PYGZhy{}script.ksh
la:audio/nspaudio
lam:audio/x\PYGZhy{}liveaudio
latex:application/x\PYGZhy{}latex
lha:application/octet\PYGZhy{}stream
lhx:application/octet\PYGZhy{}stream
list:text/plain
lma:audio/nspaudio
log:text/plain
lst:text/plain
lsx:text/x\PYGZhy{}la\PYGZhy{}asf
ltx:application/x\PYGZhy{}latex
lzh:application/octet\PYGZhy{}stream
lzx:application/octet\PYGZhy{}stream
m:text/plain
m1v:video/mpeg
m2a:audio/mpeg
m2v:video/mpeg
m3u:audio/x\PYGZhy{}mpequrl
m4v:video/x\PYGZhy{}m4v
man:application/x\PYGZhy{}troff\PYGZhy{}man
mht:message/rfc822
mhtml:message/rfc822
midi:audio/midi
mif:application/x\PYGZhy{}frame
mjf:audio/x\PYGZhy{}vnd.audioexplosion.mjuicemediafile
mjpg:video/x\PYGZhy{}motion\PYGZhy{}jpeg
mod:audio/mod
mov:video/quicktime
movie:video/x\PYGZhy{}sgi\PYGZhy{}movie
mp2:audio/mpeg
mp3:audio/mpeg
\PYGZsh{}mpa:audio/mpeg
mpa:video/mpeg
mpc:application/x\PYGZhy{}project
mpeg:video/mpeg
mpg:video/mpeg
mpga:audio/mpeg
ogg:video/ogg
ogv:video/ogg
p:text/x\PYGZhy{}pascal
p10:application/pkcs10
\PYGZsh{}p12:application/pkcs\PYGZhy{}12
p12:application/x\PYGZhy{}pkcs12
p7a:application/x\PYGZhy{}pkcs7\PYGZhy{}signature
p7c:application/x\PYGZhy{}pkcs7\PYGZhy{}mime
p7m:application/pkcs7\PYGZhy{}mime
p7r:application/x\PYGZhy{}pkcs7\PYGZhy{}certreqresp
p7s:application/pkcs7\PYGZhy{}signature
part:application/pro\PYGZus{}eng
pas:text/pascal
pbm:image/x\PYGZhy{}portable\PYGZhy{}bitmap
pcl:application/x\PYGZhy{}pcl
pct:image/x\PYGZhy{}pict
pcx:image/x\PYGZhy{}pcx
pdb:chemical/x\PYGZhy{}pdb
pdf:application/pdf
pfunk:audio/make
pgm:image/x\PYGZhy{}portable\PYGZhy{}graymap
pic:image/pict
pict:image/pict
pkg:application/x\PYGZhy{}newton\PYGZhy{}compatible\PYGZhy{}pkg
pko:application/vnd.ms\PYGZhy{}pki.pko
pl:text/plain
plx:application/x\PYGZhy{}pixclscript
pm:image/x\PYGZhy{}xpixmap
pm4:application/x\PYGZhy{}pagemaker
pm5:application/x\PYGZhy{}pagemaker
png:image/png
pnm:image/x\PYGZhy{}portable\PYGZhy{}anymap
pot:application/mspowerpoint
ppa:application/vnd.ms\PYGZhy{}powerpoint
ppm:image/x\PYGZhy{}portable\PYGZhy{}pixmap
pps:application/mspowerpoint
ppt:application/mspowerpoint
\PYGZsh{}ppt:application/powerpoint
\PYGZsh{}ppt:application/vnd.ms\PYGZhy{}powerpoint
\PYGZsh{}ppt:application/x\PYGZhy{}mspowerpoint
ppz:application/mspowerpoint
pre:application/x\PYGZhy{}freelance
prt:application/pro\PYGZus{}eng
ps:application/postscript
psd:application/octet\PYGZhy{}stream
pvu:paleovu/x\PYGZhy{}pv
pwz:application/vnd.ms\PYGZhy{}powerpoint
py:text/x\PYGZhy{}script.phyton
pyc:applicaiton/x\PYGZhy{}bytecode.python
qcp:audio/vnd.qcelp
qd3:x\PYGZhy{}world/x\PYGZhy{}3dmf
\PYGZsh{}qd3d:x\PYGZhy{}world/x\PYGZhy{}3dmf
qif:image/x\PYGZhy{}quicktime
qt:video/quicktime
qtc:video/x\PYGZhy{}qtc
qti:image/x\PYGZhy{}quicktime
qtif:image/x\PYGZhy{}quicktime
ra:audio/x\PYGZhy{}pn\PYGZhy{}realaudio
\PYGZsh{}ra:audio/x\PYGZhy{}pn\PYGZhy{}realaudio\PYGZhy{}plugin
\PYGZsh{}ra:audio/x\PYGZhy{}realaudio
ram:audio/x\PYGZhy{}pn\PYGZhy{}realaudio
ras:application/x\PYGZhy{}cmu\PYGZhy{}raster
\PYGZsh{}ras:image/cmu\PYGZhy{}raster
\PYGZsh{}ras:image/x\PYGZhy{}cmu\PYGZhy{}raster
\PYGZsh{}rast:image/cmu\PYGZhy{}raster
\PYGZsh{}rexx:text/x\PYGZhy{}script.rexx
\PYGZsh{}rf:image/vnd.rn\PYGZhy{}realflash
rgb:image/x\PYGZhy{}rgb
rm:application/vnd.rn\PYGZhy{}realmedia
\PYGZsh{}rm:audio/x\PYGZhy{}pn\PYGZhy{}realaudio
rmi:audio/mid
rmm:audio/x\PYGZhy{}pn\PYGZhy{}realaudio
rmp:audio/x\PYGZhy{}pn\PYGZhy{}realaudio
\PYGZsh{}rmp:audio/x\PYGZhy{}pn\PYGZhy{}realaudio\PYGZhy{}plugin
rng:application/ringing\PYGZhy{}tones
\PYGZsh{}rng:application/vnd.nokia.ringing\PYGZhy{}tone
rnx:application/vnd.rn\PYGZhy{}realplayer
roff:application/x\PYGZhy{}troff
rp:image/vnd.rn\PYGZhy{}realpix
rpm:audio/x\PYGZhy{}pn\PYGZhy{}realaudio\PYGZhy{}plugin
rt:text/richtext
\PYGZsh{}rt:text/vnd.rn\PYGZhy{}realtext
rtf:application/rtf
\PYGZsh{}rtf:application/x\PYGZhy{}rtf
\PYGZsh{}rtf:text/richtext
\PYGZsh{}rtx:application/rtf
\PYGZsh{}rtx:text/richtext
rv:video/vnd.rn\PYGZhy{}realvideo
s:text/x\PYGZhy{}asm
s3m:audio/s3m
\PYGZsh{}saveme:application/octet\PYGZhy{}stream
sbk:application/x\PYGZhy{}tbook
scm:application/x\PYGZhy{}lotusscreencam
\PYGZsh{}scm:text/x\PYGZhy{}script.guile
\PYGZsh{}scm:text/x\PYGZhy{}script.scheme
\PYGZsh{}scm:video/x\PYGZhy{}scm
sdml:text/plain
sdp:application/sdp
\PYGZsh{}sdp:application/x\PYGZhy{}sdp
sdr:application/sounder
sea:application/sea
\PYGZsh{}sea:application/x\PYGZhy{}sea
set:application/set
sgm:text/sgml
\PYGZsh{}sgm:text/x\PYGZhy{}sgml
sgml:text/sgml
\PYGZsh{}sgml:text/x\PYGZhy{}sgml
sh:application/x\PYGZhy{}bsh
\PYGZsh{}sh:application/x\PYGZhy{}sh
\PYGZsh{}sh:application/x\PYGZhy{}shar
\PYGZsh{}sh:text/x\PYGZhy{}script.sh
shar:application/x\PYGZhy{}bsh
\PYGZsh{}shar:application/x\PYGZhy{}shar
shtml:text/html
\PYGZsh{}shtml:text/x\PYGZhy{}server\PYGZhy{}parsed\PYGZhy{}html
sid:audio/x\PYGZhy{}psid
\PYGZsh{}sit:application/x\PYGZhy{}sit
sit:application/x\PYGZhy{}stuffit
skd:application/x\PYGZhy{}koan
skm:application/x\PYGZhy{}koan
skp:application/x\PYGZhy{}koan
skt:application/x\PYGZhy{}koan
sl:application/x\PYGZhy{}seelogo
smi:application/smil
smil:application/smil
\PYGZsh{}snd:audio/basic
snd:audio/x\PYGZhy{}adpcm
sol:application/solids
\PYGZsh{}spc:application/x\PYGZhy{}pkcs7\PYGZhy{}certificates
spc:text/x\PYGZhy{}speech
spl:application/futuresplash
spr:application/x\PYGZhy{}sprite
sprite:application/x\PYGZhy{}sprite
src:application/x\PYGZhy{}wais\PYGZhy{}source
ssi:text/x\PYGZhy{}server\PYGZhy{}parsed\PYGZhy{}html
ssm:application/streamingmedia
sst:application/vnd.ms\PYGZhy{}pki.certstore
step:application/step
stl:application/sla
\PYGZsh{}stl:application/vnd.ms\PYGZhy{}pki.stl
\PYGZsh{}stl:application/x\PYGZhy{}navistyle
stp:application/step
sv4cpio:application/x\PYGZhy{}sv4cpio
sv4crc:application/x\PYGZhy{}sv4crc
svf:image/vnd.dwg
\PYGZsh{}svf:image/x\PYGZhy{}dwg
svr:application/x\PYGZhy{}world
\PYGZsh{}svr:x\PYGZhy{}world/x\PYGZhy{}svr
swf:application/x\PYGZhy{}shockwave\PYGZhy{}flash
t:application/x\PYGZhy{}troff
talk:text/x\PYGZhy{}speech
tar:application/x\PYGZhy{}tar
tbk:application/toolbook
\PYGZsh{}tbk:application/x\PYGZhy{}tbook
tcl:application/x\PYGZhy{}tcl
\PYGZsh{}tcl:text/x\PYGZhy{}script.tcl
tcsh:text/x\PYGZhy{}script.tcsh
tex:application/x\PYGZhy{}tex
texi:application/x\PYGZhy{}texinfo
texinfo:application/x\PYGZhy{}texinfo
\PYGZsh{}text:application/plain
text:text/plain
\PYGZsh{}tgz:application/gnutar
tgz:application/x\PYGZhy{}compressed
tif:image/tiff
\PYGZsh{}tif:image/x\PYGZhy{}tiff
tiff:image/tiff
\PYGZsh{}tiff:image/x\PYGZhy{}tiff
tr:application/x\PYGZhy{}troff
tsi:audio/tsp\PYGZhy{}audio
tsp:application/dsptype
\PYGZsh{}tsp:audio/tsplayer
tsv:text/tab\PYGZhy{}separated\PYGZhy{}values
turbot:image/florian
txt:text/plain
uil:text/x\PYGZhy{}uil
uni:text/uri\PYGZhy{}list
unis:text/uri\PYGZhy{}list
unv:application/i\PYGZhy{}deas
uri:text/uri\PYGZhy{}list
uris:text/uri\PYGZhy{}list
ustar:application/x\PYGZhy{}ustar
\PYGZsh{}ustar:multipart/x\PYGZhy{}ustar
uu:application/octet\PYGZhy{}stream
\PYGZsh{}uu:text/x\PYGZhy{}uuencode
uue:text/x\PYGZhy{}uuencode
vcd:application/x\PYGZhy{}cdlink
vcs:text/x\PYGZhy{}vcalendar
vda:application/vda
vdo:video/vdo
vew:application/groupwise
viv:video/vivo
\PYGZsh{}viv:video/vnd.vivo
vivo:video/vivo
\PYGZsh{}vivo:video/vnd.vivo
vmd:application/vocaltec\PYGZhy{}media\PYGZhy{}desc
vmf:application/vocaltec\PYGZhy{}media\PYGZhy{}file
voc:audio/voc
\PYGZsh{}voc:audio/x\PYGZhy{}voc
vos:video/vosaic
vox:audio/voxware
vqe:audio/x\PYGZhy{}twinvq\PYGZhy{}plugin
vqf:audio/x\PYGZhy{}twinvq
vql:audio/x\PYGZhy{}twinvq\PYGZhy{}plugin
vrml:application/x\PYGZhy{}vrml
\PYGZsh{}vrml:model/vrml
\PYGZsh{}vrml:x\PYGZhy{}world/x\PYGZhy{}vrml
vrt:x\PYGZhy{}world/x\PYGZhy{}vrt
vsd:application/x\PYGZhy{}visio
vst:application/x\PYGZhy{}visio
vsw:application/x\PYGZhy{}visio
w60:application/wordperfect6.0
w61:application/wordperfect6.1
w6w:application/msword
wav:audio/wav
\PYGZsh{}wav:audio/x\PYGZhy{}wav
wb1:application/x\PYGZhy{}qpro
wbmp:image/vnd.wap.wbmp
web:application/vnd.xara
wiz:application/msword
wk1:application/x\PYGZhy{}123
wmf:windows/metafile
wml:text/vnd.wap.wml
wmlc:application/vnd.wap.wmlc
wmls:text/vnd.wap.wmlscript
wmlsc:application/vnd.wap.wmlscriptc
word:application/msword
wp:application/wordperfect
wp5:application/wordperfect
\PYGZsh{}wp5:application/wordperfect6.0
wp6:application/wordperfect
wpd:application/wordperfect
\PYGZsh{}wpd:application/x\PYGZhy{}wpwin
wq1:application/x\PYGZhy{}lotus
wri:application/mswrite
\PYGZsh{}wri:application/x\PYGZhy{}wri
\PYGZsh{}wrl:application/x\PYGZhy{}world
wrl:model/vrml
\PYGZsh{}wrl:x\PYGZhy{}world/x\PYGZhy{}vrml
\PYGZsh{}wrz:model/vrml
\PYGZsh{}wrz:x\PYGZhy{}world/x\PYGZhy{}vrml
\PYGZsh{}wsc:text/scriplet
wsrc:application/x\PYGZhy{}wais\PYGZhy{}source
wtk:application/x\PYGZhy{}wintalk
\PYGZsh{}xbm:image/x\PYGZhy{}xbitmap
\PYGZsh{}xbm:image/x\PYGZhy{}xbm
xbm:image/xbm
xdr:video/x\PYGZhy{}amt\PYGZhy{}demorun
xgz:xgl/drawing
xif:image/vnd.xiff
xl:application/excel
xla:application/excel
\PYGZsh{}xla:application/x\PYGZhy{}excel
\PYGZsh{}xla:application/x\PYGZhy{}msexcel
\PYGZsh{}xlb:application/excel
\PYGZsh{}xlb:application/vnd.ms\PYGZhy{}excel
xlb:application/x\PYGZhy{}excel
\PYGZsh{}xlc:application/excel
\PYGZsh{}xlc:application/vnd.ms\PYGZhy{}excel
\PYGZsh{}xlc:application/x\PYGZhy{}excel
xld:application/excel
\PYGZsh{}xld:application/x\PYGZhy{}excel
\PYGZsh{}xlk:application/excel
xlk:application/x\PYGZhy{}excel
\PYGZsh{}xll:application/excel
\PYGZsh{}xll:application/vnd.ms\PYGZhy{}excel
xll:application/x\PYGZhy{}excel
\PYGZsh{}xlm:application/excel
\PYGZsh{}xlm:application/vnd.ms\PYGZhy{}excel
xlm:application/x\PYGZhy{}excel
\PYGZsh{}xls:application/excel
\PYGZsh{}xls:application/vnd.ms\PYGZhy{}excel
\PYGZsh{}xls:application/x\PYGZhy{}excel
xls:application/x\PYGZhy{}msexcel
\PYGZsh{}xlt:application/excel
xlt:application/x\PYGZhy{}excel
\PYGZsh{}xlv:application/excel
xlv:application/x\PYGZhy{}excel
\PYGZsh{}xlw:application/excel
\PYGZsh{}xlw:application/vnd.ms\PYGZhy{}excel
\PYGZsh{}xlw:application/x\PYGZhy{}excel
xlw:application/x\PYGZhy{}msexcel
xm:audio/xm
\PYGZsh{}xml:application/xml
xml:text/xml
xmz:xgl/movie
xpix:application/x\PYGZhy{}vnd.ls\PYGZhy{}xpix
\PYGZsh{}xpm:image/x\PYGZhy{}xpixmap
xpm:image/xpm
x\PYGZhy{}png:image/png
xsr:video/x\PYGZhy{}amt\PYGZhy{}showrun
\PYGZsh{}xwd:image/x\PYGZhy{}xwd
xwd:image/x\PYGZhy{}xwindowdump
xyz:chemical/x\PYGZhy{}pdb
\PYGZsh{}z:application/x\PYGZhy{}compress
z:application/x\PYGZhy{}compressed
\PYGZsh{}zip:application/x\PYGZhy{}compressed
\PYGZsh{}zip:application/x\PYGZhy{}zip\PYGZhy{}compressed
zip:application/zip
\PYGZsh{}zip:multipart/x\PYGZhy{}zip
zoo:application/octet\PYGZhy{}stream
zsh:text/x\PYGZhy{}script.zsh
\end{sphinxVerbatim}


\subsection{Examples}
\label{\detokenize{s3:examples}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{.csv}} file

\end{enumerate}

\sphinxAtStartPar
save \sphinxcode{\sphinxupquote{csv}} file in memory:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{csv\PYGZus{}io} \PYG{o}{=} \PYG{n}{io}\PYG{o}{.}\PYG{n}{StringIO}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{df}\PYG{o}{.}\PYG{n}{to\PYGZus{}csv}\PYG{p}{(}\PYG{n}{csv\PYGZus{}io}\PYG{p}{,} \PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{n}{csv\PYGZus{}io}\PYG{o}{.}\PYG{n}{seek}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} the csv data need encode}
\PYG{n}{csv\PYGZus{}data} \PYG{o}{=} \PYG{n}{io}\PYG{o}{.}\PYG{n}{BytesIO}\PYG{p}{(}\PYG{n}{csv\PYGZus{}io}\PYG{o}{.}\PYG{n}{getvalue}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{encode}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}\begin{quote}

\sphinxAtStartPar
The alternative way by using \sphinxcode{\sphinxupquote{tempfile}}:
\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{tempfile}\PYG{o}{.}\PYG{n}{TemporaryFile}\PYG{p}{(}\PYG{n}{mode}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{r+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{fp}\PYG{p}{:}
    \PYG{n}{df}\PYG{o}{.}\PYG{n}{to\PYGZus{}csv}\PYG{p}{(}\PYG{n}{fp}\PYG{p}{,} \PYG{n}{sep}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
    \PYG{n}{fp}\PYG{o}{.}\PYG{n}{seek}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{s3\PYGZus{}file\PYGZus{}upload}\PYG{p}{(}\PYG{n}{csv\PYGZus{}data}\PYG{p}{,} \PYG{n}{file\PYGZus{}path}\PYG{p}{)}
\end{sphinxVerbatim}
\end{sphinxadmonition}

\sphinxAtStartPar
Upload file

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{file\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}bucket/\PYGZti{}\PYGZti{}/\PYGZti{}\PYGZti{}/test/test.csv}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{s3\PYGZus{}file\PYGZus{}upload}\PYG{p}{(}\PYG{n}{csv\PYGZus{}data}\PYG{p}{,} \PYG{n}{file\PYGZus{}path}\PYG{p}{)}
\PYG{g+go}{test.csv has been successfully saved in S3!}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{.json}} file

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{json\PYGZus{}object} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{l+s+s2}{ your json content}\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{json\PYGZus{}data} \PYG{o}{=} \PYG{n}{json}\PYG{o}{.}\PYG{n}{dumps}\PYG{p}{(}\PYG{n}{json\PYGZus{}object}\PYG{p}{)}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{file\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}bucket/\PYGZti{}\PYGZti{}/\PYGZti{}\PYGZti{}/test/test.json}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{s3\PYGZus{}file\PYGZus{}upload}\PYG{p}{(}\PYG{n}{json\PYGZus{}data}\PYG{p}{,} \PYG{n}{file\PYGZus{}path}\PYG{p}{)}
\PYG{g+go}{test.json has been successfully saved in S3!}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}\begin{quote}

\sphinxAtStartPar
The alternative way by using \sphinxcode{\sphinxupquote{tempfile}}:
\end{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{with} \PYG{n}{tempfile}\PYG{o}{.}\PYG{n}{TemporaryFile}\PYG{p}{(}\PYG{p}{)} \PYG{k}{as} \PYG{n}{fp}\PYG{p}{:}
    \PYG{n}{joblib}\PYG{o}{.}\PYG{n}{dump}\PYG{p}{(}\PYG{n}{json\PYGZus{}data}\PYG{p}{,} \PYG{n}{fp}\PYG{p}{)}
    \PYG{n}{fp}\PYG{o}{.}\PYG{n}{seek}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{s3\PYGZus{}file\PYGZus{}upload}\PYG{p}{(}\PYG{n}{json\PYGZus{}data}\PYG{p}{,} \PYG{n}{file\PYGZus{}path}\PYG{p}{)}
\end{sphinxVerbatim}
\end{sphinxadmonition}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{.png}}, \sphinxcode{\sphinxupquote{.jpeg}} or \sphinxcode{\sphinxupquote{.pdf}}

\end{enumerate}

\sphinxAtStartPar
Save the image in memory:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{flights} \PYG{o}{=} \PYG{n}{sns}\PYG{o}{.}\PYG{n}{load\PYGZus{}dataset}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{flights}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{may\PYGZus{}flights} \PYG{o}{=} \PYG{n}{flights}\PYG{o}{.}\PYG{n}{query}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{month == }\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{May}\PYG{l+s+s2}{\PYGZsq{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{fig} \PYG{o}{=} \PYG{n}{plt}\PYG{o}{.}\PYG{n}{figure}\PYG{p}{(}\PYG{n}{figsize}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{20}\PYG{p}{,}\PYG{l+m+mi}{8}\PYG{p}{)}\PYG{p}{)}
\PYG{n}{sns}\PYG{o}{.}\PYG{n}{lineplot}\PYG{p}{(}\PYG{n}{data}\PYG{o}{=}\PYG{n}{may\PYGZus{}flights}\PYG{p}{,} \PYG{n}{x}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{year}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{y}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{passengers}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n}{img\PYGZus{}data} \PYG{o}{=} \PYG{n}{io}\PYG{o}{.}\PYG{n}{BytesIO}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{plt}\PYG{o}{.}\PYG{n}{savefig}\PYG{p}{(}\PYG{n}{img\PYGZus{}data}\PYG{p}{,} \PYG{n+nb}{format}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{png}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{img\PYGZus{}data}\PYG{o}{.}\PYG{n}{seek}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Save the in\sphinxhyphen{}memory image data in S3:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}bucket/my\PYGZus{}key}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{s3\PYGZus{}file\PYGZus{}save}\PYG{p}{(}\PYG{n}{img\PYGZus{}data}\PYG{p}{,} \PYG{n}{path}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
The above method also works for \sphinxcode{\sphinxupquote{.jpeg}} and \sphinxcode{\sphinxupquote{.pdf}} format.
\end{sphinxadmonition}


\section{File Download from S3}
\label{\detokenize{s3:file-download-from-s3}}
\sphinxAtStartPar
The main idea is using the s3 resource function to download the file and save
it at \sphinxcode{\sphinxupquote{/temp}} as a temporary file, the use the corresponding formatted
functions to read it.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{s3\_file\_download}} Function}
\label{\detokenize{s3:s3-file-download-function}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{def} \PYG{n+nf}{s3\PYGZus{}file\PYGZus{}download}\PYG{p}{(}\PYG{n}{path}\PYG{p}{)}\PYG{p}{:}

    \PYG{c+c1}{\PYGZsh{} extract bucket and key from the given path}
    \PYG{n}{s3\PYGZus{}path} \PYG{o}{=} \PYG{n}{path}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{s3://}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{s3a://}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{bucket} \PYG{o}{=} \PYG{n}{s3\PYGZus{}path}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{key} \PYG{o}{=} \PYG{n}{s3\PYGZus{}path}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}

    \PYG{c+c1}{\PYGZsh{} download file and save it as a temp file}
    \PYG{n}{file\PYGZus{}name} \PYG{o}{=} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/tmp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{path}\PYG{o}{.}\PYG{n}{split}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{s3\PYGZus{}resource}\PYG{o}{.}\PYG{n}{Bucket}\PYG{p}{(}\PYG{n}{bucket}\PYG{p}{)}\PYG{o}{.}\PYG{n}{download\PYGZus{}file}\PYG{p}{(}\PYG{n}{key}\PYG{p}{,} \PYG{n}{file\PYGZus{}name}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} return saved file path}
    \PYG{k}{return} \PYG{n}{file\PYGZus{}name}
\end{sphinxVerbatim}


\subsection{Examples}
\label{\detokenize{s3:id1}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{file\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZus{}bucket/***/***/test/test.json}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{file\PYGZus{}name} \PYG{o}{=} \PYG{n}{s3\PYGZus{}file\PYGZus{}download}\PYG{p}{(}\PYG{n}{file\PYGZus{}path}\PYG{p}{)}
\PYG{g+go}{\PYGZsq{}/temp/test.json\PYGZsq{}}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{joblib}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{n}{filename}\PYG{p}{)}
\end{sphinxVerbatim}


\section{File Management in S3}
\label{\detokenize{s3:file-management-in-s3}}
\sphinxAtStartPar
I mainly use my \sphinxcode{\sphinxupquote{s3\_fs}} to help me do the file management in S3.


\subsection{\sphinxstyleliteralintitle{\sphinxupquote{s3\_fs}} Function}
\label{\detokenize{s3:s3-fs-function}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{s3\_fs}} is mainly based on \sphinxcode{\sphinxupquote{s3fs}} package. The top\sphinxhyphen{}level class
\sphinxcode{\sphinxupquote{s3fs}} holds connection information and allows typical file\sphinxhyphen{}system style
operations like \sphinxcode{\sphinxupquote{cp}}, \sphinxcode{\sphinxupquote{mv}}, \sphinxcode{\sphinxupquote{ls}}, \sphinxcode{\sphinxupquote{walk}}, \sphinxcode{\sphinxupquote{du}}, \sphinxcode{\sphinxupquote{glob}}, etc.
More details can be found at:
\sphinxurl{https://s3fs.readthedocs.io/en/latest/index.html}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{s3fs}

\PYG{n}{s3\PYGZus{}fs} \PYG{o}{=} \PYG{n}{s3fs}\PYG{o}{.}\PYG{n}{S3FileSystem}\PYG{p}{(}\PYG{n}{anon}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,}
                          \PYG{n}{key}\PYG{o}{=}\PYG{n}{credentials}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AccessKeyId}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                          \PYG{n}{secret}\PYG{o}{=}\PYG{n}{credentials}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SecretAccessKey}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                          \PYG{n}{token}\PYG{o}{=}\PYG{n}{credentials}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{SessionToken}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{Examples}
\label{\detokenize{s3:id2}}
\sphinxAtStartPar
Simple locate and read a file:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{n}{s3\PYGZus{}fs}\PYG{o}{.}\PYG{n}{ls}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZhy{}bucket}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{g+go}{[\PYGZsq{}demo\PYGZhy{}file.csv\PYGZsq{}]}
\PYG{g+gp}{\PYGZgt{}\PYGZgt{}\PYGZgt{} }\PYG{k}{with} \PYG{n}{fs}\PYG{o}{.}\PYG{n}{open}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{my\PYGZhy{}bucket/demo\PYGZhy{}file.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
\PYG{g+gp}{... }    \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{g+go}{b\PYGZsq{}UserId\PYGZbs{}tdate\PYGZbs{}nuser\PYGZus{}id1\PYGZbs{}t2019\PYGZhy{}05\PYGZhy{}02\PYGZbs{}nuser\PYGZus{}id2\PYGZbs{}t2019\PYGZhy{}12\PYGZhy{}02\PYGZbs{}n\PYGZsq{}}
\end{sphinxVerbatim}


\chapter{\sphinxstyleliteralintitle{\sphinxupquote{pd.DataFrame}} vs \sphinxstyleliteralintitle{\sphinxupquote{PySpark DataFrame}}}
\label{\detokenize{pdrdd:pd-dataframe-vs-pyspark-dataframe}}\label{\detokenize{pdrdd:pdrdd}}\label{\detokenize{pdrdd::doc}}

\section{Create DataFrame}
\label{\detokenize{pdrdd:create-dataframe}}

\subsection{From List}
\label{\detokenize{pdrdd:from-list}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{col\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} caution for the columns=}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                  \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                  \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}  \PYG{n}{C}\PYG{o}{|}
   \PYG{n}{A}  \PYG{n}{B}  \PYG{n}{C}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{a}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}        \PYG{o}{|}  \PYG{n}{a}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}  \PYG{l+m+mi}{2}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{b}  \PYG{l+m+mi}{2}  \PYG{l+m+mi}{3}        \PYG{o}{|}  \PYG{n}{b}\PYG{o}{|}  \PYG{l+m+mi}{2}\PYG{o}{|}  \PYG{l+m+mi}{3}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{n}{c}  \PYG{l+m+mi}{3}  \PYG{l+m+mi}{4}        \PYG{o}{|}  \PYG{n}{c}\PYG{o}{|}  \PYG{l+m+mi}{3}\PYG{o}{|}  \PYG{l+m+mi}{4}\PYG{o}{|}
                  \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{attention}{Attention:}
\sphinxAtStartPar
Pay attention to the parameter \sphinxcode{\sphinxupquote{columns=}} in \sphinxcode{\sphinxupquote{pd.DataFrame}}. Since the default value will make the list as rows.
\begin{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} caution for the columns=}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
   \PYG{n}{A}  \PYG{n}{B}  \PYG{n}{C}             \PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}
\PYG{l+m+mi}{0}  \PYG{n}{a}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}          \PYG{n}{A}  \PYG{n}{a}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{2}
\PYG{l+m+mi}{1}  \PYG{n}{b}  \PYG{l+m+mi}{2}  \PYG{l+m+mi}{3}          \PYG{n}{B}  \PYG{n}{b}  \PYG{l+m+mi}{2}  \PYG{l+m+mi}{3}
\PYG{l+m+mi}{2}  \PYG{n}{c}  \PYG{l+m+mi}{3}  \PYG{l+m+mi}{4}          \PYG{n}{C}  \PYG{n}{c}  \PYG{l+m+mi}{3}  \PYG{l+m+mi}{4}
\end{sphinxVerbatim}
\end{quote}
\end{sphinxadmonition}


\subsection{From Dict}
\label{\detokenize{pdrdd:from-dict}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{data} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}
        \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{data}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Tedious for PySpark}
\PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{d}\PYG{o}{.}\PYG{n}{values}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{d}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                   \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                   \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}  \PYG{n}{C}\PYG{o}{|}
   \PYG{n}{A}  \PYG{n}{B}  \PYG{n}{C}         \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{1}         \PYG{o}{|}  \PYG{l+m+mi}{0}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{0}         \PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}  \PYG{l+m+mi}{0}\PYG{o}{|}  \PYG{l+m+mi}{0}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{0}         \PYG{o}{|}  \PYG{l+m+mi}{0}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}  \PYG{l+m+mi}{0}\PYG{o}{|}
                   \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Convert between pandas and pyspark DataFrame}
\label{\detokenize{pdrdd:convert-between-pandas-and-pyspark-dataframe}}

\subsection{From pandas to pyspark DataFrame}
\label{\detokenize{pdrdd:from-pandas-to-pyspark-dataframe}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} pd.DataFrame pandas\PYGZus{}df: DataFrame pandas}
\PYG{c+c1}{\PYGZsh{} rdd.DataFrame. spark\PYGZus{}df: DataFrame spark}
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{printSchema}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{From pyspark to pandas DataFrame}
\label{\detokenize{pdrdd:from-pyspark-to-pandas-dataframe}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Example:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{toPandas}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{info}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Load DataFrame}
\label{\detokenize{pdrdd:load-dataframe}}

\subsection{From DataBase}
\label{\detokenize{pdrdd:from-database}}
\sphinxAtStartPar
Most of time, you need to share your code with your colleagues or release your code for Code Review or Quality assurance(QA). You will definitely do not want to have your \sphinxcode{\sphinxupquote{User Information}} in the code. So you can save them
in login.txt:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
runawayhorse001
PythonTips
\end{sphinxVerbatim}

\sphinxAtStartPar
and use the following code to import your \sphinxcode{\sphinxupquote{User Information}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}User Information}
\PYG{k}{try}\PYG{p}{:}
    \PYG{n}{login} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{login.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}
    \PYG{n}{user} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{pw} \PYG{o}{=} \PYG{n}{login}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{User information is ready!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{except}\PYG{p}{:}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Login information is not available!!!}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Database information}
\PYG{n}{host} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}\PYGZsh{}.\PYGZsh{}\PYGZsh{}}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{db\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{db\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{table\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{table\PYGZus{}name}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{conn} \PYG{o}{=} \PYG{n}{psycopg2}\PYG{o}{.}\PYG{n}{connect}\PYG{p}{(}\PYG{n}{host}\PYG{o}{=}\PYG{n}{host}\PYG{p}{,} \PYG{n}{database}\PYG{o}{=}\PYG{n}{db\PYGZus{}name}\PYG{p}{,} \PYG{n}{user}\PYG{o}{=}\PYG{n}{user}\PYG{p}{,} \PYG{n}{password}\PYG{o}{=}\PYG{n}{pw}\PYG{p}{)}
\PYG{n}{cur} \PYG{o}{=} \PYG{n}{conn}\PYG{o}{.}\PYG{n}{cursor}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{sql} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{      select *}
\PYG{l+s+s2}{      from }\PYG{l+s+si}{\PYGZob{}table\PYGZus{}name\PYGZcb{}}
\PYG{l+s+s2}{      }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}\PYG{o}{.}\PYG{n}{format}\PYG{p}{(}\PYG{n}{table\PYGZus{}name}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}sql}\PYG{p}{(}\PYG{n}{sql}\PYG{p}{,} \PYG{n}{conn}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} connect to database}
\PYG{n}{url} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{jdbc:postgresql://}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{host}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:5432/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{db\PYGZus{}name}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{?user=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{user}\PYG{o}{+}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZam{}password=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{+}\PYG{n}{pw}
\PYG{n}{properties} \PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{driver}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{org.postgresql.Driver}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{password}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{pw}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{user}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{n}{user}\PYG{p}{\PYGZcb{}}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{jdbc}\PYG{p}{(}\PYG{n}{url}\PYG{o}{=}\PYG{n}{url}\PYG{p}{,} \PYG{n}{table}\PYG{o}{=}\PYG{n}{table\PYGZus{}name}\PYG{p}{,} \PYG{n}{properties}\PYG{o}{=}\PYG{n}{properties}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{attention}{Attention:}
\sphinxAtStartPar
Reading tables from Database with PySpark neespark\_df the proper drive for the corresponding Database. For example, the above demo neespark\_df org.postgresql.Driver and you need to download it and put it in \sphinxcode{\sphinxupquote{jars}} folder of your spark installation path. I download postgresql\sphinxhyphen{}42.1.1.jar from the official website and put it in jars folder.
\end{sphinxadmonition}


\subsection{From \sphinxstyleliteralintitle{\sphinxupquote{.csv}}}
\label{\detokenize{pdrdd:from-csv}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} pd.DataFrame pandas\PYGZus{}df: DataFrame pandas}
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}rdd.DataFrame. spark\PYGZus{}df: DataFrame spark}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{csv}\PYG{p}{(}\PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{c+c1}{\PYGZsh{}                sep=\PYGZsq{},\PYGZsq{},}
\PYG{c+c1}{\PYGZsh{}                encoding=\PYGZsq{}UTF\PYGZhy{}8\PYGZsq{},}
\PYG{c+c1}{\PYGZsh{}                comment=None,}
               \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}
               \PYG{n}{inferSchema}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}


\subsection{From \sphinxstyleliteralintitle{\sphinxupquote{.json}}}
\label{\detokenize{pdrdd:from-json}}
\sphinxAtStartPar
Data from: \sphinxurl{http://api.luftdaten.info/static/v1/data.json}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}json}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{data/data.json}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{json}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data/data.json}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{id}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{timestamp}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}        \PYG{n+nb}{id}\PYG{o}{|}          \PYG{n}{timestamp}\PYG{o}{|}
            \PYG{n+nb}{id}  \PYG{n}{timestamp}                       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}   \PYG{l+m+mi}{2994551481}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{|}\PYG{l+m+mi}{2994551481}\PYG{o}{|}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mi}{2994551482}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{|}\PYG{l+m+mi}{2994551482}\PYG{o}{|}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mi}{2994551483}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{|}\PYG{l+m+mi}{2994551483}\PYG{o}{|}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{|}
\PYG{l+m+mi}{3}   \PYG{l+m+mi}{2994551484}  \PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}             \PYG{o}{|}\PYG{l+m+mi}{2994551484}\PYG{o}{|}\PYG{l+m+mi}{2019}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{02}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{28} \PYG{l+m+mi}{17}\PYG{p}{:}\PYG{l+m+mi}{23}\PYG{p}{:}\PYG{l+m+mi}{52}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{First \sphinxstyleliteralintitle{\sphinxupquote{n}} Rows}
\label{\detokenize{pdrdd:first-n-rows}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}       \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}     \PYG{l+m+mf}{69.2}\PYG{o}{|} \PYG{l+m+mf}{22.1}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}       \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}     \PYG{l+m+mf}{45.1}\PYG{o}{|} \PYG{l+m+mf}{10.4}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}       \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}     \PYG{l+m+mf}{69.3}\PYG{o}{|}  \PYG{l+m+mf}{9.3}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}       \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}     \PYG{l+m+mf}{58.5}\PYG{o}{|} \PYG{l+m+mf}{18.5}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{Column Names}
\label{\detokenize{pdrdd:column-names}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{Index}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{dtype}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{object}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}


\section{Data types}
\label{\detokenize{pdrdd:data-types}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{dtypes}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{dtypes}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{TV}           \PYG{n}{float64}                    \PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TV}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{Radio}        \PYG{n}{float64}                     \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Radio}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{Newspaper}    \PYG{n}{float64}                     \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,}
\PYG{n}{Sales}        \PYG{n}{float64}                     \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{double}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{dtype}\PYG{p}{:} \PYG{n+nb}{object}
\end{sphinxVerbatim}


\section{Replace Data types}
\label{\detokenize{pdrdd:replace-data-types}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{col\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}


\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{p}{)}

\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{dtypes}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{col1}    \PYG{n+nb}{object}
\PYG{n}{col2}     \PYG{n}{int64}
\PYG{n}{col3}     \PYG{n}{int64}
\PYG{n}{dtype}\PYG{p}{:} \PYG{n+nb}{object}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{d} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{string}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{string}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{str}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{str}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{select}\PYG{p}{(}\PYG{o}{*}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n+nb}{set}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{)}\PYG{o}{\PYGZhy{}}\PYG{n+nb}{set}\PYG{p}{(}\PYG{n}{d}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
               \PYG{o}{*}\PYG{p}{(}\PYG{n}{col}\PYG{p}{(}\PYG{n}{c}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n}{c}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{alias}\PYG{p}{(}\PYG{n}{c}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)} \PYG{k}{for} \PYG{n}{c} \PYG{o+ow}{in} \PYG{n}{d}\PYG{o}{.}\PYG{n}{items}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{col1}    \PYG{n+nb}{object}
\PYG{n}{col2}    \PYG{n+nb}{object}           \PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{string}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{string}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{string}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{col3}    \PYG{n+nb}{object}
\PYG{n}{dtype}\PYG{p}{:} \PYG{n+nb}{object}
\end{sphinxVerbatim}


\section{Fill Null}
\label{\detokenize{pdrdd:fill-null}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{k+kc}{None}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}     \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}   \PYG{n}{C}\PYG{o}{|}
        \PYG{n}{A}  \PYG{n}{B}    \PYG{n}{C}                       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}    \PYG{n}{male}  \PYG{l+m+mi}{1}  \PYG{n}{NaN}                       \PYG{o}{|}  \PYG{n}{male}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{female}  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{3.0}                       \PYG{o}{|}\PYG{n}{female}\PYG{o}{|}  \PYG{l+m+mi}{2}\PYG{o}{|}   \PYG{l+m+mi}{3}\PYG{o}{|}
\PYG{l+m+mi}{2}    \PYG{n}{male}  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{4.0}                       \PYG{o}{|}  \PYG{n}{male}\PYG{o}{|}  \PYG{l+m+mi}{3}\PYG{o}{|}   \PYG{l+m+mi}{4}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{fillna}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{fillna}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}     \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}   \PYG{n}{C}\PYG{o}{|}
        \PYG{n}{A}  \PYG{n}{B}    \PYG{n}{C}                       \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}    \PYG{n}{male}  \PYG{l+m+mi}{1}  \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}                       \PYG{o}{|}  \PYG{n}{male}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{99}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{female}  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{3.0}                       \PYG{o}{|}\PYG{n}{female}\PYG{o}{|}  \PYG{l+m+mi}{2}\PYG{o}{|}   \PYG{l+m+mi}{3}\PYG{o}{|}
\PYG{l+m+mi}{2}    \PYG{n}{male}  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{4.0}                       \PYG{o}{|}  \PYG{n}{male}\PYG{o}{|}  \PYG{l+m+mi}{3}\PYG{o}{|}   \PYG{l+m+mi}{4}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Replace Values}
\label{\detokenize{pdrdd:replace-values}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} caution: you need to chose specific col}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{A}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{female}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{inplace}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df}
\PYG{c+c1}{\PYGZsh{}caution: Mixed type replacements are not supported}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{na}\PYG{o}{.}\PYG{n}{replace}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{male}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{female}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}   \PYG{n}{C}\PYG{o}{|}
   \PYG{n}{A}  \PYG{n}{B}    \PYG{n}{C}                    \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{1}  \PYG{n}{NaN}                    \PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{l+m+mi}{0}  \PYG{l+m+mi}{2}  \PYG{l+m+mf}{3.0}                    \PYG{o}{|}  \PYG{l+m+mi}{0}\PYG{o}{|}  \PYG{l+m+mi}{2}\PYG{o}{|}   \PYG{l+m+mi}{3}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{l+m+mi}{1}  \PYG{l+m+mi}{3}  \PYG{l+m+mf}{4.0}                    \PYG{o}{|}  \PYG{l+m+mi}{1}\PYG{o}{|}  \PYG{l+m+mi}{3}\PYG{o}{|}   \PYG{l+m+mi}{4}\PYG{o}{|}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Rename Columns}
\label{\detokenize{pdrdd:rename-columns}}

\subsection{Rename all columns}
\label{\detokenize{pdrdd:rename-all-columns}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{toDF}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{d}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}    \PYG{n}{a}\PYG{o}{|}   \PYG{n}{b}\PYG{o}{|}   \PYG{n}{c}\PYG{o}{|}   \PYG{n}{d}\PYG{o}{|}
       \PYG{n}{a}     \PYG{n}{b}     \PYG{n}{c}     \PYG{n}{d}                      \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}  \PYG{l+m+mf}{37.8}  \PYG{l+m+mf}{69.2}  \PYG{l+m+mf}{22.1}                      \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|}\PYG{l+m+mf}{37.8}\PYG{o}{|}\PYG{l+m+mf}{69.2}\PYG{o}{|}\PYG{l+m+mf}{22.1}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}  \PYG{l+m+mf}{39.3}  \PYG{l+m+mf}{45.1}  \PYG{l+m+mf}{10.4}                      \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|}\PYG{l+m+mf}{39.3}\PYG{o}{|}\PYG{l+m+mf}{45.1}\PYG{o}{|}\PYG{l+m+mf}{10.4}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}  \PYG{l+m+mf}{45.9}  \PYG{l+m+mf}{69.3}   \PYG{l+m+mf}{9.3}                      \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|}\PYG{l+m+mf}{45.9}\PYG{o}{|}\PYG{l+m+mf}{69.3}\PYG{o}{|} \PYG{l+m+mf}{9.3}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}  \PYG{l+m+mf}{41.3}  \PYG{l+m+mf}{58.5}  \PYG{l+m+mf}{18.5}                      \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|}\PYG{l+m+mf}{41.3}\PYG{o}{|}\PYG{l+m+mf}{58.5}\PYG{o}{|}\PYG{l+m+mf}{18.5}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\subsection{Rename one or more columns}
\label{\detokenize{pdrdd:rename-one-or-more-columns}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{mapping} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{mapping}\PYG{p}{)}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{new\PYGZus{}names} \PYG{o}{=} \PYG{p}{[}\PYG{n}{mapping}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{n}{col}\PYG{p}{,}\PYG{n}{col}\PYG{p}{)} \PYG{k}{for} \PYG{n}{col} \PYG{o+ow}{in} \PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{columns}\PYG{p}{]}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{toDF}\PYG{p}{(}\PYG{o}{*}\PYG{n}{new\PYGZus{}names}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}   \PYG{n}{C}\PYG{o}{|}   \PYG{n}{D}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}     \PYG{n}{C}     \PYG{n}{D}             \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}  \PYG{l+m+mf}{69.2}  \PYG{l+m+mf}{22.1}             \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}\PYG{l+m+mf}{69.2}\PYG{o}{|}\PYG{l+m+mf}{22.1}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}  \PYG{l+m+mf}{45.1}  \PYG{l+m+mf}{10.4}             \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}\PYG{l+m+mf}{45.1}\PYG{o}{|}\PYG{l+m+mf}{10.4}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}  \PYG{l+m+mf}{69.3}   \PYG{l+m+mf}{9.3}             \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}\PYG{l+m+mf}{69.3}\PYG{o}{|} \PYG{l+m+mf}{9.3}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}  \PYG{l+m+mf}{58.5}  \PYG{l+m+mf}{18.5}             \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}\PYG{l+m+mf}{58.5}\PYG{o}{|}\PYG{l+m+mf}{18.5}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
You can also use \sphinxcode{\sphinxupquote{withColumnRenamed}} to rename one column in PySpark.

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumnRenamed}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Paper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Paper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}
\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|} \PYG{l+m+mf}{69.2}\PYG{o}{|} \PYG{l+m+mf}{22.1}\PYG{o}{|}
\PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|} \PYG{l+m+mf}{45.1}\PYG{o}{|} \PYG{l+m+mf}{10.4}\PYG{o}{|}
\PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|} \PYG{l+m+mf}{69.3}\PYG{o}{|}  \PYG{l+m+mf}{9.3}\PYG{o}{|}
\PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|} \PYG{l+m+mf}{58.5}\PYG{o}{|} \PYG{l+m+mf}{18.5}\PYG{o}{|}
\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}
\end{sphinxadmonition}


\section{Drop Columns}
\label{\detokenize{pdrdd:drop-columns}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{drop\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Newspaper}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Sales}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{n}{drop\PYGZus{}name}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{drop}\PYG{p}{(}\PYG{o}{*}\PYG{n}{drop\PYGZus{}name}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}                 \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}                 \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}                 \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}                 \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}                 \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{Filter}
\label{\detokenize{pdrdd:filter}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{read}\PYG{o}{.}\PYG{n}{csv}\PYG{p}{(}\PYG{n}{path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Advertising.csv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                    \PYG{n}{header}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,}
                    \PYG{n}{inferSchema}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{p}{[}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}
       \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}              \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{7}   \PYG{l+m+mf}{120.2}   \PYG{l+m+mf}{19.6}       \PYG{l+m+mf}{11.6}   \PYG{l+m+mf}{13.2}              \PYG{o}{|}\PYG{l+m+mf}{120.2}\PYG{o}{|} \PYG{l+m+mf}{19.6}\PYG{o}{|}     \PYG{l+m+mf}{11.6}\PYG{o}{|} \PYG{l+m+mf}{13.2}\PYG{o}{|}
\PYG{l+m+mi}{8}     \PYG{l+m+mf}{8.6}    \PYG{l+m+mf}{2.1}        \PYG{l+m+mf}{1.0}    \PYG{l+m+mf}{4.8}              \PYG{o}{|}  \PYG{l+m+mf}{8.6}\PYG{o}{|}  \PYG{l+m+mf}{2.1}\PYG{o}{|}      \PYG{l+m+mf}{1.0}\PYG{o}{|}  \PYG{l+m+mf}{4.8}\PYG{o}{|}
\PYG{l+m+mi}{11}  \PYG{l+m+mf}{214.7}   \PYG{l+m+mf}{24.0}        \PYG{l+m+mf}{4.0}   \PYG{l+m+mf}{17.4}              \PYG{o}{|}\PYG{l+m+mf}{214.7}\PYG{o}{|} \PYG{l+m+mf}{24.0}\PYG{o}{|}      \PYG{l+m+mf}{4.0}\PYG{o}{|} \PYG{l+m+mf}{17.4}\PYG{o}{|}
\PYG{l+m+mi}{13}   \PYG{l+m+mf}{97.5}    \PYG{l+m+mf}{7.6}        \PYG{l+m+mf}{7.2}    \PYG{l+m+mf}{9.7}              \PYG{o}{|} \PYG{l+m+mf}{97.5}\PYG{o}{|}  \PYG{l+m+mf}{7.6}\PYG{o}{|}      \PYG{l+m+mf}{7.2}\PYG{o}{|}  \PYG{l+m+mf}{9.7}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{]}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{p}{[}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{Newspaper}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{20}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{p}{]}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}
       \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}              \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{7}   \PYG{l+m+mf}{120.2}   \PYG{l+m+mf}{19.6}       \PYG{l+m+mf}{11.6}   \PYG{l+m+mf}{13.2}              \PYG{o}{|}\PYG{l+m+mf}{120.2}\PYG{o}{|} \PYG{l+m+mf}{19.6}\PYG{o}{|}     \PYG{l+m+mf}{11.6}\PYG{o}{|} \PYG{l+m+mf}{13.2}\PYG{o}{|}
\PYG{l+m+mi}{11}  \PYG{l+m+mf}{214.7}   \PYG{l+m+mf}{24.0}        \PYG{l+m+mf}{4.0}   \PYG{l+m+mf}{17.4}              \PYG{o}{|}\PYG{l+m+mf}{214.7}\PYG{o}{|} \PYG{l+m+mf}{24.0}\PYG{o}{|}      \PYG{l+m+mf}{4.0}\PYG{o}{|} \PYG{l+m+mf}{17.4}\PYG{o}{|}
\PYG{l+m+mi}{19}  \PYG{l+m+mf}{147.3}   \PYG{l+m+mf}{23.9}       \PYG{l+m+mf}{19.1}   \PYG{l+m+mf}{14.6}              \PYG{o}{|}\PYG{l+m+mf}{147.3}\PYG{o}{|} \PYG{l+m+mf}{23.9}\PYG{o}{|}     \PYG{l+m+mf}{19.1}\PYG{o}{|} \PYG{l+m+mf}{14.6}\PYG{o}{|}
\PYG{l+m+mi}{25}  \PYG{l+m+mf}{262.9}    \PYG{l+m+mf}{3.5}       \PYG{l+m+mf}{19.5}   \PYG{l+m+mf}{12.0}              \PYG{o}{|}\PYG{l+m+mf}{262.9}\PYG{o}{|}  \PYG{l+m+mf}{3.5}\PYG{o}{|}     \PYG{l+m+mf}{19.5}\PYG{o}{|} \PYG{l+m+mf}{12.0}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{With New Column}
\label{\detokenize{pdrdd:with-new-column}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv\PYGZus{}norm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{/}\PYG{n+nb}{sum}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv\PYGZus{}norm}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{/}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{groupBy}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{agg}\PYG{p}{(}\PYG{n}{F}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{TV}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{collect}\PYG{p}{(}\PYG{p}{)}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}             \PYG{n}{tv\PYGZus{}norm}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}   \PYG{n}{tv\PYGZus{}norm}     \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}  \PYG{l+m+mf}{0.007824}     \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}     \PYG{l+m+mf}{69.2}\PYG{o}{|} \PYG{l+m+mf}{22.1}\PYG{o}{|}\PYG{l+m+mf}{0.007824268493802813}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}  \PYG{l+m+mf}{0.001513}     \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}     \PYG{l+m+mf}{45.1}\PYG{o}{|} \PYG{l+m+mf}{10.4}\PYG{o}{|}\PYG{l+m+mf}{0.001513167961643}\PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}  \PYG{l+m+mf}{0.000585}     \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}     \PYG{l+m+mf}{69.3}\PYG{o}{|}  \PYG{l+m+mf}{9.3}\PYG{o}{|}\PYG{l+m+mf}{5.848649200061207E\PYGZhy{}4}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}  \PYG{l+m+mf}{0.005152}     \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}     \PYG{l+m+mf}{58.5}\PYG{o}{|} \PYG{l+m+mf}{18.5}\PYG{o}{|}\PYG{l+m+mf}{0.005151571824472517}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cond}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{c}\PYG{p}{:} \PYG{l+m+mi}{1} \PYG{k}{if} \PYG{p}{(}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{c}\PYG{o}{.}\PYG{n}{Radio}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{)} \PYG{k}{else} \PYG{l+m+mi}{2} \PYG{k}{if} \PYG{n}{c}\PYG{o}{.}\PYG{n}{Sales}\PYG{o}{\PYGZgt{}} \PYG{l+m+mi}{10} \PYG{k}{else} \PYG{l+m+mi}{3}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cond}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{F}\PYG{o}{.}\PYG{n}{when}\PYG{p}{(}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{100}\PYG{p}{)}\PYG{o}{\PYGZam{}}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{Radio}\PYG{o}{\PYGZlt{}}\PYG{l+m+mi}{40}\PYG{p}{)}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}\PYGZbs{}
                      \PYG{o}{.}\PYG{n}{when}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{Sales}\PYG{o}{\PYGZgt{}}\PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYGZbs{}
                      \PYG{o}{.}\PYG{n}{otherwise}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}\PYG{n}{cond}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}  \PYG{n}{cond}         \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}     \PYG{l+m+mi}{1}         \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}     \PYG{l+m+mf}{69.2}\PYG{o}{|} \PYG{l+m+mf}{22.1}\PYG{o}{|}   \PYG{l+m+mi}{1}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}     \PYG{l+m+mi}{2}         \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}     \PYG{l+m+mf}{45.1}\PYG{o}{|} \PYG{l+m+mf}{10.4}\PYG{o}{|}   \PYG{l+m+mi}{2}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}     \PYG{l+m+mi}{3}         \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}     \PYG{l+m+mf}{69.3}\PYG{o}{|}  \PYG{l+m+mf}{9.3}\PYG{o}{|}   \PYG{l+m+mi}{3}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}     \PYG{l+m+mi}{2}         \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}     \PYG{l+m+mf}{58.5}\PYG{o}{|} \PYG{l+m+mf}{18.5}\PYG{o}{|}   \PYG{l+m+mi}{2}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log\PYGZus{}tv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{log\PYGZus{}tv}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{F}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}            \PYG{n}{log\PYGZus{}tv}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}    \PYG{n}{log\PYGZus{}tv}     \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}  \PYG{l+m+mf}{5.438514}     \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}     \PYG{l+m+mf}{69.2}\PYG{o}{|} \PYG{l+m+mf}{22.1}\PYG{o}{|}  \PYG{l+m+mf}{5.43851399704132}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}  \PYG{l+m+mf}{3.795489}     \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}     \PYG{l+m+mf}{45.1}\PYG{o}{|} \PYG{l+m+mf}{10.4}\PYG{o}{|}\PYG{l+m+mf}{3.7954891891721947}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}  \PYG{l+m+mf}{2.844909}     \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}     \PYG{l+m+mf}{69.3}\PYG{o}{|}  \PYG{l+m+mf}{9.3}\PYG{o}{|}\PYG{l+m+mf}{2.8449093838194073}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}  \PYG{l+m+mf}{5.020586}     \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}     \PYG{l+m+mf}{58.5}\PYG{o}{|} \PYG{l+m+mf}{18.5}\PYG{o}{|} \PYG{l+m+mf}{5.020585624949423}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv+10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:} \PYG{n}{x}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{head}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{tv+10}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{TV}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}   \PYG{n}{TV}\PYG{o}{|}\PYG{n}{Radio}\PYG{o}{|}\PYG{n}{Newspaper}\PYG{o}{|}\PYG{n}{Sales}\PYG{o}{|}\PYG{n}{tv}\PYG{o}{+}\PYG{l+m+mi}{10}\PYG{o}{|}
      \PYG{n}{TV}  \PYG{n}{Radio}  \PYG{n}{Newspaper}  \PYG{n}{Sales}  \PYG{n}{tv}\PYG{o}{+}\PYG{l+m+mi}{10}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{l+m+mf}{230.1}   \PYG{l+m+mf}{37.8}       \PYG{l+m+mf}{69.2}   \PYG{l+m+mf}{22.1}  \PYG{l+m+mf}{240.1}        \PYG{o}{|}\PYG{l+m+mf}{230.1}\PYG{o}{|} \PYG{l+m+mf}{37.8}\PYG{o}{|}     \PYG{l+m+mf}{69.2}\PYG{o}{|} \PYG{l+m+mf}{22.1}\PYG{o}{|}\PYG{l+m+mf}{240.1}\PYG{o}{|}
\PYG{l+m+mi}{1}   \PYG{l+m+mf}{44.5}   \PYG{l+m+mf}{39.3}       \PYG{l+m+mf}{45.1}   \PYG{l+m+mf}{10.4}   \PYG{l+m+mf}{54.5}        \PYG{o}{|} \PYG{l+m+mf}{44.5}\PYG{o}{|} \PYG{l+m+mf}{39.3}\PYG{o}{|}     \PYG{l+m+mf}{45.1}\PYG{o}{|} \PYG{l+m+mf}{10.4}\PYG{o}{|} \PYG{l+m+mf}{54.5}\PYG{o}{|}
\PYG{l+m+mi}{2}   \PYG{l+m+mf}{17.2}   \PYG{l+m+mf}{45.9}       \PYG{l+m+mf}{69.3}    \PYG{l+m+mf}{9.3}   \PYG{l+m+mf}{27.2}        \PYG{o}{|} \PYG{l+m+mf}{17.2}\PYG{o}{|} \PYG{l+m+mf}{45.9}\PYG{o}{|}     \PYG{l+m+mf}{69.3}\PYG{o}{|}  \PYG{l+m+mf}{9.3}\PYG{o}{|} \PYG{l+m+mf}{27.2}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{l+m+mf}{151.5}   \PYG{l+m+mf}{41.3}       \PYG{l+m+mf}{58.5}   \PYG{l+m+mf}{18.5}  \PYG{l+m+mf}{161.5}        \PYG{o}{|}\PYG{l+m+mf}{151.5}\PYG{o}{|} \PYG{l+m+mf}{41.3}\PYG{o}{|}     \PYG{l+m+mf}{58.5}\PYG{o}{|} \PYG{l+m+mf}{18.5}\PYG{o}{|}\PYG{l+m+mf}{161.5}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{n}{only} \PYG{n}{showing} \PYG{n}{top} \PYG{l+m+mi}{4} \PYG{n}{rows}
\end{sphinxVerbatim}


\section{Join}
\label{\detokenize{pdrdd:join}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                    \PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{rightp} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                       \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{F}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{B7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                       \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{G}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{C7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}
                       \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{H}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D4}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D5}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D6}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{D7}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                       \PYG{n}{index}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{)}

\PYG{n}{lefts} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{leftp}\PYG{p}{)}
\PYG{n}{rights} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
    \PYG{n}{A}   \PYG{n}{B}   \PYG{n}{C}   \PYG{n}{D}                   \PYG{n}{A}   \PYG{n}{F}   \PYG{n}{G}   \PYG{n}{H}
\PYG{l+m+mi}{0}  \PYG{n}{A0}  \PYG{n}{B0}  \PYG{n}{C0}  \PYG{n}{D0}               \PYG{l+m+mi}{4}  \PYG{n}{A0}  \PYG{n}{B4}  \PYG{n}{C4}  \PYG{n}{D4}
\PYG{l+m+mi}{1}  \PYG{n}{A1}  \PYG{n}{B1}  \PYG{n}{C1}  \PYG{n}{D1}               \PYG{l+m+mi}{5}  \PYG{n}{A1}  \PYG{n}{B5}  \PYG{n}{C5}  \PYG{n}{D5}
\PYG{l+m+mi}{2}  \PYG{n}{A2}  \PYG{n}{B2}  \PYG{n}{C2}  \PYG{n}{D2}               \PYG{l+m+mi}{6}  \PYG{n}{A6}  \PYG{n}{B6}  \PYG{n}{C6}  \PYG{n}{D6}
\PYG{l+m+mi}{3}  \PYG{n}{A3}  \PYG{n}{B3}  \PYG{n}{C3}  \PYG{n}{D3}               \PYG{l+m+mi}{7}  \PYG{n}{A7}  \PYG{n}{B7}  \PYG{n}{C7}  \PYG{n}{D7}
\end{sphinxVerbatim}


\subsection{Left Join}
\label{\detokenize{pdrdd:left-join}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{left}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}  \PYG{n}{C}\PYG{o}{|}  \PYG{n}{D}\PYG{o}{|}   \PYG{n}{F}\PYG{o}{|}   \PYG{n}{G}\PYG{o}{|}   \PYG{n}{H}\PYG{o}{|}
    \PYG{n}{A}   \PYG{n}{B}   \PYG{n}{C}   \PYG{n}{D}    \PYG{n}{F}    \PYG{n}{G}    \PYG{n}{H}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}  \PYG{n}{B0}  \PYG{n}{C0}  \PYG{n}{D0}   \PYG{n}{B4}   \PYG{n}{C4}   \PYG{n}{D4}        \PYG{o}{|} \PYG{n}{A0}\PYG{o}{|} \PYG{n}{B0}\PYG{o}{|} \PYG{n}{C0}\PYG{o}{|} \PYG{n}{D0}\PYG{o}{|}  \PYG{n}{B4}\PYG{o}{|}  \PYG{n}{C4}\PYG{o}{|}  \PYG{n}{D4}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{A1}  \PYG{n}{B1}  \PYG{n}{C1}  \PYG{n}{D1}   \PYG{n}{B5}   \PYG{n}{C5}   \PYG{n}{D5}        \PYG{o}{|} \PYG{n}{A1}\PYG{o}{|} \PYG{n}{B1}\PYG{o}{|} \PYG{n}{C1}\PYG{o}{|} \PYG{n}{D1}\PYG{o}{|}  \PYG{n}{B5}\PYG{o}{|}  \PYG{n}{C5}\PYG{o}{|}  \PYG{n}{D5}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{n}{A2}  \PYG{n}{B2}  \PYG{n}{C2}  \PYG{n}{D2}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}        \PYG{o}{|} \PYG{n}{A2}\PYG{o}{|} \PYG{n}{B2}\PYG{o}{|} \PYG{n}{C2}\PYG{o}{|} \PYG{n}{D2}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{n}{A3}  \PYG{n}{B3}  \PYG{n}{C3}  \PYG{n}{D3}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}        \PYG{o}{|} \PYG{n}{A3}\PYG{o}{|} \PYG{n}{B3}\PYG{o}{|} \PYG{n}{C3}\PYG{o}{|} \PYG{n}{D3}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\subsection{Right Join}
\label{\detokenize{pdrdd:right-join}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{right}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}   \PYG{n}{B}\PYG{o}{|}   \PYG{n}{C}\PYG{o}{|}   \PYG{n}{D}\PYG{o}{|}  \PYG{n}{F}\PYG{o}{|}  \PYG{n}{G}\PYG{o}{|}  \PYG{n}{H}\PYG{o}{|}
    \PYG{n}{A}    \PYG{n}{B}    \PYG{n}{C}    \PYG{n}{D}   \PYG{n}{F}   \PYG{n}{G}   \PYG{n}{H}        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}   \PYG{n}{B0}   \PYG{n}{C0}   \PYG{n}{D0}  \PYG{n}{B4}  \PYG{n}{C4}  \PYG{n}{D4}        \PYG{o}{|} \PYG{n}{A0}\PYG{o}{|}  \PYG{n}{B0}\PYG{o}{|}  \PYG{n}{C0}\PYG{o}{|}  \PYG{n}{D0}\PYG{o}{|} \PYG{n}{B4}\PYG{o}{|} \PYG{n}{C4}\PYG{o}{|} \PYG{n}{D4}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{A1}   \PYG{n}{B1}   \PYG{n}{C1}   \PYG{n}{D1}  \PYG{n}{B5}  \PYG{n}{C5}  \PYG{n}{D5}        \PYG{o}{|} \PYG{n}{A1}\PYG{o}{|}  \PYG{n}{B1}\PYG{o}{|}  \PYG{n}{C1}\PYG{o}{|}  \PYG{n}{D1}\PYG{o}{|} \PYG{n}{B5}\PYG{o}{|} \PYG{n}{C5}\PYG{o}{|} \PYG{n}{D5}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{n}{A6}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{B6}  \PYG{n}{C6}  \PYG{n}{D6}        \PYG{o}{|} \PYG{n}{A6}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|} \PYG{n}{B6}\PYG{o}{|} \PYG{n}{C6}\PYG{o}{|} \PYG{n}{D6}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{n}{A7}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{B7}  \PYG{n}{C7}  \PYG{n}{D7}        \PYG{o}{|} \PYG{n}{A7}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|} \PYG{n}{B7}\PYG{o}{|} \PYG{n}{C7}\PYG{o}{|} \PYG{n}{D7}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\subsection{Inner Join}
\label{\detokenize{pdrdd:inner-join}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{inner}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}  \PYG{n}{B}\PYG{o}{|}  \PYG{n}{C}\PYG{o}{|}  \PYG{n}{D}\PYG{o}{|}  \PYG{n}{F}\PYG{o}{|}  \PYG{n}{G}\PYG{o}{|}  \PYG{n}{H}\PYG{o}{|}
    \PYG{n}{A}   \PYG{n}{B}   \PYG{n}{C}   \PYG{n}{D}   \PYG{n}{F}   \PYG{n}{G}   \PYG{n}{H}   \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}  \PYG{n}{B0}  \PYG{n}{C0}  \PYG{n}{D0}  \PYG{n}{B4}  \PYG{n}{C4}  \PYG{n}{D4}   \PYG{o}{|} \PYG{n}{A0}\PYG{o}{|} \PYG{n}{B0}\PYG{o}{|} \PYG{n}{C0}\PYG{o}{|} \PYG{n}{D0}\PYG{o}{|} \PYG{n}{B4}\PYG{o}{|} \PYG{n}{C4}\PYG{o}{|} \PYG{n}{D4}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{A1}  \PYG{n}{B1}  \PYG{n}{C1}  \PYG{n}{D1}  \PYG{n}{B5}  \PYG{n}{C5}  \PYG{n}{D5}   \PYG{o}{|} \PYG{n}{A1}\PYG{o}{|} \PYG{n}{B1}\PYG{o}{|} \PYG{n}{C1}\PYG{o}{|} \PYG{n}{D1}\PYG{o}{|} \PYG{n}{B5}\PYG{o}{|} \PYG{n}{C5}\PYG{o}{|} \PYG{n}{D5}\PYG{o}{|}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\subsection{Full Join}
\label{\detokenize{pdrdd:full-join}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{leftp}\PYG{o}{.}\PYG{n}{merge}\PYG{p}{(}\PYG{n}{rightp}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{full}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{lefts}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{rights}\PYG{p}{,}\PYG{n}{on}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{how}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{full}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
     \PYG{o}{.}\PYG{n}{orderBy}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{ascending}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}   \PYG{n}{B}\PYG{o}{|}   \PYG{n}{C}\PYG{o}{|}   \PYG{n}{D}\PYG{o}{|}   \PYG{n}{F}\PYG{o}{|}   \PYG{n}{G}\PYG{o}{|}   \PYG{n}{H}\PYG{o}{|}
    \PYG{n}{A}    \PYG{n}{B}    \PYG{n}{C}    \PYG{n}{D}    \PYG{n}{F}    \PYG{n}{G}    \PYG{n}{H}     \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{A0}   \PYG{n}{B0}   \PYG{n}{C0}   \PYG{n}{D0}   \PYG{n}{B4}   \PYG{n}{C4}   \PYG{n}{D4}     \PYG{o}{|} \PYG{n}{A0}\PYG{o}{|}  \PYG{n}{B0}\PYG{o}{|}  \PYG{n}{C0}\PYG{o}{|}  \PYG{n}{D0}\PYG{o}{|}  \PYG{n}{B4}\PYG{o}{|}  \PYG{n}{C4}\PYG{o}{|}  \PYG{n}{D4}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{A1}   \PYG{n}{B1}   \PYG{n}{C1}   \PYG{n}{D1}   \PYG{n}{B5}   \PYG{n}{C5}   \PYG{n}{D5}     \PYG{o}{|} \PYG{n}{A1}\PYG{o}{|}  \PYG{n}{B1}\PYG{o}{|}  \PYG{n}{C1}\PYG{o}{|}  \PYG{n}{D1}\PYG{o}{|}  \PYG{n}{B5}\PYG{o}{|}  \PYG{n}{C5}\PYG{o}{|}  \PYG{n}{D5}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{n}{A2}   \PYG{n}{B2}   \PYG{n}{C2}   \PYG{n}{D2}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}     \PYG{o}{|} \PYG{n}{A2}\PYG{o}{|}  \PYG{n}{B2}\PYG{o}{|}  \PYG{n}{C2}\PYG{o}{|}  \PYG{n}{D2}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
\PYG{l+m+mi}{3}  \PYG{n}{A3}   \PYG{n}{B3}   \PYG{n}{C3}   \PYG{n}{D3}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}     \PYG{o}{|} \PYG{n}{A3}\PYG{o}{|}  \PYG{n}{B3}\PYG{o}{|}  \PYG{n}{C3}\PYG{o}{|}  \PYG{n}{D3}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
\PYG{l+m+mi}{4}  \PYG{n}{A6}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}   \PYG{n}{B6}   \PYG{n}{C6}   \PYG{n}{D6}     \PYG{o}{|} \PYG{n}{A6}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}  \PYG{n}{B6}\PYG{o}{|}  \PYG{n}{C6}\PYG{o}{|}  \PYG{n}{D6}\PYG{o}{|}
\PYG{l+m+mi}{5}  \PYG{n}{A7}  \PYG{n}{NaN}  \PYG{n}{NaN}  \PYG{n}{NaN}   \PYG{n}{B7}   \PYG{n}{C7}   \PYG{n}{D7}     \PYG{o}{|} \PYG{n}{A7}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}  \PYG{n}{B7}\PYG{o}{|}  \PYG{n}{C7}\PYG{o}{|}  \PYG{n}{D7}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Concat Columns}
\label{\detokenize{pdrdd:concat-columns}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{,}
           \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{9}\PYG{p}{)}\PYG{p}{]}
\PYG{n}{col\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{schema}\PYG{o}{=}\PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
  \PYG{n}{col1}  \PYG{n}{col2}  \PYG{n}{col3}
\PYG{l+m+mi}{0}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}
\PYG{l+m+mi}{1}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}
\PYG{l+m+mi}{2}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}
\PYG{l+m+mi}{3}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}
\PYG{l+m+mi}{4}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}
\PYG{l+m+mi}{5}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} one (or both) of the columns are not string typed, convert it (them) first to string,}
    \PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{concat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{+} \PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} alternatively}
    \PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{concat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{apply}\PYG{p}{(}\PYG{k}{lambda} \PYG{n}{x}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{\PYGZpc{}}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,}\PYG{n}{x}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} don\PYGZsq{}t use pandas\PYGZus{}df[\PYGZsq{}concat\PYGZsq{}] = pandas\PYGZus{}df[[\PYGZsq{}col1\PYGZsq{}, \PYGZsq{}col2\PYGZsq{}]].apply(lambda x: \PYGZsq{}\PYGZsq{}.join(x), axis=1)}
\PYG{c+c1}{\PYGZsh{} note it will error out as expecting both fields are strings}
\PYG{c+c1}{\PYGZsh{}}
    \PYG{n}{pandas\PYGZus{}df}
    \PYG{c+c1}{\PYGZsh{}}
    \PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{concat}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{F}\PYG{o}{.}\PYG{n}{concat}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                        \PYG{o}{|}\PYG{n}{col1}\PYG{o}{|}\PYG{n}{col2}\PYG{o}{|}\PYG{n}{col3}\PYG{o}{|}\PYG{n}{concat}\PYG{o}{|}
  \PYG{n}{col1}  \PYG{n}{col2}  \PYG{n}{col3} \PYG{n}{concat}               \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}     \PYG{n}{a2}               \PYG{o}{|}   \PYG{n}{a}\PYG{o}{|}   \PYG{l+m+mi}{2}\PYG{o}{|}   \PYG{l+m+mi}{3}\PYG{o}{|}    \PYG{n}{a2}\PYG{o}{|}
\PYG{l+m+mi}{1}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}     \PYG{n}{b5}               \PYG{o}{|}   \PYG{n}{b}\PYG{o}{|}   \PYG{l+m+mi}{5}\PYG{o}{|}   \PYG{l+m+mi}{6}\PYG{o}{|}    \PYG{n}{b5}\PYG{o}{|}
\PYG{l+m+mi}{2}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}     \PYG{n}{c8}               \PYG{o}{|}   \PYG{n}{c}\PYG{o}{|}   \PYG{l+m+mi}{8}\PYG{o}{|}   \PYG{l+m+mi}{9}\PYG{o}{|}    \PYG{n}{c8}\PYG{o}{|}
\PYG{l+m+mi}{3}    \PYG{n}{a}     \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}     \PYG{n}{a2}               \PYG{o}{|}   \PYG{n}{a}\PYG{o}{|}   \PYG{l+m+mi}{2}\PYG{o}{|}   \PYG{l+m+mi}{3}\PYG{o}{|}    \PYG{n}{a2}\PYG{o}{|}
\PYG{l+m+mi}{4}    \PYG{n}{b}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}     \PYG{n}{b5}               \PYG{o}{|}   \PYG{n}{b}\PYG{o}{|}   \PYG{l+m+mi}{5}\PYG{o}{|}   \PYG{l+m+mi}{6}\PYG{o}{|}    \PYG{n}{b5}\PYG{o}{|}
\PYG{l+m+mi}{5}    \PYG{n}{c}     \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}     \PYG{n}{c8}               \PYG{o}{|}   \PYG{n}{c}\PYG{o}{|}   \PYG{l+m+mi}{8}\PYG{o}{|}   \PYG{l+m+mi}{9}\PYG{o}{|}    \PYG{n}{c8}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{GroupBy}
\label{\detokenize{pdrdd:groupby}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{o}{.}\PYG{n}{groupby}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{agg}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{mean}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{groupBy}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{agg}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{min}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{avg}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
      \PYG{n}{col2}  \PYG{n}{col3}                        \PYG{o}{|}\PYG{n}{col1}\PYG{o}{|}\PYG{n+nb}{min}\PYG{p}{(}\PYG{n}{col2}\PYG{p}{)}\PYG{o}{|}\PYG{n}{avg}\PYG{p}{(}\PYG{n}{col3}\PYG{p}{)}\PYG{o}{|}
\PYG{n}{col1}                                    \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{a}        \PYG{l+m+mi}{2}     \PYG{l+m+mi}{3}                        \PYG{o}{|}   \PYG{n}{c}\PYG{o}{|}        \PYG{l+m+mi}{8}\PYG{o}{|}      \PYG{l+m+mf}{9.0}\PYG{o}{|}
\PYG{n}{b}        \PYG{l+m+mi}{5}     \PYG{l+m+mi}{6}                        \PYG{o}{|}   \PYG{n}{b}\PYG{o}{|}        \PYG{l+m+mi}{5}\PYG{o}{|}      \PYG{l+m+mf}{6.0}\PYG{o}{|}
\PYG{n}{c}        \PYG{l+m+mi}{8}     \PYG{l+m+mi}{9}                        \PYG{o}{|}   \PYG{n}{a}\PYG{o}{|}        \PYG{l+m+mi}{2}\PYG{o}{|}      \PYG{l+m+mf}{3.0}\PYG{o}{|}
                                        \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Pivot}
\label{\detokenize{pdrdd:pivot}}
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pd}\PYG{o}{.}\PYG{n}{pivot\PYGZus{}table}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{p}{,} \PYG{n}{values}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{index}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{columns}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{aggfunc}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{groupBy}\PYG{p}{(}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col1}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}\PYG{o}{.}\PYG{n}{pivot}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col2}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{sum}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{col3}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{col2}    \PYG{l+m+mi}{2}     \PYG{l+m+mi}{5}     \PYG{l+m+mi}{8}           \PYG{o}{|}\PYG{n}{col1}\PYG{o}{|}   \PYG{l+m+mi}{2}\PYG{o}{|}   \PYG{l+m+mi}{5}\PYG{o}{|}   \PYG{l+m+mi}{8}\PYG{o}{|}
\PYG{n}{col1}                            \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{n}{a}     \PYG{l+m+mf}{6.0}   \PYG{n}{NaN}   \PYG{n}{NaN}           \PYG{o}{|}   \PYG{n}{c}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}  \PYG{l+m+mi}{18}\PYG{o}{|}
\PYG{n}{b}     \PYG{n}{NaN}  \PYG{l+m+mf}{12.0}   \PYG{n}{NaN}           \PYG{o}{|}   \PYG{n}{b}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}  \PYG{l+m+mi}{12}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
\PYG{n}{c}     \PYG{n}{NaN}   \PYG{n}{NaN}  \PYG{l+m+mf}{18.0}           \PYG{o}{|}   \PYG{n}{a}\PYG{o}{|}   \PYG{l+m+mi}{6}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}\PYG{n}{null}\PYG{o}{|}
                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\section{Unixtime to Date}
\label{\detokenize{pdrdd:unixtime-to-date}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{datetime} \PYG{k+kn}{import} \PYG{n}{datetime}

\PYG{n}{my\PYGZus{}list} \PYG{o}{=} \PYG{p}{[}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1284101485}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{b}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{2284101485}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{c}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{int}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{3284101485}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{]}\PYG{p}{]}
\PYG{n}{col\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{n}{pandas\PYGZus{}df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{n}{my\PYGZus{}list}\PYG{p}{,}\PYG{n}{columns}\PYG{o}{=}\PYG{n}{col\PYGZus{}name}\PYG{p}{)}
\PYG{n}{spark\PYGZus{}df} \PYG{o}{=} \PYG{n}{spark}\PYG{o}{.}\PYG{n}{createDataFrame}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Python Code:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{datetime}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}datetime}\PYG{p}{(}\PYG{n}{pandas\PYGZus{}df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{unit}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{s}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{dt}\PYG{o}{.}\PYG{n}{tz\PYGZus{}localize}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{UTC}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{pandas\PYGZus{}df}

\PYG{n}{spark}\PYG{o}{.}\PYG{n}{conf}\PYG{o}{.}\PYG{n}{set}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{spark.sql.session.timeZone}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{UTC}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{k+kn}{from} \PYG{n+nn}{pyspark}\PYG{n+nn}{.}\PYG{n+nn}{sql}\PYG{n+nn}{.}\PYG{n+nn}{types} \PYG{k+kn}{import} \PYG{n}{DateType}
\PYG{n}{spark\PYGZus{}df}\PYG{o}{.}\PYG{n}{withColumn}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{date}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{F}\PYG{o}{.}\PYG{n}{from\PYGZus{}unixtime}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ts}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)} \PYG{c+c1}{\PYGZsh{}.cast(DateType())}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{:: Comparison:}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
                                                \PYG{o}{|}  \PYG{n}{A}\PYG{o}{|}        \PYG{n}{ts}\PYG{o}{|}               \PYG{n}{date}\PYG{o}{|}
   \PYG{n}{A}          \PYG{n}{ts}                  \PYG{n}{datetime}      \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\PYG{l+m+mi}{0}  \PYG{n}{a}  \PYG{l+m+mi}{1284101485} \PYG{l+m+mi}{2010}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{09}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10} \PYG{l+m+mi}{06}\PYG{p}{:}\PYG{l+m+mi}{51}\PYG{p}{:}\PYG{l+m+mi}{25}\PYG{o}{+}\PYG{l+m+mi}{00}\PYG{p}{:}\PYG{l+m+mi}{00}      \PYG{o}{|}  \PYG{n}{a}\PYG{o}{|}\PYG{l+m+mi}{1284101485}\PYG{o}{|}\PYG{l+m+mi}{2010}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{09}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{10} \PYG{l+m+mi}{06}\PYG{p}{:}\PYG{l+m+mi}{51}\PYG{p}{:}\PYG{l+m+mi}{25}\PYG{o}{|}
\PYG{l+m+mi}{1}  \PYG{n}{b}  \PYG{l+m+mi}{2284101485} \PYG{l+m+mi}{2042}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{05}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{19} \PYG{l+m+mi}{08}\PYG{p}{:}\PYG{l+m+mi}{38}\PYG{p}{:}\PYG{l+m+mi}{05}\PYG{o}{+}\PYG{l+m+mi}{00}\PYG{p}{:}\PYG{l+m+mi}{00}      \PYG{o}{|}  \PYG{n}{b}\PYG{o}{|}\PYG{l+m+mi}{2284101485}\PYG{o}{|}\PYG{l+m+mi}{2042}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{05}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{19} \PYG{l+m+mi}{08}\PYG{p}{:}\PYG{l+m+mi}{38}\PYG{p}{:}\PYG{l+m+mi}{05}\PYG{o}{|}
\PYG{l+m+mi}{2}  \PYG{n}{c}  \PYG{l+m+mi}{3284101485} \PYG{l+m+mi}{2074}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{25} \PYG{l+m+mi}{10}\PYG{p}{:}\PYG{l+m+mi}{24}\PYG{p}{:}\PYG{l+m+mi}{45}\PYG{o}{+}\PYG{l+m+mi}{00}\PYG{p}{:}\PYG{l+m+mi}{00}      \PYG{o}{|}  \PYG{n}{c}\PYG{o}{|}\PYG{l+m+mi}{3284101485}\PYG{o}{|}\PYG{l+m+mi}{2074}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{01}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{25} \PYG{l+m+mi}{10}\PYG{p}{:}\PYG{l+m+mi}{24}\PYG{p}{:}\PYG{l+m+mi}{45}\PYG{o}{|}
                                                \PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{o}{+}
\end{sphinxVerbatim}


\chapter{\sphinxstyleliteralintitle{\sphinxupquote{pd.DataFrame}} manipulation}
\label{\detokenize{pd:pd-dataframe-manipulation}}\label{\detokenize{pd:pd}}\label{\detokenize{pd::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This Chapter {\hyperref[\detokenize{nb:nb}]{\sphinxcrossref{\DUrole{std,std-ref}{Notebooks}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming
experience, you may skip this chapter.
\end{sphinxadmonition}


\section{TODO..}
\label{\detokenize{pd:todo}}

\chapter{\sphinxstyleliteralintitle{\sphinxupquote{rdd.DataFrame}} manipulation}
\label{\detokenize{rdd:rdd-dataframe-manipulation}}\label{\detokenize{rdd:rdd}}\label{\detokenize{rdd::doc}}
\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
This Chapter {\hyperref[\detokenize{nb:nb}]{\sphinxcrossref{\DUrole{std,std-ref}{Notebooks}}}} is for beginner.  If you have some \sphinxcode{\sphinxupquote{Python}} programming experience, you may skip this chapter.
\end{sphinxadmonition}


\section{TODO..}
\label{\detokenize{rdd:todo}}

\chapter{Online Courses and Useful Websites}
\label{\detokenize{kaggle:online-courses-and-useful-websites}}\label{\detokenize{kaggle:kaggle}}\label{\detokenize{kaggle::doc}}
\begin{sphinxadmonition}{note}{Chinese proverb}

\sphinxAtStartPar
practice makes perfect.
\end{sphinxadmonition}


\section{Recommended online courses}
\label{\detokenize{kaggle:recommended-online-courses}}
\sphinxAtStartPar
Here is the list of recommended open source DS courses.


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description (Level)
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Link
\\
\hline
\sphinxAtStartPar
Harvard CS 109a
&
\sphinxAtStartPar
Intro to Data Science (Easy)
&
\sphinxAtStartPar
\sphinxurl{https://harvard-iacs.github.io/2021-CS109A/}
\\
\hline
\sphinxAtStartPar
NYU DS\sphinxhyphen{}GA 1003
&
\sphinxAtStartPar
Machine Learning (Intermediate)
&
\sphinxAtStartPar
\sphinxurl{https://nyu-ds1003.github.io/spring2021/}
\\
\hline
\sphinxAtStartPar
UC Berkeley
&
\sphinxAtStartPar
Full Stack Deep Learning (Advanced)
&
\sphinxAtStartPar
\sphinxurl{https://fullstackdeeplearning.com/}
\\
\hline
\sphinxAtStartPar
Stanford CS 224N
&
\sphinxAtStartPar
Natural Language Processing with Deep Learning (Advanced)
&
\sphinxAtStartPar
\sphinxurl{http://web.stanford.edu/class/cs224n/}
\\
\hline
\sphinxAtStartPar
Harvard AC215
&
\sphinxAtStartPar
Advanced practical data science, MLOps. (Advanced)
&
\sphinxAtStartPar
\sphinxurl{https://harvard-iacs.github.io/2021-AC215/}
\\
\hline
\sphinxAtStartPar
Stanford CS 329S
&
\sphinxAtStartPar
Machine Learning Systems Design (Advanced)
&
\sphinxAtStartPar
\sphinxurl{https://stanford-cs329s.github.io/}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Recommended Online Resources}
\label{\detokenize{kaggle:recommended-online-resources}}

\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Link
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Description
\\
\hline
\sphinxAtStartPar
\sphinxurl{https://pythontutor.com/}
&
\sphinxAtStartPar
Visualize Code Execution
\\
\hline
\sphinxAtStartPar
\sphinxurl{https://visualgo.net/en}
&
\sphinxAtStartPar
Visualising data structures and algorithms through animation
\\
\hline
\sphinxAtStartPar
\sphinxurl{https://jalammar.github.io/}
&
\sphinxAtStartPar
Jay’s Visualizing machine learning concept
\\
\hline
\sphinxAtStartPar
\sphinxurl{https://explained.ai/}
&
\sphinxAtStartPar
Deep explanations of machine learning and related topics.
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\section{Free Online E\sphinxhyphen{}books}
\label{\detokenize{kaggle:free-online-e-books}}

\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline
\sphinxstyletheadfamily 
\sphinxAtStartPar
Book Name
&\sphinxstyletheadfamily 
\sphinxAtStartPar
Link
\\
\hline
\sphinxAtStartPar
The Hitchhiker’s Guide to Python
&
\sphinxAtStartPar
\sphinxurl{https://docs.python-guide.org/}
\\
\hline
\sphinxAtStartPar
Python Programming And Numerical Methods
&
\sphinxAtStartPar
\sphinxurl{https://pythonnumericalmethods.berkeley.edu/}
\\
\hline
\sphinxAtStartPar
Python for Everybody
&
\sphinxAtStartPar
\sphinxurl{https://www.py4e.com/lessons}
\\
\hline
\sphinxAtStartPar
Python Data Science Handbook
&
\sphinxAtStartPar
\sphinxurl{https://jakevdp.github.io/PythonDataScienceHandbook/}
\\
\hline
\sphinxAtStartPar
Introduction to Machine Learning with Python
&
\sphinxAtStartPar
\sphinxurl{https://github.com/amueller/introduction\_to\_ml\_with\_python}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\chapter{Package Wrapper}
\label{\detokenize{pack:package-wrapper}}\label{\detokenize{pack:pack}}\label{\detokenize{pack::doc}}
\sphinxAtStartPar
It’s super easy to wrap your own package in Python. I packed some functions which I frequently
used in my daily work. You can download and install it from \sphinxhref{https://runawayhorse001.github.io/statspy/}{My statspy library}. The hierarchical
structure and the directory structure of this package are as follows.


\section{Hierarchical Structure}
\label{\detokenize{pack:hierarchical-structure}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
├── README.md
├── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
├── requirements.txt
├── setup.py
├── statspy
│   ├── \PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}.py
│   ├── basics.py
│   └── tests.py
└── \PYG{n+nb}{test}
    ├── nb
    │   └── t.test.ipynb
    └── test1.py

\PYG{l+m}{3} directories, \PYG{l+m}{9} files
\end{sphinxVerbatim}

\sphinxAtStartPar
From the above hierarchical structure, you will find that you have to have \sphinxcode{\sphinxupquote{\_\_init\_\_.py}} in each directory. I will explain the \sphinxcode{\sphinxupquote{\_\_init\_\_.py}} file with the example below:


\section{Set Up}
\label{\detokenize{pack:set-up}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{setuptools} \PYG{k+kn}{import} \PYG{n}{setup}\PYG{p}{,} \PYG{n}{find\PYGZus{}packages}

\PYG{k}{try}\PYG{p}{:}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{README.md}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
        \PYG{n}{long\PYGZus{}description} \PYG{o}{=} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{except} \PYG{n+ne}{IOError}\PYG{p}{:}
    \PYG{n}{long\PYGZus{}description} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{k}{try}\PYG{p}{:}
    \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{requirements.txt}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{f}\PYG{p}{:}
        \PYG{n}{requirements} \PYG{o}{=} \PYG{p}{[}\PYG{n}{x}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)} \PYG{k}{for} \PYG{n}{x} \PYG{o+ow}{in} \PYG{n}{f}\PYG{o}{.}\PYG{n}{read}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{splitlines}\PYG{p}{(}\PYG{p}{)} \PYG{k}{if} \PYG{n}{x}\PYG{o}{.}\PYG{n}{strip}\PYG{p}{(}\PYG{p}{)}\PYG{p}{]}
\PYG{k}{except} \PYG{n+ne}{IOError}\PYG{p}{:}
    \PYG{n}{requirements} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

\PYG{n}{setup}\PYG{p}{(}\PYG{n}{name}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{statspy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{install\PYGZus{}requires}\PYG{o}{=}\PYG{n}{requirements}\PYG{p}{,}
      \PYG{n}{version}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{description}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Statistics python library}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{author}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Wenqiang Feng}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{author\PYGZus{}email}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{von198@gmail.com}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{license}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{MIT}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
      \PYG{n}{url}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{git@github.com:runawayhorse001/statspy.git}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
      \PYG{n}{packages}\PYG{o}{=}\PYG{n}{find\PYGZus{}packages}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
      \PYG{n}{long\PYGZus{}description}\PYG{o}{=}\PYG{n}{long\PYGZus{}description}\PYG{p}{,}
      \PYG{n}{long\PYGZus{}description\PYGZus{}content\PYGZus{}type}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{text/markdown}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
      \PYG{n}{classifiers}\PYG{o}{=}\PYG{p}{[}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{License :: OSI Approved :: MIT License}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Programming Language :: Python}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Programming Language :: Python :: 2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
        \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Programming Language :: Python :: 3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
      \PYG{p}{]}\PYG{p}{,}
      \PYG{n}{include\PYGZus{}package\PYGZus{}data}\PYG{o}{=}\PYG{k+kc}{True}
     \PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
If you want to compile the \sphinxcode{\sphinxupquote{conda}} package, you can add the following
code in your \sphinxcode{\sphinxupquote{setup.py}}:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
import \sphinxcode{\sphinxupquote{import distutils.command.bdist\_conda}}:

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{distutils}\PYG{n+nn}{.}\PYG{n+nn}{command}\PYG{n+nn}{.}\PYG{n+nn}{bdist\PYGZus{}conda}
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
\sphinxAtStartPar
pass the options to setup():

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{distclass}\PYG{o}{=}\PYG{n}{distutils}\PYG{o}{.}\PYG{n}{command}\PYG{o}{.}\PYG{n}{bdist\PYGZus{}conda}\PYG{o}{.}\PYG{n}{CondaDistribution}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} eg}
\PYG{n}{setup}\PYG{p}{(}
\PYG{n}{name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{conda\PYGZus{}example}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
\PYG{n}{version}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{1.0}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
\PYG{n}{distclass}\PYG{o}{=}\PYG{n}{distutils}\PYG{o}{.}\PYG{n}{command}\PYG{o}{.}\PYG{n}{bdist\PYGZus{}conda}\PYG{o}{.}\PYG{n}{CondaDistribution}\PYG{p}{,}
\PYG{n}{conda\PYGZus{}buildnum}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
Then, you can use the following code in terminal to compile the conda
package:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{python} \PYG{n}{setup}\PYG{o}{.}\PYG{n}{py} \PYG{n}{bdist\PYGZus{}conda}
\end{sphinxVerbatim}
\end{sphinxadmonition}


\section{Requirements}
\label{\detokenize{pack:requirements}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
pandas
numpy
scipy
patsy
matplotlib
\end{sphinxVerbatim}


\section{ReadMe}
\label{\detokenize{pack:readme}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} StatsPy}

This is my statistics python library repositories.
The \PYG{l+s+sb}{`}\PYG{l+s+sb}{`}API\PYG{l+s+sb}{`}\PYG{l+s+sb}{`} can be found at: https://runawayhorse001.github.io/statspy.
If you want to colne and install it, you can use

\PYGZhy{} clone

\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
git clone git@github.com:runawayhorse001/statspy.git
\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}
\PYGZhy{} install

\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
\PYG{n+nb}{cd} statspy
pip install \PYGZhy{}r requirements.txt
python setup.py install
\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}
\PYGZhy{} uninstall

\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
pip uninstall statspy
\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}

\PYGZhy{} \PYG{n+nb}{test}

\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{o}{\PYGZob{}}bash\PYG{o}{\PYGZcb{}}
\PYG{n+nb}{cd} statspy/test
python test1.py
\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}\PYG{l+s+sb}{`}
\end{sphinxVerbatim}


\chapter{Publish Package to PyPI}
\label{\detokenize{pypi:publish-package-to-pypi}}\label{\detokenize{pypi:pypi}}\label{\detokenize{pypi::doc}}
\sphinxAtStartPar
In this chapter, you’ll learn how to upload your own package to PyPI.


\section{Register PyPI account}
\label{\detokenize{pypi:register-pypi-account}}
\sphinxAtStartPar
If you do not have a PyPI accout, you need to register an account at \sphinxurl{https://pypi.org/account/register} .


\section{Install \sphinxstyleliteralintitle{\sphinxupquote{twine}}}
\label{\detokenize{pypi:install-twine}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip install twine
\end{sphinxVerbatim}


\section{Build Your Package}
\label{\detokenize{pypi:build-your-package}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{python} \PYG{n}{setup}\PYG{o}{.}\PYG{n}{py} \PYG{n}{sdist} \PYG{n}{bdist\PYGZus{}wheel}
\end{sphinxVerbatim}

\sphinxAtStartPar
Then you will get a new folder \sphinxcode{\sphinxupquote{dist}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
.
├── PyAudit\PYGZhy{}1.0\PYGZhy{}py3\PYGZhy{}none\PYGZhy{}any.whl
├── PyAudit\PYGZhy{}1.0\PYGZhy{}py3.6.egg
└── PyAudit\PYGZhy{}1.0.tar.gz
\end{sphinxVerbatim}


\section{Upload Your Package}
\label{\detokenize{pypi:upload-your-package}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
twine upload dist/*
\end{sphinxVerbatim}

\sphinxAtStartPar
During the uploading processing, you need to provide your PyPI account \sphinxcode{\sphinxupquote{username}} and \sphinxcode{\sphinxupquote{password}}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
Enter your username: runawayhorse001
Enter your password:
\end{sphinxVerbatim}


\section{Package at PyPI}
\label{\detokenize{pypi:package-at-pypi}}
\sphinxAtStartPar
Here is my \sphinxcode{\sphinxupquote{PyAudit}} package at {[}PyPI{]}(\sphinxurl{https://pypi.org/project/PyAudit}). You can install \sphinxcode{\sphinxupquote{PyAudit}} using:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip install PyAudit
\end{sphinxVerbatim}


\chapter{Model Deployment with Flask}
\label{\detokenize{deploy:model-deployment-with-flask}}\label{\detokenize{deploy:deploy}}\label{\detokenize{deploy::doc}}
\sphinxAtStartPar
In this chapter, you’ll learn how to deployment your model with \sphinxcode{\sphinxupquote{flask}}. The main idea and code (I made some essential modification to make it work for Python 3) are from the Git repo:https://github.com/llSourcell/how\_to\_deploy\_a\_keras\_model\_to\_production. So the copyright belongs to the original author.


\section{Install \sphinxstyleliteralintitle{\sphinxupquote{flask}}}
\label{\detokenize{deploy:install-flask}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip install Flask
\end{sphinxVerbatim}


\section{Train and Save your model}
\label{\detokenize{deploy:train-and-save-your-model}}
\sphinxAtStartPar
You can use the following code to train and save your \sphinxcode{\sphinxupquote{CNN}} model:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}python 2/3 compatibility}
\PYG{k+kn}{from} \PYG{n+nn}{\PYGZus{}\PYGZus{}future\PYGZus{}\PYGZus{}} \PYG{k+kn}{import} \PYG{n}{print\PYGZus{}function}
\PYG{c+c1}{\PYGZsh{}simplified interface for building models}
\PYG{k+kn}{import} \PYG{n+nn}{keras}
\PYG{c+c1}{\PYGZsh{}our handwritten character labeled dataset}
\PYG{k+kn}{from} \PYG{n+nn}{keras}\PYG{n+nn}{.}\PYG{n+nn}{datasets} \PYG{k+kn}{import} \PYG{n}{mnist}
\PYG{c+c1}{\PYGZsh{}because our models are simple}
\PYG{k+kn}{from} \PYG{n+nn}{keras}\PYG{n+nn}{.}\PYG{n+nn}{models} \PYG{k+kn}{import} \PYG{n}{Sequential}
\PYG{c+c1}{\PYGZsh{}dense means fully connected layers, dropout is a technique to improve convergence, flatten to reshape our matrices for feeding}
\PYG{c+c1}{\PYGZsh{}into respective layers}
\PYG{k+kn}{from} \PYG{n+nn}{keras}\PYG{n+nn}{.}\PYG{n+nn}{layers} \PYG{k+kn}{import} \PYG{n}{Dense}\PYG{p}{,} \PYG{n}{Dropout}\PYG{p}{,} \PYG{n}{Flatten}
\PYG{c+c1}{\PYGZsh{}for convolution (images) and pooling is a technique to help choose the most relevant features in an image}
\PYG{k+kn}{from} \PYG{n+nn}{keras}\PYG{n+nn}{.}\PYG{n+nn}{layers} \PYG{k+kn}{import} \PYG{n}{Conv2D}\PYG{p}{,} \PYG{n}{MaxPooling2D}
\PYG{k+kn}{from} \PYG{n+nn}{keras} \PYG{k+kn}{import} \PYG{n}{backend} \PYG{k}{as} \PYG{n}{K}


\PYG{c+c1}{\PYGZsh{}mini batch gradient descent ftw}
\PYG{n}{batch\PYGZus{}size} \PYG{o}{=} \PYG{l+m+mi}{128}
\PYG{c+c1}{\PYGZsh{}10 difference characters}
\PYG{n}{num\PYGZus{}classes} \PYG{o}{=} \PYG{l+m+mi}{10}
\PYG{c+c1}{\PYGZsh{}very short training time}
\PYG{n}{epochs} \PYG{o}{=} \PYG{l+m+mi}{12}

\PYG{c+c1}{\PYGZsh{}input image dimensions}
\PYG{c+c1}{\PYGZsh{}28x28 pixel images.}
\PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols} \PYG{o}{=} \PYG{l+m+mi}{28}\PYG{p}{,} \PYG{l+m+mi}{28}

\PYG{c+c1}{\PYGZsh{}the data downloaded, shuffled and split between train and test sets}
\PYG{c+c1}{\PYGZsh{}if only all datasets were this easy to import and format}
\PYG{p}{(}\PYG{n}{x\PYGZus{}train}\PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{)}\PYG{p}{,} \PYG{p}{(}\PYG{n}{x\PYGZus{}test}\PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{)} \PYG{o}{=} \PYG{n}{mnist}\PYG{o}{.}\PYG{n}{load\PYGZus{}data}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}this assumes our data format}
\PYG{c+c1}{\PYGZsh{}For 3D data, \PYGZdq{}channels\PYGZus{}last\PYGZdq{} assumes (conv\PYGZus{}dim1, conv\PYGZus{}dim2, conv\PYGZus{}dim3, channels) while}
\PYG{c+c1}{\PYGZsh{}\PYGZdq{}channels\PYGZus{}first\PYGZdq{} assumes (channels, conv\PYGZus{}dim1, conv\PYGZus{}dim2, conv\PYGZus{}dim3).}
\PYG{k}{if} \PYG{n}{K}\PYG{o}{.}\PYG{n}{image\PYGZus{}data\PYGZus{}format}\PYG{p}{(}\PYG{p}{)} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{channels\PYGZus{}first}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{x\PYGZus{}train} \PYG{o}{=} \PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}test} \PYG{o}{=} \PYG{n}{x\PYGZus{}test}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{x\PYGZus{}test}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols}\PYG{p}{)}
    \PYG{n}{input\PYGZus{}shape} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols}\PYG{p}{)}
\PYG{k}{else}\PYG{p}{:}
    \PYG{n}{x\PYGZus{}train} \PYG{o}{=} \PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{x\PYGZus{}test} \PYG{o}{=} \PYG{n}{x\PYGZus{}test}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{x\PYGZus{}test}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
    \PYG{n}{input\PYGZus{}shape} \PYG{o}{=} \PYG{p}{(}\PYG{n}{img\PYGZus{}rows}\PYG{p}{,} \PYG{n}{img\PYGZus{}cols}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}more reshaping}
\PYG{n}{x\PYGZus{}train} \PYG{o}{=} \PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{float32}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{x\PYGZus{}test} \PYG{o}{=} \PYG{n}{x\PYGZus{}test}\PYG{o}{.}\PYG{n}{astype}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{float32}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{x\PYGZus{}train} \PYG{o}{/}\PYG{o}{=} \PYG{l+m+mi}{255}
\PYG{n}{x\PYGZus{}test} \PYG{o}{/}\PYG{o}{=} \PYG{l+m+mi}{255}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x\PYGZus{}train shape:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{x\PYGZus{}train}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{train samples}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{x\PYGZus{}test}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test samples}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}convert class vectors to binary class matrices}
\PYG{n}{y\PYGZus{}train} \PYG{o}{=} \PYG{n}{keras}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{to\PYGZus{}categorical}\PYG{p}{(}\PYG{n}{y\PYGZus{}train}\PYG{p}{,} \PYG{n}{num\PYGZus{}classes}\PYG{p}{)}
\PYG{n}{y\PYGZus{}test} \PYG{o}{=} \PYG{n}{keras}\PYG{o}{.}\PYG{n}{utils}\PYG{o}{.}\PYG{n}{to\PYGZus{}categorical}\PYG{p}{(}\PYG{n}{y\PYGZus{}test}\PYG{p}{,} \PYG{n}{num\PYGZus{}classes}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}build our model}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{Sequential}\PYG{p}{(}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}convolutional layer with rectified linear unit activation}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Conv2D}\PYG{p}{(}\PYG{l+m+mi}{32}\PYG{p}{,} \PYG{n}{kernel\PYGZus{}size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,}
                 \PYG{n}{activation}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{relu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
                 \PYG{n}{input\PYGZus{}shape}\PYG{o}{=}\PYG{n}{input\PYGZus{}shape}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}again}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Conv2D}\PYG{p}{(}\PYG{l+m+mi}{64}\PYG{p}{,} \PYG{p}{(}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{)}\PYG{p}{,} \PYG{n}{activation}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{relu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}choose the best features via pooling}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{MaxPooling2D}\PYG{p}{(}\PYG{n}{pool\PYGZus{}size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}randomly turn neurons on and off to improve convergence}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Dropout}\PYG{p}{(}\PYG{l+m+mf}{0.25}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}flatten since too many dimensions, we only want a classification output}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Flatten}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}fully connected to get all relevant data}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Dense}\PYG{p}{(}\PYG{l+m+mi}{128}\PYG{p}{,} \PYG{n}{activation}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{relu}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}one more dropout for convergence\PYGZsq{} sake :)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Dropout}\PYG{p}{(}\PYG{l+m+mf}{0.5}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}output a softmax to squash the matrix into output probabilities}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{add}\PYG{p}{(}\PYG{n}{Dense}\PYG{p}{(}\PYG{n}{num\PYGZus{}classes}\PYG{p}{,} \PYG{n}{activation}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{softmax}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}Adaptive learning rate (adaDelta) is a popular form of gradient descent rivaled only by adam and adagrad}
\PYG{c+c1}{\PYGZsh{}categorical ce since we have multiple classes (10)}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{compile}\PYG{p}{(}\PYG{n}{loss}\PYG{o}{=}\PYG{n}{keras}\PYG{o}{.}\PYG{n}{losses}\PYG{o}{.}\PYG{n}{categorical\PYGZus{}crossentropy}\PYG{p}{,}
              \PYG{n}{optimizer}\PYG{o}{=}\PYG{n}{keras}\PYG{o}{.}\PYG{n}{optimizers}\PYG{o}{.}\PYG{n}{Adadelta}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,}
              \PYG{n}{metrics}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{accuracy}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}train}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{x\PYGZus{}train}\PYG{p}{,} \PYG{n}{y\PYGZus{}train}\PYG{p}{,}
          \PYG{n}{batch\PYGZus{}size}\PYG{o}{=}\PYG{n}{batch\PYGZus{}size}\PYG{p}{,}
          \PYG{n}{epochs}\PYG{o}{=}\PYG{n}{epochs}\PYG{p}{,}
          \PYG{n}{verbose}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,}
          \PYG{n}{validation\PYGZus{}data}\PYG{o}{=}\PYG{p}{(}\PYG{n}{x\PYGZus{}test}\PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{)}\PYG{p}{)}
 \PYG{c+c1}{\PYGZsh{}how well did it do?}
\PYG{n}{score} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{evaluate}\PYG{p}{(}\PYG{n}{x\PYGZus{}test}\PYG{p}{,} \PYG{n}{y\PYGZus{}test}\PYG{p}{,} \PYG{n}{verbose}\PYG{o}{=}\PYG{l+m+mi}{0}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Test loss:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{score}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Test accuracy:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{score}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}Save the model}
\PYG{c+c1}{\PYGZsh{} serialize model to JSON}
\PYG{n}{model\PYGZus{}json} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{to\PYGZus{}json}\PYG{p}{(}\PYG{p}{)}
\PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model.json}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{w}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{json\PYGZus{}file}\PYG{p}{:}
    \PYG{n}{json\PYGZus{}file}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{n}{model\PYGZus{}json}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} serialize weights to HDF5}
\PYG{n}{model}\PYG{o}{.}\PYG{n}{save\PYGZus{}weights}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model.h5}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Saved model to disk}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Deplyment with Flask}
\label{\detokenize{deploy:deplyment-with-flask}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}our web app framework!}

\PYG{c+c1}{\PYGZsh{}you could also generate a skeleton from scratch via}
\PYG{c+c1}{\PYGZsh{}http://flask\PYGZhy{}appbuilder.readthedocs.io/en/latest/installation.html}

\PYG{c+c1}{\PYGZsh{}Generating HTML from within Python is not fun, and actually pretty cumbersome because you have to do the}
\PYG{c+c1}{\PYGZsh{}HTML escaping on your own to keep the application secure. Because of that Flask configures the Jinja2 template engine}
\PYG{c+c1}{\PYGZsh{}for you automatically.}
\PYG{c+c1}{\PYGZsh{}requests are objects that flask handles (get set post, etc)}
\PYG{k+kn}{from} \PYG{n+nn}{flask} \PYG{k+kn}{import} \PYG{n}{Flask}\PYG{p}{,} \PYG{n}{render\PYGZus{}template}\PYG{p}{,}\PYG{n}{request}
\PYG{c+c1}{\PYGZsh{}scientific computing library for saving, reading, and resizing images}
\PYG{c+c1}{\PYGZsh{}from scipy.misc import imsave, imread, imresize}
\PYG{c+c1}{\PYGZsh{} import cv2 library for saving, reading, and resizing images}
\PYG{k+kn}{import} \PYG{n+nn}{cv2}
\PYG{c+c1}{\PYGZsh{}for matrix math}
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
\PYG{c+c1}{\PYGZsh{}for importing our keras model}
\PYG{k+kn}{import} \PYG{n+nn}{keras}\PYG{n+nn}{.}\PYG{n+nn}{models}
\PYG{c+c1}{\PYGZsh{}for regular expressions, saves time dealing with string data}
\PYG{k+kn}{import} \PYG{n+nn}{re}
\PYG{c+c1}{\PYGZsh{} for convert base64 string to image}
\PYG{k+kn}{import} \PYG{n+nn}{base64}

\PYG{c+c1}{\PYGZsh{}system level operations (like loading files)}
\PYG{k+kn}{import} \PYG{n+nn}{sys}
\PYG{c+c1}{\PYGZsh{}for reading operating system data}
\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{c+c1}{\PYGZsh{}tell our app where our saved model is}
\PYG{n}{sys}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{abspath}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./model}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{k+kn}{from} \PYG{n+nn}{load} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{c+c1}{\PYGZsh{}initalize our flask app}
\PYG{n}{app} \PYG{o}{=} \PYG{n}{Flask}\PYG{p}{(}\PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}global vars for easy reusability}
\PYG{k}{global} \PYG{n}{model}\PYG{p}{,} \PYG{n}{graph}
\PYG{c+c1}{\PYGZsh{}initialize these variables}
\PYG{n}{model}\PYG{p}{,} \PYG{n}{graph} \PYG{o}{=} \PYG{n}{init}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}decoding an image from base64 into raw representation}
\PYG{k}{def} \PYG{n+nf}{convertImage}\PYG{p}{(}\PYG{n}{imgData1}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{imgData1} \PYG{o}{=} \PYG{n}{imgData1}\PYG{o}{.}\PYG{n}{decode}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{utf\PYGZhy{}8}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{n}{imgstr} \PYG{o}{=} \PYG{n}{re}\PYG{o}{.}\PYG{n}{search}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{base64,(.*)}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{imgData1}\PYG{p}{)}\PYG{o}{.}\PYG{n}{group}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}print(imgstr)}
        \PYG{n}{imgstr\PYGZus{}64} \PYG{o}{=} \PYG{n}{base64}\PYG{o}{.}\PYG{n}{b64decode}\PYG{p}{(}\PYG{n}{imgstr}\PYG{p}{)}
        \PYG{k}{with} \PYG{n+nb}{open}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output/output.png}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{wb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{k}{as} \PYG{n}{output}\PYG{p}{:}
                \PYG{n}{output}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{n}{imgstr\PYGZus{}64}\PYG{p}{)}


\PYG{n+nd}{@app}\PYG{o}{.}\PYG{n}{route}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{index}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{}initModel()}
        \PYG{c+c1}{\PYGZsh{}render out pre\PYGZhy{}built HTML file right on the index page}
        \PYG{k}{return} \PYG{n}{render\PYGZus{}template}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{index.html}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{n+nd}{@app}\PYG{o}{.}\PYG{n}{route}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/predict/}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{methods}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{GET}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{POST}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{)}
\PYG{k}{def} \PYG{n+nf}{predict}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{}whenever the predict method is called, we\PYGZsq{}re going}
        \PYG{c+c1}{\PYGZsh{}to input the user drawn character as an image into the model}
        \PYG{c+c1}{\PYGZsh{}perform inference, and return the classification}
        \PYG{c+c1}{\PYGZsh{}get the raw data format of the image}
        \PYG{n}{imgData} \PYG{o}{=} \PYG{n}{request}\PYG{o}{.}\PYG{n}{get\PYGZus{}data}\PYG{p}{(}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}print(imgData)}
        \PYG{c+c1}{\PYGZsh{}encode it into a suitable format}
        \PYG{n}{convertImage}\PYG{p}{(}\PYG{n}{imgData}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{debug}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}read the image into memory}
        \PYG{n}{x} \PYG{o}{=} \PYG{n}{cv2}\PYG{o}{.}\PYG{n}{imread}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{output/output.png}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+m+mi}{0}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}compute a bit\PYGZhy{}wise inversion so black becomes white and vice versa}
        \PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{invert}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}make it the right size}
        \PYG{n}{x} \PYG{o}{=} \PYG{n}{cv2}\PYG{o}{.}\PYG{n}{resize}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{p}{(}\PYG{l+m+mi}{28}\PYG{p}{,}\PYG{l+m+mi}{28}\PYG{p}{)}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}imshow(x)}
        \PYG{c+c1}{\PYGZsh{}convert to a 4D tensor to feed into our model}
        \PYG{n}{x} \PYG{o}{=} \PYG{n}{x}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{l+m+mi}{28}\PYG{p}{,}\PYG{l+m+mi}{28}\PYG{p}{,}\PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{debug2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}in our computation graph}
        \PYG{k}{with} \PYG{n}{graph}\PYG{o}{.}\PYG{n}{as\PYGZus{}default}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
                \PYG{c+c1}{\PYGZsh{}perform the prediction}
                \PYG{n}{out} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{predict}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)}
                \PYG{c+c1}{\PYGZsh{}print(out)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{argmax}\PYG{p}{(}\PYG{n}{out}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
                \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{debug3}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
                \PYG{c+c1}{\PYGZsh{}convert the response to a string}
                \PYG{n}{response} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array\PYGZus{}str}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{argmax}\PYG{p}{(}\PYG{n}{out}\PYG{p}{,}\PYG{n}{axis}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}
                \PYG{k}{return} \PYG{n}{response}


\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{}decide what port to run the app in}
        \PYG{n}{port} \PYG{o}{=} \PYG{n+nb}{int}\PYG{p}{(}\PYG{n}{os}\PYG{o}{.}\PYG{n}{environ}\PYG{o}{.}\PYG{n}{get}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PORT}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+m+mi}{5000}\PYG{p}{)}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}run the app locally on the givn port}
        \PYG{n}{app}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{host}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{0.0.0.0}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{port}\PYG{o}{=}\PYG{n}{port}\PYG{p}{)}
        \PYG{c+c1}{\PYGZsh{}optional if we want to run in debugging mode}
        \PYG{c+c1}{\PYGZsh{}app.run(debug=False)}
\end{sphinxVerbatim}


\section{Lunch your app on server}
\label{\detokenize{deploy:lunch-your-app-on-server}}

\subsection{1. Lunch the APP}
\label{\detokenize{deploy:lunch-the-app}}
\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{python} \PYG{n}{app}\PYG{o}{.}\PYG{n}{py}
\end{sphinxVerbatim}


\subsection{2. Run the APP}
\label{\detokenize{deploy:run-the-app}}
\sphinxAtStartPar
Open the browser with: \sphinxurl{http://0.0.0.0:5000}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{cnn}.png}
\end{figure}


\chapter{API Book}
\label{\detokenize{api:api-book}}\label{\detokenize{api:api}}\label{\detokenize{api::doc}}
\sphinxAtStartPar
If you developed an amazing library or tool, you need to teach the users how to use it. Now a \sphinxcode{\sphinxupquote{API}} book is necessary and a good \sphinxcode{\sphinxupquote{API}} book will save a lot of time for the users. The Sphinx provides an awesome auto \sphinxcode{\sphinxupquote{API}} book generator. The followings are my statistics python library: \sphinxcode{\sphinxupquote{statspy}} API demo book:


\section{Basics Module}
\label{\detokenize{api:basics-module}}

\subsection{\sphinxstyleliteralintitle{\sphinxupquote{rnorm}}}
\label{\detokenize{api:module-statspy.basics}}\label{\detokenize{api:rnorm}}\index{module@\spxentry{module}!statspy.basics@\spxentry{statspy.basics}}\index{statspy.basics@\spxentry{statspy.basics}!module@\spxentry{module}}\index{rnorm() (in module statspy.basics)@\spxentry{rnorm()}\spxextra{in module statspy.basics}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:statspy.basics.rnorm}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{statspy.basics.}}\sphinxbfcode{\sphinxupquote{rnorm}}}{\emph{\DUrole{n}{n}}, \emph{\DUrole{n}{mean}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{sd}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
\sphinxAtStartPar
Random generation for the normal distribution with mean
equal to mean and standard deviation equation to sd
same functions as rnorm in r: \sphinxcode{\sphinxupquote{rnorm(n, mean=0, sd=1)}}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n}} \textendash{} the number of the observations

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mean}} \textendash{} vector of means

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sd}} \textendash{} vector of standard deviations

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
the vector of the random numbers

\item[{Author}] \leavevmode
\sphinxAtStartPar
Wenqiang Feng

\item[{Email}] \leavevmode
\sphinxAtStartPar
\sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}

\end{description}\end{quote}

\end{fulllineitems}



\subsection{\sphinxstyleliteralintitle{\sphinxupquote{dnorm}}}
\label{\detokenize{api:dnorm}}

\begin{fulllineitems}
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{statspy.basics.}}\sphinxbfcode{\sphinxupquote{dnorm}}}{\emph{\DUrole{n}{x}}, \emph{\DUrole{n}{mean}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{sd}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{log}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\sphinxAtStartPar
Density of the normal distribution with mean
equal to mean and standard deviation equation to sd
same functions as rnorm in r: \sphinxcode{\sphinxupquote{dnorm(x, mean=0, sd=1, log=FALSE)}}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} \textendash{} the vector od quantiles

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mean}} \textendash{} vector of means

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sd}} \textendash{} vector of standard deviations

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
the list of the density

\item[{Author}] \leavevmode
\sphinxAtStartPar
Wenqiang Feng

\item[{Email}] \leavevmode
\sphinxAtStartPar
\sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}

\end{description}\end{quote}

\end{fulllineitems}



\subsection{\sphinxstyleliteralintitle{\sphinxupquote{runif}}}
\label{\detokenize{api:runif}}

\begin{fulllineitems}
\pysiglinewithargsret{\sphinxcode{\sphinxupquote{statspy.basics.}}\sphinxbfcode{\sphinxupquote{runif}}}{\emph{\DUrole{n}{n}}, \emph{\DUrole{n}{min}\DUrole{o}{=}\DUrole{default_value}{0}}, \emph{\DUrole{n}{max}\DUrole{o}{=}\DUrole{default_value}{1}}}{}
\sphinxAtStartPar
Random generation from the uniform distribution
same functions as rnorm in r: \sphinxcode{\sphinxupquote{runif(n, min=0, max=1)}}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n}} \textendash{} the number of the observations

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{min}} \textendash{} the lower limit of the distribution

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max}} \textendash{} the upper limit of the distribution

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
the list of n uniform random numers

\item[{Author}] \leavevmode
\sphinxAtStartPar
Wenqiang Feng

\item[{Email}] \leavevmode
\sphinxAtStartPar
\sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}

\end{description}\end{quote}

\end{fulllineitems}



\section{Tests Module}
\label{\detokenize{api:tests-module}}

\subsection{\sphinxstyleliteralintitle{\sphinxupquote{T\sphinxhyphen{}test}}}
\label{\detokenize{api:module-statspy.tests}}\label{\detokenize{api:t-test}}\index{module@\spxentry{module}!statspy.tests@\spxentry{statspy.tests}}\index{statspy.tests@\spxentry{statspy.tests}!module@\spxentry{module}}\index{t\_test() (in module statspy.tests)@\spxentry{t\_test()}\spxextra{in module statspy.tests}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:statspy.tests.t_test}}\pysiglinewithargsret{\sphinxcode{\sphinxupquote{statspy.tests.}}\sphinxbfcode{\sphinxupquote{t\_test}}}{\emph{\DUrole{n}{x}}, \emph{\DUrole{n}{y}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{mu}\DUrole{o}{=}\DUrole{default_value}{0.0}}, \emph{\DUrole{n}{conf\_level}\DUrole{o}{=}\DUrole{default_value}{0.95}}}{}
\sphinxAtStartPar
Performs one and two sample t\sphinxhyphen{}tests on vectors of data.

\sphinxAtStartPar
same functions as t.test in r: \sphinxcode{\sphinxupquote{t.test(x, ...)}}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{t.test(x, y = NULL,}}
\begin{quote}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{alternative = c("two.sided", "less", "greater"),}}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{mu = 0, paired = FALSE, var.equal = FALSE,}}

\sphinxAtStartPar
\sphinxcode{\sphinxupquote{conf.level = 0.95, ...)}}
\end{quote}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} \textendash{} a (non\sphinxhyphen{}empty) numeric vector of data values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} \textendash{} an optional (non\sphinxhyphen{}empty) numeric vector of data values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mu}} \textendash{} vector of standard deviations.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{conf\_level}} \textendash{} confidence level of the interval.

\end{itemize}

\item[{Returns}] \leavevmode
\sphinxAtStartPar
the vector of the random numbers.

\item[{Author}] \leavevmode
\sphinxAtStartPar
Wenqiang Feng

\item[{Email}] \leavevmode
\sphinxAtStartPar
\sphinxhref{mailto:von198@gmail.com}{von198@gmail.com}

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Main Reference}
\label{\detokenize{reference:main-reference}}\label{\detokenize{reference:reference}}\label{\detokenize{reference::doc}}
\begin{sphinxthebibliography}{VanderPl}
\bibitem[VanderPlas2016]{reference:vanderplas2016}
\sphinxAtStartPar
Jake VanderPlas. \sphinxhref{https://tanthiamhuat.files.wordpress.com/2018/04/pythondatasciencehandbook.pdf}{Python Data Science Handbook: Essential Tools for Working with Data, 2016.}
\bibitem[McKinney2013]{reference:mckinney2013}
\sphinxAtStartPar
Wes McKinney. \sphinxhref{http://bedford-computing.co.uk/learning/wp-content/uploads/2015/10/Python-for-Data-Analysis.pdf}{Python for Data Analysis, 2013.}
\bibitem[Georg2018]{reference:georg2018}
\sphinxAtStartPar
Georg Brandl. \sphinxhref{https://media.readthedocs.org/pdf/sphinx/1.7/sphinx.pdf}{Sphinx Documentation, Release 1.7.10+, 2018.}
\end{sphinxthebibliography}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{s}
\item\relax\sphinxstyleindexentry{statspy.basics}\sphinxstyleindexpageref{api:\detokenize{module-statspy.basics}}
\item\relax\sphinxstyleindexentry{statspy.tests}\sphinxstyleindexpageref{api:\detokenize{module-statspy.tests}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}