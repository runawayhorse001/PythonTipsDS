<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. pd.DataFrame vs PySpark DataFrame &mdash; Python Tips for Data Scientist  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/fix_rtd.css" type="text/css" /><link rel="shortcut icon" href="_static/icon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="11. Kaggle Competitions" href="kaggle.html" />
    <link rel="prev" title="9. rdd.DataFrame manipulation" href="rdd.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Python Tips for Data Scientist<img src="_static/logo_h.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Python Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="nb.html">3. Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="confi.html">4. Confidential Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="primer.html">5. Primer Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="struct.html">6. Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="ingest.html">7. Data Read and Ingestion with DataBase</a></li>
<li class="toctree-l1"><a class="reference internal" href="pd.html">8. <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="rdd.html">9. <code class="docutils literal notranslate"><span class="pre">rdd.DataFrame</span></code> manipulation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">10. <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> vs <code class="docutils literal notranslate"><span class="pre">PySpark</span> <span class="pre">DataFrame</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#create-dataframe">10.1. Create DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#from-list">10.1.1. From List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#from-dict">10.1.2. From Dict</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#load-dataframe">10.2. Load DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#from-database">10.2.1. From DataBase</a></li>
<li class="toctree-l3"><a class="reference internal" href="#from-csv">10.2.2. From <code class="docutils literal notranslate"><span class="pre">.csv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#from-json">10.2.3. From <code class="docutils literal notranslate"><span class="pre">.json</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#first-n-rows">10.3. First <code class="docutils literal notranslate"><span class="pre">n</span></code> Rows</a></li>
<li class="toctree-l2"><a class="reference internal" href="#column-names">10.4. Column Names</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-types">10.5. Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#replace-data-types">10.6. Replace Data types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fill-null">10.7. Fill Null</a></li>
<li class="toctree-l2"><a class="reference internal" href="#replace-values">10.8. Replace Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rename-columns">10.9. Rename Columns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rename-all-columns">10.9.1. Rename all columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rename-one-or-more-columns">10.9.2. Rename one or more columns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#drop-columns">10.10. Drop Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filter">10.11. Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#with-new-column">10.12. With New Column</a></li>
<li class="toctree-l2"><a class="reference internal" href="#join">10.13. Join</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#left-join">10.13.1. Left Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="#right-join">10.13.2. Right Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inner-join">10.13.3. Inner Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="#full-join">10.13.4. Full Join</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#concat-columns">10.14. Concat Columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="#groupby">10.15. GroupBy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pivot">10.16. Pivot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unixtime-to-date">10.17. Unixtime to Date</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="kaggle.html">11. Kaggle Competitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pack.html">12. Package Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="pypi.html">13. Publish Package to PyPI</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">14. Model Deployment with Flask</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">15. API Book</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">16. Main Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Python Tips for Data Scientist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li><span class="section-number">10. </span><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> vs <code class="docutils literal notranslate"><span class="pre">PySpark</span> <span class="pre">DataFrame</span></code></li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/runawayhorse001/PythonTipsDS/blob/master/doc/pdrdd.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="pd-dataframe-vs-pyspark-dataframe">
<span id="pdrdd"></span><h1><span class="section-number">10. </span><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> vs <code class="docutils literal notranslate"><span class="pre">PySpark</span> <span class="pre">DataFrame</span></code><a class="headerlink" href="#pd-dataframe-vs-pyspark-dataframe" title="Permalink to this headline">¶</a></h1>
<div class="section" id="create-dataframe">
<h2><span class="section-number">10.1. </span>Create DataFrame<a class="headerlink" href="#create-dataframe" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-list">
<h3><span class="section-number">10.1.1. </span>From List<a class="headerlink" href="#from-list" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># caution for the columns=</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span> <span class="n">col_name</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">col_name</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                  <span class="o">+---+---+---+</span>
                  <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>  <span class="n">C</span><span class="o">|</span>
   <span class="n">A</span>  <span class="n">B</span>  <span class="n">C</span>        <span class="o">+---+---+---+</span>
<span class="mi">0</span>  <span class="n">a</span>  <span class="mi">1</span>  <span class="mi">2</span>        <span class="o">|</span>  <span class="n">a</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">b</span>  <span class="mi">2</span>  <span class="mi">3</span>        <span class="o">|</span>  <span class="n">b</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>
<span class="mi">2</span>  <span class="n">c</span>  <span class="mi">3</span>  <span class="mi">4</span>        <span class="o">|</span>  <span class="n">c</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>  <span class="mi">4</span><span class="o">|</span>
                  <span class="o">+---+---+---+</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Pay attentation to the parameter <code class="docutils literal notranslate"><span class="pre">columns=</span></code> in <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>. Since the default value will make the list as rows.</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># caution for the columns=</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">col_name</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="n">col_name</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>   <span class="n">A</span>  <span class="n">B</span>  <span class="n">C</span>             <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">0</span>  <span class="n">a</span>  <span class="mi">1</span>  <span class="mi">2</span>          <span class="n">A</span>  <span class="n">a</span>  <span class="mi">1</span>  <span class="mi">2</span>
<span class="mi">1</span>  <span class="n">b</span>  <span class="mi">2</span>  <span class="mi">3</span>          <span class="n">B</span>  <span class="n">b</span>  <span class="mi">2</span>  <span class="mi">3</span>
<span class="mi">2</span>  <span class="n">c</span>  <span class="mi">3</span>  <span class="mi">4</span>          <span class="n">C</span>  <span class="n">c</span>  <span class="mi">3</span>  <span class="mi">4</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="from-dict">
<h3><span class="section-number">10.1.2. </span>From Dict<a class="headerlink" href="#from-dict" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
     <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
     <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="k">for</span>
<span class="c1"># Tedious for PySpark</span>
<span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span><span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                   <span class="o">+---+---+---+</span>
                   <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>  <span class="n">C</span><span class="o">|</span>
   <span class="n">A</span>  <span class="n">B</span>  <span class="n">C</span>         <span class="o">+---+---+---+</span>
<span class="mi">0</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">1</span>         <span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>
<span class="mi">1</span>  <span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">0</span>         <span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>
<span class="mi">2</span>  <span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">0</span>         <span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>
                   <span class="o">+---+---+---+</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="load-dataframe">
<h2><span class="section-number">10.2. </span>Load DataFrame<a class="headerlink" href="#load-dataframe" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-database">
<h3><span class="section-number">10.2.1. </span>From DataBase<a class="headerlink" href="#from-database" title="Permalink to this headline">¶</a></h3>
<p>Most of time, you need to share your code with your colleagues or release your code for Code Review or Quality assurance(QA). You will definitely do not want to have your <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">Information</span></code> in the code. So you can save them
in login.txt:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span>runawayhorse001
PythonTips
</pre></div>
</div>
<p>and use the following code to import your <code class="docutils literal notranslate"><span class="pre">User</span> <span class="pre">Information</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#User Information</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">login</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;login.txt&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">pw</span> <span class="o">=</span> <span class="n">login</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;User information is ready!&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Login information is not available!!!&#39;</span><span class="p">)</span>

<span class="c1">#Database information</span>
<span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;##.###.###.##&#39;</span>
<span class="n">db_name</span> <span class="o">=</span> <span class="s1">&#39;db_name&#39;</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="s1">&#39;table_name&#39;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="n">db_name</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">pw</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

<span class="n">sql</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">      select *</span>
<span class="s2">      from </span><span class="si">{table_name}</span><span class="s2"></span>
<span class="s2">      &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">)</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># connect to database</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;jdbc:postgresql://&#39;</span><span class="o">+</span><span class="n">host</span><span class="o">+</span><span class="s1">&#39;:5432/&#39;</span><span class="o">+</span><span class="n">db_name</span><span class="o">+</span><span class="s1">&#39;?user=&#39;</span><span class="o">+</span><span class="n">user</span><span class="o">+</span><span class="s1">&#39;&amp;password=&#39;</span><span class="o">+</span><span class="n">pw</span>
<span class="n">properties</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;driver&#39;</span><span class="p">:</span> <span class="s1">&#39;org.postgresql.Driver&#39;</span><span class="p">,</span> <span class="s1">&#39;password&#39;</span><span class="p">:</span> <span class="n">pw</span><span class="p">,</span><span class="s1">&#39;user&#39;</span><span class="p">:</span> <span class="n">user</span><span class="p">}</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">jdbc</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">table</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="n">properties</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Reading tables from Database with PySpark needs the proper drive for the corresponding Database. For example, the above demo needs org.postgresql.Driver and you need to download it and put it in <code class="docutils literal notranslate"><span class="pre">jars</span></code> folder of your spark installation path. I download postgresql-42.1.1.jar from the official website and put it in jars folder.</p>
</div>
</div>
<div class="section" id="from-csv">
<h3><span class="section-number">10.2.2. </span>From <code class="docutils literal notranslate"><span class="pre">.csv</span></code><a class="headerlink" href="#from-csv" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># pd.DataFrame dp: DataFrame pandas</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Advertising.csv&#39;</span><span class="p">)</span>
<span class="c1">#rdd.DataFrame. dp: DataFrame spark</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;Advertising.csv&#39;</span><span class="p">,</span>
<span class="c1">#                sep=&#39;,&#39;,</span>
<span class="c1">#                encoding=&#39;UTF-8&#39;,</span>
<span class="c1">#                comment=None,</span>
               <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">inferSchema</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="from-json">
<h3><span class="section-number">10.2.3. </span>From <code class="docutils literal notranslate"><span class="pre">.json</span></code><a class="headerlink" href="#from-json" title="Permalink to this headline">¶</a></h3>
<p>Data from: <a class="reference external" href="http://api.luftdaten.info/static/v1/data.json">http://api.luftdaten.info/static/v1/data.json</a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;data/data.json&quot;</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="s1">&#39;data/data.json&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="p">[[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+----------+-------------------+</span>
                                                <span class="o">|</span>        <span class="nb">id</span><span class="o">|</span>          <span class="n">timestamp</span><span class="o">|</span>
            <span class="nb">id</span>  <span class="n">timestamp</span>                       <span class="o">+----------+-------------------+</span>
<span class="mi">0</span>   <span class="mi">2994551481</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span>             <span class="o">|</span><span class="mi">2994551481</span><span class="o">|</span><span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mi">2994551482</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span>             <span class="o">|</span><span class="mi">2994551482</span><span class="o">|</span><span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mi">2994551483</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span>             <span class="o">|</span><span class="mi">2994551483</span><span class="o">|</span><span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span><span class="o">|</span>
<span class="mi">3</span>   <span class="mi">2994551484</span>  <span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span>             <span class="o">|</span><span class="mi">2994551484</span><span class="o">|</span><span class="mi">2019</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">28</span> <span class="mi">17</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">52</span><span class="o">|</span>
                                                <span class="o">+----------+-------------------+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="first-n-rows">
<h2><span class="section-number">10.3. </span>First <code class="docutils literal notranslate"><span class="pre">n</span></code> Rows<a class="headerlink" href="#first-n-rows" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+-----+-----+---------+-----+</span>
                                        <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>       <span class="o">+-----+-----+---------+-----+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>       <span class="mf">69.2</span>   <span class="mf">22.1</span>       <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span>     <span class="mf">69.2</span><span class="o">|</span> <span class="mf">22.1</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>       <span class="mf">45.1</span>   <span class="mf">10.4</span>       <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span>     <span class="mf">45.1</span><span class="o">|</span> <span class="mf">10.4</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>       <span class="mf">69.3</span>    <span class="mf">9.3</span>       <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span>     <span class="mf">69.3</span><span class="o">|</span>  <span class="mf">9.3</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>       <span class="mf">58.5</span>   <span class="mf">18.5</span>       <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span>     <span class="mf">58.5</span><span class="o">|</span> <span class="mf">18.5</span><span class="o">|</span>
                                        <span class="o">+-----+-----+---------+-----+</span>
                                        <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
<div class="section" id="column-names">
<h2><span class="section-number">10.4. </span>Column Names<a class="headerlink" href="#column-names" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">columns</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="s1">&#39;Radio&#39;</span><span class="p">,</span> <span class="s1">&#39;Newspaper&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="s1">&#39;Radio&#39;</span><span class="p">,</span> <span class="s1">&#39;Newspaper&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="data-types">
<h2><span class="section-number">10.5. </span>Data types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">dtypes</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TV</span>           <span class="n">float64</span>                    <span class="p">[(</span><span class="s1">&#39;TV&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">),</span>
<span class="n">Radio</span>        <span class="n">float64</span>                     <span class="p">(</span><span class="s1">&#39;Radio&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">),</span>
<span class="n">Newspaper</span>    <span class="n">float64</span>                     <span class="p">(</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">),</span>
<span class="n">Sales</span>        <span class="n">float64</span>                     <span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;double&#39;</span><span class="p">)]</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
</div>
<div class="section" id="replace-data-types">
<h2><span class="section-number">10.6. </span>Replace Data types<a class="headerlink" href="#replace-data-types" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;col2&#39;</span><span class="p">,</span> <span class="s1">&#39;col3&#39;</span><span class="p">]</span>


<span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>

<span class="n">dp</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">col1</span>    <span class="nb">object</span>
<span class="n">col2</span>     <span class="n">int64</span>
<span class="n">col3</span>     <span class="n">int64</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span><span class="s1">&#39;col3&#39;</span><span class="p">:</span><span class="s1">&#39;string&#39;</span><span class="p">}</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">astype</span><span class="p">({</span><span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span><span class="s1">&#39;col3&#39;</span><span class="p">:</span><span class="s1">&#39;str&#39;</span><span class="p">})</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="o">*</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">-</span><span class="nb">set</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">())),</span>
               <span class="o">*</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">alias</span><span class="p">(</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">col1</span>    <span class="nb">object</span>
<span class="n">col2</span>    <span class="nb">object</span>           <span class="p">[(</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;col2&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;col3&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">)]</span>
<span class="n">col3</span>    <span class="nb">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
</div>
<div class="section" id="fill-null">
<h2><span class="section-number">10.7. </span>Fill Null<a class="headerlink" href="#fill-null" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="c1">#</span>
<span class="n">dp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">ds</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+------+---+----+</span>
                                        <span class="o">|</span>     <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>   <span class="n">C</span><span class="o">|</span>
        <span class="n">A</span>  <span class="n">B</span>    <span class="n">C</span>                       <span class="o">+------+---+----+</span>
<span class="mi">0</span>    <span class="n">male</span>  <span class="mi">1</span>  <span class="n">NaN</span>                       <span class="o">|</span>  <span class="n">male</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">female</span>  <span class="mi">2</span>  <span class="mf">3.0</span>                       <span class="o">|</span><span class="n">female</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>   <span class="mi">3</span><span class="o">|</span>
<span class="mi">2</span>    <span class="n">male</span>  <span class="mi">3</span>  <span class="mf">4.0</span>                       <span class="o">|</span>  <span class="n">male</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>   <span class="mi">4</span><span class="o">|</span>
                                        <span class="o">+------+---+----+</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">99</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="o">-</span><span class="mi">99</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+------+---+----+</span>
                                        <span class="o">|</span>     <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>   <span class="n">C</span><span class="o">|</span>
        <span class="n">A</span>  <span class="n">B</span>    <span class="n">C</span>                       <span class="o">+------+---+----+</span>
<span class="mi">0</span>    <span class="n">male</span>  <span class="mi">1</span>  <span class="o">-</span><span class="mi">99</span>                       <span class="o">|</span>  <span class="n">male</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span> <span class="o">-</span><span class="mi">99</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">female</span>  <span class="mi">2</span>  <span class="mf">3.0</span>                       <span class="o">|</span><span class="n">female</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>   <span class="mi">3</span><span class="o">|</span>
<span class="mi">2</span>    <span class="n">male</span>  <span class="mi">3</span>  <span class="mf">4.0</span>                       <span class="o">|</span>  <span class="n">male</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>   <span class="mi">4</span><span class="o">|</span>
                                        <span class="o">+------+---+----+</span>
</pre></div>
</div>
</div>
<div class="section" id="replace-values">
<h2><span class="section-number">10.8. </span>Replace Values<a class="headerlink" href="#replace-values" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># caution: you need to chose specific col</span>
<span class="n">dp</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dp</span>
<span class="c1">#caution: Mixed type replacements are not supported</span>
<span class="n">ds</span><span class="o">.</span><span class="n">na</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;male&#39;</span><span class="p">,</span><span class="s1">&#39;female&#39;</span><span class="p">],[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                <span class="o">+---+---+----+</span>
                                <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>   <span class="n">C</span><span class="o">|</span>
   <span class="n">A</span>  <span class="n">B</span>    <span class="n">C</span>                    <span class="o">+---+---+----+</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">1</span>  <span class="n">NaN</span>                    <span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">1</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
<span class="mi">1</span>  <span class="mi">0</span>  <span class="mi">2</span>  <span class="mf">3.0</span>                    <span class="o">|</span>  <span class="mi">0</span><span class="o">|</span>  <span class="mi">2</span><span class="o">|</span>   <span class="mi">3</span><span class="o">|</span>
<span class="mi">2</span>  <span class="mi">1</span>  <span class="mi">3</span>  <span class="mf">4.0</span>                    <span class="o">|</span>  <span class="mi">1</span><span class="o">|</span>  <span class="mi">3</span><span class="o">|</span>   <span class="mi">4</span><span class="o">|</span>
                                <span class="o">+---+---+----+</span>
</pre></div>
</div>
</div>
<div class="section" id="rename-columns">
<h2><span class="section-number">10.9. </span>Rename Columns<a class="headerlink" href="#rename-columns" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rename-all-columns">
<h3><span class="section-number">10.9.1. </span>Rename all columns<a class="headerlink" href="#rename-all-columns" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
<span class="n">dp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+----+----+----+</span>
                                                <span class="o">|</span>    <span class="n">a</span><span class="o">|</span>   <span class="n">b</span><span class="o">|</span>   <span class="n">c</span><span class="o">|</span>   <span class="n">d</span><span class="o">|</span>
       <span class="n">a</span>     <span class="n">b</span>     <span class="n">c</span>     <span class="n">d</span>                      <span class="o">+-----+----+----+----+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>  <span class="mf">37.8</span>  <span class="mf">69.2</span>  <span class="mf">22.1</span>                      <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span><span class="mf">37.8</span><span class="o">|</span><span class="mf">69.2</span><span class="o">|</span><span class="mf">22.1</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>  <span class="mf">39.3</span>  <span class="mf">45.1</span>  <span class="mf">10.4</span>                      <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span><span class="mf">39.3</span><span class="o">|</span><span class="mf">45.1</span><span class="o">|</span><span class="mf">10.4</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>  <span class="mf">45.9</span>  <span class="mf">69.3</span>   <span class="mf">9.3</span>                      <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span><span class="mf">45.9</span><span class="o">|</span><span class="mf">69.3</span><span class="o">|</span> <span class="mf">9.3</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>  <span class="mf">41.3</span>  <span class="mf">58.5</span>  <span class="mf">18.5</span>                      <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span><span class="mf">41.3</span><span class="o">|</span><span class="mf">58.5</span><span class="o">|</span><span class="mf">18.5</span><span class="o">|</span>
                                                <span class="o">+-----+----+----+----+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
<div class="section" id="rename-one-or-more-columns">
<h3><span class="section-number">10.9.2. </span>Rename one or more columns<a class="headerlink" href="#rename-one-or-more-columns" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">:</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;Sales&#39;</span><span class="p">:</span><span class="s1">&#39;D&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">mapping</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">ds</span><span class="o">.</span><span class="n">toDF</span><span class="p">(</span><span class="o">*</span><span class="n">new_names</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+-----+-----+----+----+</span>
                                        <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span>   <span class="n">C</span><span class="o">|</span>   <span class="n">D</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>     <span class="n">C</span>     <span class="n">D</span>             <span class="o">+-----+-----+----+----+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>  <span class="mf">69.2</span>  <span class="mf">22.1</span>             <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span><span class="mf">69.2</span><span class="o">|</span><span class="mf">22.1</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>  <span class="mf">45.1</span>  <span class="mf">10.4</span>             <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span><span class="mf">45.1</span><span class="o">|</span><span class="mf">10.4</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>  <span class="mf">69.3</span>   <span class="mf">9.3</span>             <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span><span class="mf">69.3</span><span class="o">|</span> <span class="mf">9.3</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>  <span class="mf">58.5</span>  <span class="mf">18.5</span>             <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span><span class="mf">58.5</span><span class="o">|</span><span class="mf">18.5</span><span class="o">|</span>
                                        <span class="o">+-----+-----+----+----+</span>
                                        <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">withColumnRenamed</span></code> to rename one column in PySpark.</p>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">withColumnRenamed</span><span class="p">(</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">,</span><span class="s1">&#39;Paper&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="o">+-----+-----+-----+-----+</span>
<span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Paper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span>
<span class="o">+-----+-----+-----+-----+</span>
<span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span> <span class="mf">69.2</span><span class="o">|</span> <span class="mf">22.1</span><span class="o">|</span>
<span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span> <span class="mf">45.1</span><span class="o">|</span> <span class="mf">10.4</span><span class="o">|</span>
<span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span> <span class="mf">69.3</span><span class="o">|</span>  <span class="mf">9.3</span><span class="o">|</span>
<span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span> <span class="mf">58.5</span><span class="o">|</span> <span class="mf">18.5</span><span class="o">|</span>
<span class="o">+-----+-----+-----+-----+</span>
<span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="drop-columns">
<h2><span class="section-number">10.10. </span>Drop Columns<a class="headerlink" href="#drop-columns" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">drop_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">,</span><span class="s1">&#39;Sales&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_name</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="o">*</span><span class="n">drop_name</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                <span class="o">+-----+-----+</span>
                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>                 <span class="o">+-----+-----+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>                 <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>                 <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>                 <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>                 <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span>
                                <span class="o">+-----+-----+</span>
                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
<div class="section" id="filter">
<h2><span class="section-number">10.11. </span>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Advertising.csv&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">csv</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;Advertising.csv&#39;</span><span class="p">,</span>
                    <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">inferSchema</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="n">dp</span><span class="o">.</span><span class="n">Newspaper</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">Newspaper</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+-----+---------+-----+</span>
                                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span>
       <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>              <span class="o">+-----+-----+---------+-----+</span>
<span class="mi">7</span>   <span class="mf">120.2</span>   <span class="mf">19.6</span>       <span class="mf">11.6</span>   <span class="mf">13.2</span>              <span class="o">|</span><span class="mf">120.2</span><span class="o">|</span> <span class="mf">19.6</span><span class="o">|</span>     <span class="mf">11.6</span><span class="o">|</span> <span class="mf">13.2</span><span class="o">|</span>
<span class="mi">8</span>     <span class="mf">8.6</span>    <span class="mf">2.1</span>        <span class="mf">1.0</span>    <span class="mf">4.8</span>              <span class="o">|</span>  <span class="mf">8.6</span><span class="o">|</span>  <span class="mf">2.1</span><span class="o">|</span>      <span class="mf">1.0</span><span class="o">|</span>  <span class="mf">4.8</span><span class="o">|</span>
<span class="mi">11</span>  <span class="mf">214.7</span>   <span class="mf">24.0</span>        <span class="mf">4.0</span>   <span class="mf">17.4</span>              <span class="o">|</span><span class="mf">214.7</span><span class="o">|</span> <span class="mf">24.0</span><span class="o">|</span>      <span class="mf">4.0</span><span class="o">|</span> <span class="mf">17.4</span><span class="o">|</span>
<span class="mi">13</span>   <span class="mf">97.5</span>    <span class="mf">7.6</span>        <span class="mf">7.2</span>    <span class="mf">9.7</span>              <span class="o">|</span> <span class="mf">97.5</span><span class="o">|</span>  <span class="mf">7.6</span><span class="o">|</span>      <span class="mf">7.2</span><span class="o">|</span>  <span class="mf">9.7</span><span class="o">|</span>
                                                <span class="o">+-----+-----+---------+-----+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[(</span><span class="n">dp</span><span class="o">.</span><span class="n">Newspaper</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">TV</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="p">[(</span><span class="n">ds</span><span class="o">.</span><span class="n">Newspaper</span><span class="o">&lt;</span><span class="mi">20</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">TV</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)]</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+-----+---------+-----+</span>
                                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span>
       <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>              <span class="o">+-----+-----+---------+-----+</span>
<span class="mi">7</span>   <span class="mf">120.2</span>   <span class="mf">19.6</span>       <span class="mf">11.6</span>   <span class="mf">13.2</span>              <span class="o">|</span><span class="mf">120.2</span><span class="o">|</span> <span class="mf">19.6</span><span class="o">|</span>     <span class="mf">11.6</span><span class="o">|</span> <span class="mf">13.2</span><span class="o">|</span>
<span class="mi">11</span>  <span class="mf">214.7</span>   <span class="mf">24.0</span>        <span class="mf">4.0</span>   <span class="mf">17.4</span>              <span class="o">|</span><span class="mf">214.7</span><span class="o">|</span> <span class="mf">24.0</span><span class="o">|</span>      <span class="mf">4.0</span><span class="o">|</span> <span class="mf">17.4</span><span class="o">|</span>
<span class="mi">19</span>  <span class="mf">147.3</span>   <span class="mf">23.9</span>       <span class="mf">19.1</span>   <span class="mf">14.6</span>              <span class="o">|</span><span class="mf">147.3</span><span class="o">|</span> <span class="mf">23.9</span><span class="o">|</span>     <span class="mf">19.1</span><span class="o">|</span> <span class="mf">14.6</span><span class="o">|</span>
<span class="mi">25</span>  <span class="mf">262.9</span>    <span class="mf">3.5</span>       <span class="mf">19.5</span>   <span class="mf">12.0</span>              <span class="o">|</span><span class="mf">262.9</span><span class="o">|</span>  <span class="mf">3.5</span><span class="o">|</span>     <span class="mf">19.5</span><span class="o">|</span> <span class="mf">12.0</span><span class="o">|</span>
                                                <span class="o">+-----+-----+---------+-----+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
<div class="section" id="with-new-column">
<h2><span class="section-number">10.12. </span>With New Column<a class="headerlink" href="#with-new-column" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;tv_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">TV</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">TV</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;tv_norm&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">TV</span><span class="o">/</span><span class="n">ds</span><span class="o">.</span><span class="n">groupBy</span><span class="p">()</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s2">&quot;TV&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">collect</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+-----+---------+-----+--------------------+</span>
                                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span>             <span class="n">tv_norm</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>   <span class="n">tv_norm</span>     <span class="o">+-----+-----+---------+-----+--------------------+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>       <span class="mf">69.2</span>   <span class="mf">22.1</span>  <span class="mf">0.007824</span>     <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span>     <span class="mf">69.2</span><span class="o">|</span> <span class="mf">22.1</span><span class="o">|</span><span class="mf">0.007824268493802813</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>       <span class="mf">45.1</span>   <span class="mf">10.4</span>  <span class="mf">0.001513</span>     <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span>     <span class="mf">45.1</span><span class="o">|</span> <span class="mf">10.4</span><span class="o">|</span><span class="mf">0.001513167961643</span><span class="o">...|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>       <span class="mf">69.3</span>    <span class="mf">9.3</span>  <span class="mf">0.000585</span>     <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span>     <span class="mf">69.3</span><span class="o">|</span>  <span class="mf">9.3</span><span class="o">|</span><span class="mf">5.848649200061207E-4</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>       <span class="mf">58.5</span>   <span class="mf">18.5</span>  <span class="mf">0.005152</span>     <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span>     <span class="mf">58.5</span><span class="o">|</span> <span class="mf">18.5</span><span class="o">|</span><span class="mf">0.005151571824472517</span><span class="o">|</span>
                                                <span class="o">+-----+-----+---------+-----+--------------------+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;cond&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="p">((</span><span class="n">c</span><span class="o">.</span><span class="n">TV</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">Radio</span><span class="o">&lt;</span><span class="mi">40</span><span class="p">))</span> <span class="k">else</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">Sales</span><span class="o">&gt;</span> <span class="mi">10</span> <span class="k">else</span> <span class="mi">3</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;cond&#39;</span><span class="p">,</span><span class="n">F</span><span class="o">.</span><span class="n">when</span><span class="p">((</span><span class="n">ds</span><span class="o">.</span><span class="n">TV</span><span class="o">&gt;</span><span class="mi">100</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">Radio</span><span class="o">&lt;</span><span class="mi">40</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">when</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">Sales</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>\
                      <span class="o">.</span><span class="n">otherwise</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+-----+---------+-----+----+</span>
                                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span><span class="n">cond</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>  <span class="n">cond</span>         <span class="o">+-----+-----+---------+-----+----+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>       <span class="mf">69.2</span>   <span class="mf">22.1</span>     <span class="mi">1</span>         <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span>     <span class="mf">69.2</span><span class="o">|</span> <span class="mf">22.1</span><span class="o">|</span>   <span class="mi">1</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>       <span class="mf">45.1</span>   <span class="mf">10.4</span>     <span class="mi">2</span>         <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span>     <span class="mf">45.1</span><span class="o">|</span> <span class="mf">10.4</span><span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>       <span class="mf">69.3</span>    <span class="mf">9.3</span>     <span class="mi">3</span>         <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span>     <span class="mf">69.3</span><span class="o">|</span>  <span class="mf">9.3</span><span class="o">|</span>   <span class="mi">3</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>       <span class="mf">58.5</span>   <span class="mf">18.5</span>     <span class="mi">2</span>         <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span>     <span class="mf">58.5</span><span class="o">|</span> <span class="mf">18.5</span><span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>
                                                <span class="o">+-----+-----+---------+-----+----+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;log_tv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">dp</span><span class="o">.</span><span class="n">TV</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;log_tv&#39;</span><span class="p">,</span><span class="n">F</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">TV</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+-----+---------+-----+------------------+</span>
                                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span>            <span class="n">log_tv</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>    <span class="n">log_tv</span>     <span class="o">+-----+-----+---------+-----+------------------+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>       <span class="mf">69.2</span>   <span class="mf">22.1</span>  <span class="mf">5.438514</span>     <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span>     <span class="mf">69.2</span><span class="o">|</span> <span class="mf">22.1</span><span class="o">|</span>  <span class="mf">5.43851399704132</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>       <span class="mf">45.1</span>   <span class="mf">10.4</span>  <span class="mf">3.795489</span>     <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span>     <span class="mf">45.1</span><span class="o">|</span> <span class="mf">10.4</span><span class="o">|</span><span class="mf">3.7954891891721947</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>       <span class="mf">69.3</span>    <span class="mf">9.3</span>  <span class="mf">2.844909</span>     <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span>     <span class="mf">69.3</span><span class="o">|</span>  <span class="mf">9.3</span><span class="o">|</span><span class="mf">2.8449093838194073</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>       <span class="mf">58.5</span>   <span class="mf">18.5</span>  <span class="mf">5.020586</span>     <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span>     <span class="mf">58.5</span><span class="o">|</span> <span class="mf">18.5</span><span class="o">|</span> <span class="mf">5.020585624949423</span><span class="o">|</span>
                                                <span class="o">+-----+-----+---------+-----+------------------+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;tv+10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">TV</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span>
<span class="n">dp</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;tv+10&#39;</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">TV</span><span class="o">+</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+-----+-----+---------+-----+-----+</span>
                                                <span class="o">|</span>   <span class="n">TV</span><span class="o">|</span><span class="n">Radio</span><span class="o">|</span><span class="n">Newspaper</span><span class="o">|</span><span class="n">Sales</span><span class="o">|</span><span class="n">tv</span><span class="o">+</span><span class="mi">10</span><span class="o">|</span>
      <span class="n">TV</span>  <span class="n">Radio</span>  <span class="n">Newspaper</span>  <span class="n">Sales</span>  <span class="n">tv</span><span class="o">+</span><span class="mi">10</span>        <span class="o">+-----+-----+---------+-----+-----+</span>
<span class="mi">0</span>  <span class="mf">230.1</span>   <span class="mf">37.8</span>       <span class="mf">69.2</span>   <span class="mf">22.1</span>  <span class="mf">240.1</span>        <span class="o">|</span><span class="mf">230.1</span><span class="o">|</span> <span class="mf">37.8</span><span class="o">|</span>     <span class="mf">69.2</span><span class="o">|</span> <span class="mf">22.1</span><span class="o">|</span><span class="mf">240.1</span><span class="o">|</span>
<span class="mi">1</span>   <span class="mf">44.5</span>   <span class="mf">39.3</span>       <span class="mf">45.1</span>   <span class="mf">10.4</span>   <span class="mf">54.5</span>        <span class="o">|</span> <span class="mf">44.5</span><span class="o">|</span> <span class="mf">39.3</span><span class="o">|</span>     <span class="mf">45.1</span><span class="o">|</span> <span class="mf">10.4</span><span class="o">|</span> <span class="mf">54.5</span><span class="o">|</span>
<span class="mi">2</span>   <span class="mf">17.2</span>   <span class="mf">45.9</span>       <span class="mf">69.3</span>    <span class="mf">9.3</span>   <span class="mf">27.2</span>        <span class="o">|</span> <span class="mf">17.2</span><span class="o">|</span> <span class="mf">45.9</span><span class="o">|</span>     <span class="mf">69.3</span><span class="o">|</span>  <span class="mf">9.3</span><span class="o">|</span> <span class="mf">27.2</span><span class="o">|</span>
<span class="mi">3</span>  <span class="mf">151.5</span>   <span class="mf">41.3</span>       <span class="mf">58.5</span>   <span class="mf">18.5</span>  <span class="mf">161.5</span>        <span class="o">|</span><span class="mf">151.5</span><span class="o">|</span> <span class="mf">41.3</span><span class="o">|</span>     <span class="mf">58.5</span><span class="o">|</span> <span class="mf">18.5</span><span class="o">|</span><span class="mf">161.5</span><span class="o">|</span>
                                                <span class="o">+-----+-----+---------+-----+-----+</span>
                                                <span class="n">only</span> <span class="n">showing</span> <span class="n">top</span> <span class="mi">4</span> <span class="n">rows</span>
</pre></div>
</div>
</div>
<div class="section" id="join">
<h2><span class="section-number">10.13. </span>Join<a class="headerlink" href="#join" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leftp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C0&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;C3&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D0&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;D3&#39;</span><span class="p">]},</span>
                    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="n">rightp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A0&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;A7&#39;</span><span class="p">],</span>
                       <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;B7&#39;</span><span class="p">],</span>
                       <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="s1">&#39;C7&#39;</span><span class="p">],</span>
                       <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="s1">&#39;D6&#39;</span><span class="p">,</span> <span class="s1">&#39;D7&#39;</span><span class="p">]},</span>
                       <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>

<span class="n">lefts</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">leftp</span><span class="p">)</span>
<span class="n">rights</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">rightp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">A</span>   <span class="n">B</span>   <span class="n">C</span>   <span class="n">D</span>                   <span class="n">A</span>   <span class="n">F</span>   <span class="n">G</span>   <span class="n">H</span>
<span class="mi">0</span>  <span class="n">A0</span>  <span class="n">B0</span>  <span class="n">C0</span>  <span class="n">D0</span>               <span class="mi">4</span>  <span class="n">A0</span>  <span class="n">B4</span>  <span class="n">C4</span>  <span class="n">D4</span>
<span class="mi">1</span>  <span class="n">A1</span>  <span class="n">B1</span>  <span class="n">C1</span>  <span class="n">D1</span>               <span class="mi">5</span>  <span class="n">A1</span>  <span class="n">B5</span>  <span class="n">C5</span>  <span class="n">D5</span>
<span class="mi">2</span>  <span class="n">A2</span>  <span class="n">B2</span>  <span class="n">C2</span>  <span class="n">D2</span>               <span class="mi">6</span>  <span class="n">A6</span>  <span class="n">B6</span>  <span class="n">C6</span>  <span class="n">D6</span>
<span class="mi">3</span>  <span class="n">A3</span>  <span class="n">B3</span>  <span class="n">C3</span>  <span class="n">D3</span>               <span class="mi">7</span>  <span class="n">A7</span>  <span class="n">B7</span>  <span class="n">C7</span>  <span class="n">D7</span>
</pre></div>
</div>
<div class="section" id="left-join">
<h3><span class="section-number">10.13.1. </span>Left Join<a class="headerlink" href="#left-join" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leftp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rightp</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">lefts</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rights</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+---+---+---+---+----+----+----+</span>
                                        <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>  <span class="n">C</span><span class="o">|</span>  <span class="n">D</span><span class="o">|</span>   <span class="n">F</span><span class="o">|</span>   <span class="n">G</span><span class="o">|</span>   <span class="n">H</span><span class="o">|</span>
    <span class="n">A</span>   <span class="n">B</span>   <span class="n">C</span>   <span class="n">D</span>    <span class="n">F</span>    <span class="n">G</span>    <span class="n">H</span>        <span class="o">+---+---+---+---+----+----+----+</span>
<span class="mi">0</span>  <span class="n">A0</span>  <span class="n">B0</span>  <span class="n">C0</span>  <span class="n">D0</span>   <span class="n">B4</span>   <span class="n">C4</span>   <span class="n">D4</span>        <span class="o">|</span> <span class="n">A0</span><span class="o">|</span> <span class="n">B0</span><span class="o">|</span> <span class="n">C0</span><span class="o">|</span> <span class="n">D0</span><span class="o">|</span>  <span class="n">B4</span><span class="o">|</span>  <span class="n">C4</span><span class="o">|</span>  <span class="n">D4</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">A1</span>  <span class="n">B1</span>  <span class="n">C1</span>  <span class="n">D1</span>   <span class="n">B5</span>   <span class="n">C5</span>   <span class="n">D5</span>        <span class="o">|</span> <span class="n">A1</span><span class="o">|</span> <span class="n">B1</span><span class="o">|</span> <span class="n">C1</span><span class="o">|</span> <span class="n">D1</span><span class="o">|</span>  <span class="n">B5</span><span class="o">|</span>  <span class="n">C5</span><span class="o">|</span>  <span class="n">D5</span><span class="o">|</span>
<span class="mi">2</span>  <span class="n">A2</span>  <span class="n">B2</span>  <span class="n">C2</span>  <span class="n">D2</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>        <span class="o">|</span> <span class="n">A2</span><span class="o">|</span> <span class="n">B2</span><span class="o">|</span> <span class="n">C2</span><span class="o">|</span> <span class="n">D2</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
<span class="mi">3</span>  <span class="n">A3</span>  <span class="n">B3</span>  <span class="n">C3</span>  <span class="n">D3</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>        <span class="o">|</span> <span class="n">A3</span><span class="o">|</span> <span class="n">B3</span><span class="o">|</span> <span class="n">C3</span><span class="o">|</span> <span class="n">D3</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
                                        <span class="o">+---+---+---+---+----+----+----+</span>
</pre></div>
</div>
</div>
<div class="section" id="right-join">
<h3><span class="section-number">10.13.2. </span>Right Join<a class="headerlink" href="#right-join" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leftp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rightp</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">lefts</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rights</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+---+----+----+----+---+---+---+</span>
                                        <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>   <span class="n">B</span><span class="o">|</span>   <span class="n">C</span><span class="o">|</span>   <span class="n">D</span><span class="o">|</span>  <span class="n">F</span><span class="o">|</span>  <span class="n">G</span><span class="o">|</span>  <span class="n">H</span><span class="o">|</span>
    <span class="n">A</span>    <span class="n">B</span>    <span class="n">C</span>    <span class="n">D</span>   <span class="n">F</span>   <span class="n">G</span>   <span class="n">H</span>        <span class="o">+---+----+----+----+---+---+---+</span>
<span class="mi">0</span>  <span class="n">A0</span>   <span class="n">B0</span>   <span class="n">C0</span>   <span class="n">D0</span>  <span class="n">B4</span>  <span class="n">C4</span>  <span class="n">D4</span>        <span class="o">|</span> <span class="n">A0</span><span class="o">|</span>  <span class="n">B0</span><span class="o">|</span>  <span class="n">C0</span><span class="o">|</span>  <span class="n">D0</span><span class="o">|</span> <span class="n">B4</span><span class="o">|</span> <span class="n">C4</span><span class="o">|</span> <span class="n">D4</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">A1</span>   <span class="n">B1</span>   <span class="n">C1</span>   <span class="n">D1</span>  <span class="n">B5</span>  <span class="n">C5</span>  <span class="n">D5</span>        <span class="o">|</span> <span class="n">A1</span><span class="o">|</span>  <span class="n">B1</span><span class="o">|</span>  <span class="n">C1</span><span class="o">|</span>  <span class="n">D1</span><span class="o">|</span> <span class="n">B5</span><span class="o">|</span> <span class="n">C5</span><span class="o">|</span> <span class="n">D5</span><span class="o">|</span>
<span class="mi">2</span>  <span class="n">A6</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">B6</span>  <span class="n">C6</span>  <span class="n">D6</span>        <span class="o">|</span> <span class="n">A6</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span> <span class="n">B6</span><span class="o">|</span> <span class="n">C6</span><span class="o">|</span> <span class="n">D6</span><span class="o">|</span>
<span class="mi">3</span>  <span class="n">A7</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">B7</span>  <span class="n">C7</span>  <span class="n">D7</span>        <span class="o">|</span> <span class="n">A7</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span> <span class="n">B7</span><span class="o">|</span> <span class="n">C7</span><span class="o">|</span> <span class="n">D7</span><span class="o">|</span>
                                        <span class="o">+---+----+----+----+---+---+---+</span>
</pre></div>
</div>
</div>
<div class="section" id="inner-join">
<h3><span class="section-number">10.13.3. </span>Inner Join<a class="headerlink" href="#inner-join" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leftp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rightp</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">lefts</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rights</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                <span class="o">+---+---+---+---+---+---+---+</span>
                                <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>  <span class="n">B</span><span class="o">|</span>  <span class="n">C</span><span class="o">|</span>  <span class="n">D</span><span class="o">|</span>  <span class="n">F</span><span class="o">|</span>  <span class="n">G</span><span class="o">|</span>  <span class="n">H</span><span class="o">|</span>
    <span class="n">A</span>   <span class="n">B</span>   <span class="n">C</span>   <span class="n">D</span>   <span class="n">F</span>   <span class="n">G</span>   <span class="n">H</span>   <span class="o">+---+---+---+---+---+---+---+</span>
<span class="mi">0</span>  <span class="n">A0</span>  <span class="n">B0</span>  <span class="n">C0</span>  <span class="n">D0</span>  <span class="n">B4</span>  <span class="n">C4</span>  <span class="n">D4</span>   <span class="o">|</span> <span class="n">A0</span><span class="o">|</span> <span class="n">B0</span><span class="o">|</span> <span class="n">C0</span><span class="o">|</span> <span class="n">D0</span><span class="o">|</span> <span class="n">B4</span><span class="o">|</span> <span class="n">C4</span><span class="o">|</span> <span class="n">D4</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">A1</span>  <span class="n">B1</span>  <span class="n">C1</span>  <span class="n">D1</span>  <span class="n">B5</span>  <span class="n">C5</span>  <span class="n">D5</span>   <span class="o">|</span> <span class="n">A1</span><span class="o">|</span> <span class="n">B1</span><span class="o">|</span> <span class="n">C1</span><span class="o">|</span> <span class="n">D1</span><span class="o">|</span> <span class="n">B5</span><span class="o">|</span> <span class="n">C5</span><span class="o">|</span> <span class="n">D5</span><span class="o">|</span>
                                <span class="o">+---+---+---+---+---+---+---+</span>
</pre></div>
</div>
</div>
<div class="section" id="full-join">
<h3><span class="section-number">10.13.4. </span>Full Join<a class="headerlink" href="#full-join" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">leftp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rightp</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">lefts</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rights</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span>
     <span class="o">.</span><span class="n">orderBy</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+---+----+----+----+----+----+----+</span>
                                        <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>   <span class="n">B</span><span class="o">|</span>   <span class="n">C</span><span class="o">|</span>   <span class="n">D</span><span class="o">|</span>   <span class="n">F</span><span class="o">|</span>   <span class="n">G</span><span class="o">|</span>   <span class="n">H</span><span class="o">|</span>
    <span class="n">A</span>    <span class="n">B</span>    <span class="n">C</span>    <span class="n">D</span>    <span class="n">F</span>    <span class="n">G</span>    <span class="n">H</span>     <span class="o">+---+----+----+----+----+----+----+</span>
<span class="mi">0</span>  <span class="n">A0</span>   <span class="n">B0</span>   <span class="n">C0</span>   <span class="n">D0</span>   <span class="n">B4</span>   <span class="n">C4</span>   <span class="n">D4</span>     <span class="o">|</span> <span class="n">A0</span><span class="o">|</span>  <span class="n">B0</span><span class="o">|</span>  <span class="n">C0</span><span class="o">|</span>  <span class="n">D0</span><span class="o">|</span>  <span class="n">B4</span><span class="o">|</span>  <span class="n">C4</span><span class="o">|</span>  <span class="n">D4</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">A1</span>   <span class="n">B1</span>   <span class="n">C1</span>   <span class="n">D1</span>   <span class="n">B5</span>   <span class="n">C5</span>   <span class="n">D5</span>     <span class="o">|</span> <span class="n">A1</span><span class="o">|</span>  <span class="n">B1</span><span class="o">|</span>  <span class="n">C1</span><span class="o">|</span>  <span class="n">D1</span><span class="o">|</span>  <span class="n">B5</span><span class="o">|</span>  <span class="n">C5</span><span class="o">|</span>  <span class="n">D5</span><span class="o">|</span>
<span class="mi">2</span>  <span class="n">A2</span>   <span class="n">B2</span>   <span class="n">C2</span>   <span class="n">D2</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>     <span class="o">|</span> <span class="n">A2</span><span class="o">|</span>  <span class="n">B2</span><span class="o">|</span>  <span class="n">C2</span><span class="o">|</span>  <span class="n">D2</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
<span class="mi">3</span>  <span class="n">A3</span>   <span class="n">B3</span>   <span class="n">C3</span>   <span class="n">D3</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>     <span class="o">|</span> <span class="n">A3</span><span class="o">|</span>  <span class="n">B3</span><span class="o">|</span>  <span class="n">C3</span><span class="o">|</span>  <span class="n">D3</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
<span class="mi">4</span>  <span class="n">A6</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>   <span class="n">B6</span>   <span class="n">C6</span>   <span class="n">D6</span>     <span class="o">|</span> <span class="n">A6</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>  <span class="n">B6</span><span class="o">|</span>  <span class="n">C6</span><span class="o">|</span>  <span class="n">D6</span><span class="o">|</span>
<span class="mi">5</span>  <span class="n">A7</span>  <span class="n">NaN</span>  <span class="n">NaN</span>  <span class="n">NaN</span>   <span class="n">B7</span>   <span class="n">C7</span>   <span class="n">D7</span>     <span class="o">|</span> <span class="n">A7</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>  <span class="n">B7</span><span class="o">|</span>  <span class="n">C7</span><span class="o">|</span>  <span class="n">D7</span><span class="o">|</span>
                                        <span class="o">+---+----+----+----+----+----+----+</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="concat-columns">
<h2><span class="section-number">10.14. </span>Concat Columns<a class="headerlink" href="#concat-columns" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">)]</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="s1">&#39;col2&#39;</span><span class="p">,</span> <span class="s1">&#39;col3&#39;</span><span class="p">]</span>
<span class="c1">#</span>
<span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span><span class="n">schema</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>  <span class="n">col1</span>  <span class="n">col2</span>  <span class="n">col3</span>
<span class="mi">0</span>    <span class="n">a</span>     <span class="mi">2</span>     <span class="mi">3</span>
<span class="mi">1</span>    <span class="n">b</span>     <span class="mi">5</span>     <span class="mi">6</span>
<span class="mi">2</span>    <span class="n">c</span>     <span class="mi">8</span>     <span class="mi">9</span>
<span class="mi">3</span>    <span class="n">a</span>     <span class="mi">2</span>     <span class="mi">3</span>
<span class="mi">4</span>    <span class="n">b</span>     <span class="mi">5</span>     <span class="mi">6</span>
<span class="mi">5</span>    <span class="n">c</span>     <span class="mi">8</span>     <span class="mi">9</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;col1&#39;</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;col2&#39;</span><span class="p">]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dp</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span><span class="n">F</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span><span class="s1">&#39;col2&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+----+----+----+------+</span>
                                        <span class="o">|</span><span class="n">col1</span><span class="o">|</span><span class="n">col2</span><span class="o">|</span><span class="n">col3</span><span class="o">|</span><span class="n">concat</span><span class="o">|</span>
  <span class="n">col1</span>  <span class="n">col2</span>  <span class="n">col3</span> <span class="n">concat</span>               <span class="o">+----+----+----+------+</span>
<span class="mi">0</span>    <span class="n">a</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="n">a2</span>               <span class="o">|</span>   <span class="n">a</span><span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>   <span class="mi">3</span><span class="o">|</span>    <span class="n">a2</span><span class="o">|</span>
<span class="mi">1</span>    <span class="n">b</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="n">b5</span>               <span class="o">|</span>   <span class="n">b</span><span class="o">|</span>   <span class="mi">5</span><span class="o">|</span>   <span class="mi">6</span><span class="o">|</span>    <span class="n">b5</span><span class="o">|</span>
<span class="mi">2</span>    <span class="n">c</span>     <span class="mi">8</span>     <span class="mi">9</span>     <span class="n">c8</span>               <span class="o">|</span>   <span class="n">c</span><span class="o">|</span>   <span class="mi">8</span><span class="o">|</span>   <span class="mi">9</span><span class="o">|</span>    <span class="n">c8</span><span class="o">|</span>
<span class="mi">3</span>    <span class="n">a</span>     <span class="mi">2</span>     <span class="mi">3</span>     <span class="n">a2</span>               <span class="o">|</span>   <span class="n">a</span><span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>   <span class="mi">3</span><span class="o">|</span>    <span class="n">a2</span><span class="o">|</span>
<span class="mi">4</span>    <span class="n">b</span>     <span class="mi">5</span>     <span class="mi">6</span>     <span class="n">b5</span>               <span class="o">|</span>   <span class="n">b</span><span class="o">|</span>   <span class="mi">5</span><span class="o">|</span>   <span class="mi">6</span><span class="o">|</span>    <span class="n">b5</span><span class="o">|</span>
<span class="mi">5</span>    <span class="n">c</span>     <span class="mi">8</span>     <span class="mi">9</span>     <span class="n">c8</span>               <span class="o">|</span>   <span class="n">c</span><span class="o">|</span>   <span class="mi">8</span><span class="o">|</span>   <span class="mi">9</span><span class="o">|</span>    <span class="n">c8</span><span class="o">|</span>
                                        <span class="o">+----+----+----+------+</span>
</pre></div>
</div>
</div>
<div class="section" id="groupby">
<h2><span class="section-number">10.15. </span>GroupBy<a class="headerlink" href="#groupby" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;col2&#39;</span><span class="p">:</span><span class="s1">&#39;min&#39;</span><span class="p">,</span><span class="s1">&#39;col3&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">})</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">groupBy</span><span class="p">([</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;col2&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;col3&#39;</span><span class="p">:</span> <span class="s1">&#39;avg&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                        <span class="o">+----+---------+---------+</span>
      <span class="n">col2</span>  <span class="n">col3</span>                        <span class="o">|</span><span class="n">col1</span><span class="o">|</span><span class="nb">min</span><span class="p">(</span><span class="n">col2</span><span class="p">)</span><span class="o">|</span><span class="n">avg</span><span class="p">(</span><span class="n">col3</span><span class="p">)</span><span class="o">|</span>
<span class="n">col1</span>                                    <span class="o">+----+---------+---------+</span>
<span class="n">a</span>        <span class="mi">2</span>     <span class="mi">3</span>                        <span class="o">|</span>   <span class="n">c</span><span class="o">|</span>        <span class="mi">8</span><span class="o">|</span>      <span class="mf">9.0</span><span class="o">|</span>
<span class="n">b</span>        <span class="mi">5</span>     <span class="mi">6</span>                        <span class="o">|</span>   <span class="n">b</span><span class="o">|</span>        <span class="mi">5</span><span class="o">|</span>      <span class="mf">6.0</span><span class="o">|</span>
<span class="n">c</span>        <span class="mi">8</span>     <span class="mi">9</span>                        <span class="o">|</span>   <span class="n">a</span><span class="o">|</span>        <span class="mi">2</span><span class="o">|</span>      <span class="mf">3.0</span><span class="o">|</span>
                                        <span class="o">+----+---------+---------+</span>
</pre></div>
</div>
</div>
<div class="section" id="pivot">
<h2><span class="section-number">10.16. </span>Pivot<a class="headerlink" href="#pivot" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;col3&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;col1&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;col2&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>
<span class="c1">#</span>
<span class="n">ds</span><span class="o">.</span><span class="n">groupBy</span><span class="p">([</span><span class="s1">&#39;col1&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="s1">&#39;col2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;col3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                <span class="o">+----+----+----+----+</span>
<span class="n">col2</span>    <span class="mi">2</span>     <span class="mi">5</span>     <span class="mi">8</span>           <span class="o">|</span><span class="n">col1</span><span class="o">|</span>   <span class="mi">2</span><span class="o">|</span>   <span class="mi">5</span><span class="o">|</span>   <span class="mi">8</span><span class="o">|</span>
<span class="n">col1</span>                            <span class="o">+----+----+----+----+</span>
<span class="n">a</span>     <span class="mf">6.0</span>   <span class="n">NaN</span>   <span class="n">NaN</span>           <span class="o">|</span>   <span class="n">c</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>  <span class="mi">18</span><span class="o">|</span>
<span class="n">b</span>     <span class="n">NaN</span>  <span class="mf">12.0</span>   <span class="n">NaN</span>           <span class="o">|</span>   <span class="n">b</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>  <span class="mi">12</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
<span class="n">c</span>     <span class="n">NaN</span>   <span class="n">NaN</span>  <span class="mf">18.0</span>           <span class="o">|</span>   <span class="n">a</span><span class="o">|</span>   <span class="mi">6</span><span class="o">|</span><span class="n">null</span><span class="o">|</span><span class="n">null</span><span class="o">|</span>
                                <span class="o">+----+----+----+----+</span>
</pre></div>
</div>
</div>
<div class="section" id="unixtime-to-date">
<h2><span class="section-number">10.17. </span>Unixtime to Date<a class="headerlink" href="#unixtime-to-date" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot;1284101485&quot;</span><span class="p">)],</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot;2284101485&quot;</span><span class="p">)],[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="s2">&quot;3284101485&quot;</span><span class="p">)]]</span>
<span class="n">col_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;ts&#39;</span><span class="p">]</span>

<span class="n">dp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">col_name</span><span class="p">)</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">createDataFrame</span><span class="p">(</span><span class="n">dp</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Python</span> <span class="pre">Code:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">dp</span><span class="p">[</span><span class="s1">&#39;ts&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
<span class="n">dp</span>

<span class="n">spark</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;spark.sql.session.timeZone&quot;</span><span class="p">,</span> <span class="s2">&quot;UTC&quot;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyspark.sql.types</span> <span class="kn">import</span> <span class="n">DateType</span>
<span class="n">ds</span><span class="o">.</span><span class="n">withColumn</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">from_unixtime</span><span class="p">(</span><span class="s1">&#39;ts&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1">#.cast(DateType())</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">::</span> <span class="pre">Comparison:</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                                                <span class="o">+---+----------+-------------------+</span>
                                                <span class="o">|</span>  <span class="n">A</span><span class="o">|</span>        <span class="n">ts</span><span class="o">|</span>               <span class="n">date</span><span class="o">|</span>
   <span class="n">A</span>          <span class="n">ts</span>                  <span class="n">datetime</span>      <span class="o">+---+----------+-------------------+</span>
<span class="mi">0</span>  <span class="n">a</span>  <span class="mi">1284101485</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span> <span class="mi">06</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">25</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="o">|</span>  <span class="n">a</span><span class="o">|</span><span class="mi">1284101485</span><span class="o">|</span><span class="mi">2010</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">10</span> <span class="mi">06</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">25</span><span class="o">|</span>
<span class="mi">1</span>  <span class="n">b</span>  <span class="mi">2284101485</span> <span class="mi">2042</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">19</span> <span class="mi">08</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">05</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="o">|</span>  <span class="n">b</span><span class="o">|</span><span class="mi">2284101485</span><span class="o">|</span><span class="mi">2042</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">19</span> <span class="mi">08</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">05</span><span class="o">|</span>
<span class="mi">2</span>  <span class="n">c</span>  <span class="mi">3284101485</span> <span class="mi">2074</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">25</span> <span class="mi">10</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">45</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>      <span class="o">|</span>  <span class="n">c</span><span class="o">|</span><span class="mi">3284101485</span><span class="o">|</span><span class="mi">2074</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">25</span> <span class="mi">10</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">45</span><span class="o">|</span>
                                                <span class="o">+---+----------+-------------------+</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="rdd.html" class="btn btn-neutral float-left" title="9. rdd.DataFrame manipulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="kaggle.html" class="btn btn-neutral float-right" title="11. Kaggle Competitions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Wenqiang Feng and Jing Yang.
      <span class="lastupdated">Last updated on Nov 27, 2021.
      </span></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>